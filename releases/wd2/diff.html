<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta name="generator" content=
"HTML Tidy for HTML5 for Linux version 5.2.0" />
<meta charset="utf-8" />
<meta name="generator" content="ReSpec 20.1.1" />
<meta name="viewport" content=
"width=device-width, initial-scale=1, shrink-to-fit=no" />
<style>
<![CDATA[
  /* --- EXAMPLES --- */
  div.example-title {
    min-width: 7.5em;
    color: #b9ab2d;
  }
  div.example-title span {
    text-transform: uppercase;
  }
  aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
  }
  div.illegal-example { color: red }
  div.illegal-example p { color: black }
  aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;
  }

  aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
  }
  aside.example div.example div.example-title {
    color: #999;
  }
]]>
</style>

<style>
<![CDATA[
  /* --- ISSUES/NOTES --- */
  div.issue-title, div.note-title , div.ednote-title, div.warning-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
  }
  div.issue-title { color: #e05252; }
  div.note-title, div.ednote-title { color: #2b2; }
  div.warning-title { color: #f22; }
  div.issue-title span, div.note-title span, div.ednote-title span, div.warning-title span {
    text-transform: uppercase;
  }
  div.note, div.issue, div.ednote, div.warning {
    margin-top: 1em;
    margin-bottom: 1em;
  }
  .note > p:first-child, .ednote > p:first-child, .issue > p:first-child, .warning > p:first-child { margin-top: 0 }
  .issue, .note, .ednote, .warning {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
  }
  div.issue, div.note , div.ednote,  div.warning {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
  }
  span.note, span.ednote, span.issue, span.warning { padding: .1em .5em .15em; }

  .issue {
    border-color: #e05252;
    background: #fbe9e9;
  }
  .note, .ednote {
    border-color: #52e052;
    background: #e9fbe9;
  }

  .warning {
    border-color: #f11;
    border-width: .2em;
    border-style: solid;
    background: #fbe9e9;
  }

  .warning-title:before{
    content: "âš "; /*U+26A0 WARNING SIGN*/
    font-size: 3em;
    float: left;
    height: 100%;
    padding-right: .3em;
    vertical-align: top;
    margin-top: -0.5em;
  }

  li.task-list-item {
    list-style: none;
  }

  input.task-list-item-checkbox {
    margin: 0 0.35em 0.25em -1.6em;
    vertical-align: middle;
  }
]]>
</style>

<style>
<![CDATA[
  /* --- WEB IDL --- */

  pre.idl {
  padding: 1em;
  }

  .respec-idl-separator {
  padding: 0 0 0.4cm 0;
  }

  .respec-idl-separator:last-child {
  padding: 0;
  }

  @media print {
  pre.idl {
    white-space: pre-wrap;
  }
  }

  pre.idl::before {
  content: "WebIDL";
  display: block;
  width: 150px;
  background: #90b8de;
  color: #fff;
  font-family: sans-serif;
  font-weight: bold;
  margin: -1em 0 1em -1em;
  height: 28px;
  line-height: 28px;  
  }

  .idlType {
  color: #ff4500;
  font-weight: bold;
  text-decoration: none;
  }


  /*.idlModule*/


  /*.idlModuleID*/


  /*.idlInterface*/

  .idlInterfaceID,
  .idlDictionaryID,
  .idlCallbackID,
  .idlEnumID {
  font-weight: bold;
  color: #005a9c;
  }

  a.idlEnumItem {
  color: #000;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
  }

  .idlSuperclass {
  font-style: italic;
  color: #005a9c;
  }


  /*.idlAttribute*/

  .idlAttrType,
  .idlFieldType,
  .idlMemberType {
  color: #005a9c;
  }

  .idlAttrName,
  .idlFieldName,
  .idlMemberName {
  color: #ff4500;
  }

  .idlAttrName a,
  .idlFieldName a,
  .idlMemberName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }


  /*.idlMethod*/

  .idlMethType,
  .idlCallbackType {
  color: #005a9c;
  }

  .idlMethName {
  color: #ff4500;
  }

  .idlMethName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }


  /*.idlCtor*/

  .idlCtorName {
  color: #ff4500;
  }

  .idlCtorName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }


  /*.idlParam*/

  .idlParamType {
  color: #005a9c;
  }

  .idlParamName,
  .idlDefaultValue {
  font-style: italic;
  }

  .extAttr {
  color: #666;
  }


  /*.idlSectionComment*/

  .idlSectionComment {
  color: gray;
  }


  /*.idlIterable*/

  .idlIterableKeyType,
  .idlIterableValueType {
  color: #005a9c;
  }


  /*.idlMaplike*/

  .idlMaplikeKeyType,
  .idlMaplikeValueType {
  color: #005a9c;
  }


  /*.idlConst*/

  .idlConstType {
  color: #005a9c;
  }

  .idlConstName {
  color: #ff4500;
  }

  .idlConstName a {
  color: #ff4500;
  border-bottom: 1px dotted #ff4500;
  text-decoration: none;
  }


  /*.idlException*/

  .idlExceptionID {
  font-weight: bold;
  color: #c00;
  }

  .idlTypedefID,
  .idlTypedefType {
  color: #005a9c;
  }

  .idlRaises,
  .idlRaises a.idlType,
  .idlRaises a.idlType code,
  .excName a,
  .excName a code {
  color: #c00;
  font-weight: normal;
  }

  .excName a {
  font-family: monospace;
  }

  .idlRaises a.idlType,
  .excName a.idlType {
  border-bottom: 1px dotted #c00;
  }

  .excGetSetTrue,
  .excGetSetFalse,
  .prmNullTrue,
  .prmNullFalse,
  .prmOptTrue,
  .prmOptFalse {
  width: 45px;
  text-align: center;
  }

  .excGetSetTrue,
  .prmNullTrue,
  .prmOptTrue {
  color: #0c0;
  }

  .excGetSetFalse,
  .prmNullFalse,
  .prmOptFalse {
  color: #c00;
  }

  .idlImplements a, .idlIncludes a {
  font-weight: bold;
  }

  dl.attributes,
  dl.methods,
  dl.constants,
  dl.constructors,
  dl.fields,
  dl.dictionary-members {
  margin-left: 2em;
  }

  .attributes dt,
  .methods dt,
  .constants dt,
  .constructors dt,
  .fields dt,
  .dictionary-members dt {
  font-weight: normal;
  }

  .attributes dt code,
  .methods dt code,
  .constants dt code,
  .constructors dt code,
  .fields dt code,
  .dictionary-members dt code {
  font-weight: bold;
  color: #000;
  font-family: monospace;
  }

  .attributes dt code,
  .fields dt code,
  .dictionary-members dt code {
  background: #ffffd2;
  }

  .attributes dt .idlAttrType code,
  .fields dt .idlFieldType code,
  .dictionary-members dt .idlMemberType code {
  color: #005a9c;
  background: transparent;
  font-family: inherit;
  font-weight: normal;
  font-style: italic;
  }

  .methods dt code {
  background: #d9e6f8;
  }

  .constants dt code {
  background: #ddffd2;
  }

  .constructors dt code {
  background: #cfc;
  }

  .attributes dd,
  .methods dd,
  .constants dd,
  .constructors dd,
  .fields dd,
  .dictionary-members dd {
  margin-bottom: 1em;
  }

  table.parameters,
  table.exceptions {
  border-spacing: 0;
  border-collapse: collapse;
  margin: 0.5em 0;
  width: 100%;
  }

  table.parameters {
  border-bottom: 1px solid #90b8de;
  }

  table.exceptions {
  border-bottom: 1px solid #deb890;
  }

  .parameters th,
  .exceptions th {
  color: inherit;
  padding: 3px 5px;
  text-align: left;
  font-weight: normal;
  }

  .parameters th {
  color: #fff;
  background: #005a9c;
  }

  .exceptions th {
  background: #deb890;
  }

  .parameters td,
  .exceptions td {
  padding: 3px 10px;
  border-top: 1px solid #ddd;
  vertical-align: top;
  }

  .parameters tr:first-child td,
  .exceptions tr:first-child td {
  border-top: none;
  }

  .parameters td.prmName,
  .exceptions td.excName,
  .exceptions td.excCodeName {
  width: 100px;
  }

  .parameters td.prmType {
  width: 120px;
  }

  table.exceptions table {
  border-spacing: 0;
  border-collapse: collapse;
  width: 100%;
  }

  .respec-button-copy-paste:focus {
  text-decoration: none;
  border-color: #51a7e8;
  outline: none;
  box-shadow: 0 0 5px rgba(81, 167, 232, 0.5);
  }

  .respec-button-copy-paste:focus:hover,
  .respec-button-copy-paste.selected:focus {
  border-color: #51a7e8;
  }

  .respec-button-copy-paste:hover,
  .respec-button-copy-paste:active,
  .respec-button-copy-paste.zeroclipboard-is-hover,
  .respec-button-copy-paste.zeroclipboard-is-active {
  text-decoration: none;
  background-color: #ddd;
  background-image: linear-gradient(#eee, #ddd);
  border-color: #ccc;
  }

  .respec-button-copy-paste:active,
  .respec-button-copy-paste.selected,
  .respec-button-copy-paste.zeroclipboard-is-active {
  background-color: #dcdcdc;
  background-image: none;
  border-color: #b5b5b5;
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.15)
  }

  .respec-button-copy-paste.selected:hover {
  background-color: #cfcfcf;
  }

  .respec-button-copy-paste:disabled,
  .respec-button-copy-paste:disabled:hover,
  .respec-button-copy-paste.disabled,
  .respec-button-copy-paste.disabled:hover {
  color: rgba(102, 102, 102, 0.5);
  cursor: default;
  background-color: rgba(229, 229, 229, 0.5);
  background-image: none;
  border-color: rgba(197, 197, 197, 0.5);
  box-shadow: none;
  }
]]>
</style>
<title>Web of Things (WoT) Scripting API</title>

<style id="respec-mainstyle">
<![CDATA[
  /*****************************************************************
  * ReSpec 3 CSS
  * Robin Berjon - http://berjon.com/
  *****************************************************************/

  /* Override code highlighter background */
  .hljs {
  background: transparent !important;
  }

  /* --- INLINES --- */
  h1 abbr,
  h2 abbr,
  h3 abbr,
  h4 abbr,
  h5 abbr,
  h6 abbr,
  a abbr {
  border: none;
  }

  dfn {
  font-weight: bold;
  }

  a.internalDFN {
  color: inherit;
  border-bottom: 1px solid #99c;
  text-decoration: none;
  }

  a.externalDFN {
  color: inherit;
  border-bottom: 1px dotted #ccc;
  text-decoration: none;
  }

  a.bibref {
  text-decoration: none;
  }

  cite .bibref {
  font-style: normal;
  }

  code {
  color: #c83500;
  }

  th code {
  color: inherit;
  }

  /* --- TOC --- */

  .toc a,
  .tof a {
  text-decoration: none;
  }

  a .secno,
  a .figno {
  color: #000;
  }

  ul.tof,
  ol.tof {
  list-style: none outside none;
  }

  .caption {
  margin-top: 0.5em;
  font-style: italic;
  }

  /* --- TABLE --- */

  table.simple {
  border-spacing: 0;
  border-collapse: collapse;
  border-bottom: 3px solid #005a9c;
  }

  .simple th {
  background: #005a9c;
  color: #fff;
  padding: 3px 5px;
  text-align: left;
  }

  .simple th[scope="row"] {
  background: inherit;
  color: inherit;
  border-top: 1px solid #ddd;
  }

  .simple td {
  padding: 3px 10px;
  border-top: 1px solid #ddd;
  }

  .simple tr:nth-child(even) {
  background: #f0f6ff;
  }

  /* --- DL --- */

  .section dd > p:first-child {
  margin-top: 0;
  }

  .section dd > p:last-child {
  margin-bottom: 0;
  }

  .section dd {
  margin-bottom: 1em;
  }

  .section dl.attrs dd,
  .section dl.eldef dd {
  margin-bottom: 0;
  }

  #issue-summary > ul,
  .respec-dfn-list {
  column-count: 2;
  }

  #issue-summary li,
  .respec-dfn-list li {
  list-style: none;
  }

  details.respec-tests-details {
  margin-left: 1em;
  display: inline-block;
  vertical-align: top;
  }

  details.respec-tests-details > * {
  padding-right: 2em;
  }

  details.respec-tests-details[open] {
  z-index: 999999;
  position: absolute;
  border: thin solid #cad3e2;
  border-radius: .3em;
  background-color: white;
  padding-bottom: .5em;
  }

  details.respec-tests-details[open] > summary {
  border-bottom: thin solid #cad3e2;
  padding-left: 1em;
  margin-bottom: 1em;
  line-height: 2em;
  }

  details.respec-tests-details > ul {
  width: 100%;
  margin-top: -0.3em;
  }

  details.respec-tests-details > li {
  padding-left: 1em;
  }

  @media print {
  .removeOnSave {
    display: none;
  }
  }
]]>
</style>

<style>
<![CDATA[
  /*

  github.com style (c) Vasily Polovnyov <vast@whiteants.net>

  */

  .hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  color: #333;
  background: #f8f8f8;
  }

  .hljs-comment,
  .hljs-quote {
  color: #998;
  font-style: italic;
  }

  .hljs-keyword,
  .hljs-selector-tag,
  .hljs-subst {
  color: #333;
  font-weight: bold;
  }

  .hljs-number,
  .hljs-literal,
  .hljs-variable,
  .hljs-template-variable,
  .hljs-tag .hljs-attr {
  color: #008080;
  }

  .hljs-string,
  .hljs-doctag {
  color: #d14;
  }

  .hljs-title,
  .hljs-section,
  .hljs-selector-id {
  color: #900;
  font-weight: bold;
  }

  .hljs-subst {
  font-weight: normal;
  }

  .hljs-type,
  .hljs-class .hljs-title {
  color: #458;
  font-weight: bold;
  }

  .hljs-tag,
  .hljs-name,
  .hljs-attribute {
  color: #000080;
  font-weight: normal;
  }

  .hljs-regexp,
  .hljs-link {
  color: #009926;
  }

  .hljs-symbol,
  .hljs-bullet {
  color: #990073;
  }

  .hljs-built_in,
  .hljs-builtin-name {
  color: #0086b3;
  }

  .hljs-meta {
  color: #999;
  font-weight: bold;
  }

  .hljs-deletion {
  background: #fdd;
  }

  .hljs-addition {
  background: #dfd;
  }

  .hljs-emphasis {
  font-style: italic;
  }

  .hljs-strong {
  font-weight: bold;
  }
]]>
</style>
<link rel="stylesheet" href=
"https://www.w3.org/StyleSheets/TR/2016/W3C-WD" />
<link rel="canonical" href=
"https://www.w3.org/TR/wot-scripting-api/" />
<script id="initialUserConfig" type="application/json">
<![CDATA[
  {
  "specStatus": "WD",
  "shortName": "wot-scripting-api",
  "copyrightStart": 2017,
  "noLegacyStyle": true,
  "publishDate": "",
  "previousPublishDate": "2017-09-14",
  "previousMaturity": "FPWD",
  "edDraftURI": "https://w3c.github.io/wot-scripting-api/",
  "crEnd": "",
  "inlineCSS": true,
  "noIDLIn": true,
  "format": "markdown",
  "editors": [
    {
      "name": "Zoltan Kis",
      "company": "Intel",
      "companyURL": "https://www.intel.com/"
    },
    {
      "name": "Kazuaki Nimura",
      "company": "Fujitsu Ltd.",
      "companyURL": "https://www.fujitsu.com/"
    },
    {
      "name": "Daniel Peintner",
      "company": "Siemens AG",
      "companyURL": "https://www.siemens.com/"
    },
    {
      "name": "Johannes Hund",
      "note": "Former Editor, when at Siemens AG"
    }
  ],
  "wg": "Web of Things Working Group",
  "wgURI": "https://www.w3.org/WoT/WG/",
  "wgPublicList": "public-wot-wg",
  "issueBase": "https://www.github.com/w3c/wot-scripting-api/issues/",
  "githubAPI": "https://api.github.com/repos/w3c/wot-scripting-api",
  "otherLinks": [
    {
      "key": "Contributors",
      "data": [
        {
          "value": "In the GitHub repository",
          "href": "https://github.com/w3c/wot-scripting-api/graphs/contributors"
        }
      ]
    },
    {
      "key": "Repository",
      "data": [
        {
          "value": "We are on GitHub",
          "href": "https://github.com/w3c/wot-scripting-api"
        },
        {
          "value": "File a bug",
          "href": "https://github.com/w3c/wot-scripting-api/issues"
        }
      ]
    }
  ],
  "localBiblio": {
    "WOT-ARCHITECTURE": {
      "href": "https://w3c.github.io/wot-architecture/",
      "title": "Web of Things Architecture",
      "publisher": "W3C",
      "date": "20 August 2017"
    },
    "WOT-TD": {
      "href": "https://w3c.github.io/wot-thing-description/",
      "title": "WoT Thing Description ",
      "publisher": "W3C",
      "date": "20 August 2017"
    },
    "WOT-PROTOCOL-BINDINGS": {
      "href": "https://w3c.github.io/wot-binding-templates/",
      "title": "Web of Things Protocol Binding Templates",
      "publisher": "W3C",
      "date": "20 August 2017"
    },
    "WOT-PRACTICES": {
      "href": "http://w3c.github.io/wot/current-practices/wot-practices.html",
      "title": "Web of Things Current Practices",
      "publisher": "W3C",
      "date": "6 February 2017"
    },
    "TYPESCRIPT": {
      "href": "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md",
      "title": "TypeScript Language Specification",
      "publisher": "Microsoft",
      "date": "1 October 2012"
    },
    "WEBAPPSEC": {
      "href": "https://w3c.github.io/webappsec/specs/powerfulfeatures",
      "title": "Secure Contexts",
      "publisher": "W3C",
      "date": "17 July 2015"
    }
  },
  "publishISODate": "2018-04-05T00:00:00.000Z",
  "generatedSubtitle": "Working Draft 05 April 2018"
  }
]]>
</script>
<meta name="description" content=
"The Web of Things (WoT) provides layered interoperability between Things by using the WoT Interfaces." />
<style type='text/css'>
.diff-old-a {
  font-size: smaller;
  color: red;
}

.diff-new { background-color: yellow; }
.diff-chg { background-color: lime; }
.diff-new:before,
.diff-new:after
    { content: "\2191" }
.diff-chg:before, .diff-chg:after
    { content: "\2195" }
.diff-old { text-decoration: line-through; background-color: #FBB; }
.diff-old:before,
.diff-old:after
    { content: "\2193" }
:focus { border: thin red solid}
</style>
</head>
<body class="h-entry toc-inline">
<del class="diff-old">"false"&gt;
</del>
<div class="head">
<a href="https://www.w3.org/" class= "logo">
<img alt="W3C" src= "https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72" height="48" />
</a>
<h1 id="title" class="title p-name">
Web
of
Things
(WoT)
Scripting
API
</h1>
<h2 id="w3c-working-draft-05-april-2018">
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
<del class="diff-old">First
Public
</del>
Working
Draft
<del class="diff-old">14
September
2017
</del>
<time class= "dt-published" datetime="2018-04-05">
<ins class="diff-chg">5
April
2018
</ins>
</time>
</h2>
<dl>
<dt>
This
version:
</dt>
<dd>
<del class="diff-old">https://www.w3.org/TR/2017/WD-wot-scripting-api-20170914/
</del>
<a class="u-url" href= "https://www.w3.org/TR/2018/WD-wot-scripting-api-20180405/">
<ins class="diff-chg">https://www.w3.org/TR/2018/WD-wot-scripting-api-20180405/
</ins>
</a>
</dd>
<dt>
Latest
published
version:
</dt>
<dd>
<a href= "https://www.w3.org/TR/wot-scripting-api/">
https://www.w3.org/TR/wot-scripting-api/
</a>
</dd>
<dt>
Latest
editor's
draft:
</dt>
<dd>
<a href= "https://w3c.github.io/wot-scripting-api/">
https://w3c.github.io/wot-scripting-api/
</a>
</dd>
<dt>
<ins class="diff-new">Previous
version:
</ins></dt><dd><a class="u-url" href= "https://www.w3.org/TR/2017/WD-wot-scripting-api-20170914/"><ins class="diff-new">
https://www.w3.org/TR/2017/WD-wot-scripting-api-20170914/
</ins></a></dd><dt>
Editors:
</dt>
<dd class="p-author h-card vcard">
<span class="p-name fn">
Zoltan
Kis
<del class="diff-old">,
</del>
</span>
<ins class="diff-chg">(
</ins>
<a class="p-org org h-org h-card" href= "https://www.intel.com/">
Intel
</a>
<ins class="diff-chg">)
</ins>
</dd>
<dd class="p-author h-card vcard">
<span class="p-name fn">
Kazuaki
Nimura
<del class="diff-old">,
</del>
</span>
<ins class="diff-chg">(
</ins>
<a class="p-org org h-org h-card" href= "https://www.fujitsu.com/">
Fujitsu
Ltd.
</a>
<ins class="diff-chg">)
</ins>
</dd>
<dd class="p-author h-card vcard">
<span class="p-name fn">
Daniel
Peintner
<del class="diff-old">,
</del>
</span>
<ins class="diff-chg">(
</ins>
<a class="p-org org h-org h-card" href= "https://www.siemens.com/">
Siemens
AG
</a>
<ins class="diff-new">)
</ins></dd><dd class="p-author h-card vcard">
<span class="p-name fn">
<ins class="diff-new">Johannes
Hund
</ins></span><ins class="diff-new">
(Former
Editor,
when
at
Siemens
AG)
</ins>
</dd>
<dt>
Contributors:
</dt>
<dd>
<a href= "https://github.com/w3c/wot-scripting-api/graphs/contributors">
In
the
GitHub
repository
</a>
</dd>
<dt>
Repository:
</dt>
<dd>
<a href="https://github.com/w3c/wot-scripting-api">
We
are
on
GitHub
</a>
</dd>
<dd>
<a href="https://github.com/w3c/wot-scripting-api/issues">
File
a
bug
</a>
</dd>
</dl>
<p class="copyright">
<a href= "https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">
Copyright
</a>
Â©
<del class="diff-old">2017
</del>
<ins class="diff-chg">2017-2018
</ins>
<a href="https://www.w3.org/">
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
</a>
<sup>
Â®
</sup>
(
<a href= "https://www.csail.mit.edu/">
<abbr title= "Massachusetts Institute of Technology">
MIT
</abbr>
</a>,
<a href= "https://www.ercim.eu/">
<abbr title= "European Research Consortium for Informatics and Mathematics">
ERCIM
</abbr>
</a>,
<a href="https://www.keio.ac.jp/">
Keio
</a>,
<a href= "http://ev.buaa.edu.cn/">
Beihang
</a>
).
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
<a href= "https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">
liability
</a>,
<a href= "https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">
trademark
</a>
and
<a rel="license" href= "https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document">
permissive
document
license
</a>
rules
apply.
</p>
<hr title="Separator for header" />
</div>
<section id="abstract" class="introductory">
<h2 id="abstract-0">
Abstract
</h2>
<p>
The
<a href="#dfn-web-of-things" class="internalDFN" data-link-type="dfn">
Web
of
Things
</a>
(WoT)
provides
layered
interoperability
between
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Things
</a>
by
using
the
<a href= "#dfn-wot-interface" class="internalDFN" data-link-type="dfn">
WoT
Interface
</a>
s.
</p>
<p>
This
specification
describes
a
programming
interface
representing
the
<a href="#dfn-wot-interface" class="internalDFN" data-link-type="dfn">
WoT
Interface
</a>
that
allows
scripts
run
on
a
<a href="#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>
to
discover
and
consume
(retrieve)
other
<a href= "#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
and
to
expose
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Things
</a>
characterized
by
<del class="diff-old">properties,
</del>
<a href= "#dfn-wot-interactions" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">WoT
Interactions
</ins></a>,<ins class="diff-chg">
i.e.
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Properties
</ins></a>,<a href= "#dfn-actions" class="internalDFN" data-link-type="dfn">
Actions
</a>
and
<a href="#dfn-events" class="internalDFN" data-link-type= "dfn">
Events
</a>.
</p>
<p>
Scripting
is
an
optional
"convenience"
building
block
in
WoT
and
it
is
typically
used
in
gateways
that
are
able
to
run
a
<a href= "#dfn-wot-runtime" class="internalDFN" data-link-type="dfn">
WoT
Runtime
</a>
and
<a href= "https://github.com/w3c/wot-scripting-api/tree/master/applications/script-manager">
script
management
</a>,
providing
a
convenient
way
to
extend
WoT
support
to
new
types
of
endpoints
and
implement
WoT
applications
like
<a href= "https://github.com/w3c/wot-scripting-api/tree/master/applications/thing-directory">
Thing
Directory
</a>.
</p>
</section>
<section id="sotd" class="introductory">
<h2 id="status-of-this-document">
Status
of
This
Document
</h2>
<p>
<em>
This
section
describes
the
status
of
this
document
at
the
time
of
its
publication.
Other
documents
may
supersede
this
document.
A
list
of
current
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
publications
and
the
latest
revision
of
this
technical
report
can
be
found
in
the
<a href= "https://www.w3.org/TR/">
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
technical
reports
index
</a>
at
https://www.w3.org/TR/.
</em>
</p>
<p>
Implementers
need
to
be
aware
that
this
specification
is
considered
unstable.
Vendors
interested
in
implementing
this
specification
before
it
eventually
reaches
the
Candidate
Recommendation
phase
should
subscribe
to
the
<a href= "https://github.com/w3c/wot-scripting-api">
repository
</a>
and
take
part
in
the
discussions.
</p>
<div class="ednote">
<div role="heading" class="ednote-title marker" id="h-ednote" aria-level="3">
<span>
Editor's
note
</span>
<span style= "text-transform: none">:
The
W3C
WoT
WG
is
asking
for
feedback
</span>
</div>
<p class="">
Please
contribute
to
this
draft
using
the
<a href= "https://github.com/w3c/wot-scripting-api/issues">
GitHub
Issue
</a>
feature
of
the
<a href= "https://github.com/w3c/wot-scripting-api/">
WoT
Scripting
API
</a>
repository.
For
feedback
on
security
and
privacy
considerations,
please
use
the
<a href= "https://github.com/w3c/wot-security/issues">
WoT
Security
and
Privacy
</a>
Issues.
</p>
</div>
<p>
This
document
was
published
by
the
<a href= "https://www.w3.org/WoT/WG/">
Web
of
Things
Working
Group
</a>
as
<del class="diff-old">a
First
Public
Working
</del>
<ins class="diff-chg">an
Editor's
</ins>
Draft.
<del class="diff-old">This
document
is
intended
to
become
a
W3C
Recommendation.
</del>
Comments
regarding
this
document
are
welcome.
Please
send
them
to
<a href= "mailto:public-wot-wg@w3.org">
public-wot-wg@w3.org
</a>
(
<a href= "mailto:public-wot-wg-request@w3.org?subject=subscribe">
subscribe
</a>,
<a href= "https://lists.w3.org/Archives/Public/public-wot-wg/">
archives
</a>
).
</p>
<p>
<ins class="diff-new">Changes
from
the
previous
publication
can
be
found
in
</ins><a href= "#Changes"><ins class="diff-new">
Appendix
A
</ins></a>.<ins class="diff-new">
A
</ins><a href="diff.html"><ins class="diff-new">
diff-marked
version
</ins></a><ins class="diff-new">
of
this
document
is
also
available
for
comparison
purposes.
</ins></p><p>
Publication
as
a
<del class="diff-old">First
Public
</del>
Working
Draft
does
not
imply
endorsement
by
the
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Membership.
This
is
a
draft
document
and
may
be
updated,
replaced
or
obsoleted
by
other
documents
at
any
time.
It
is
inappropriate
to
cite
this
document
as
other
than
work
in
progress.
</p>
<p>
This
document
was
produced
by
a
group
operating
under
the
<del class="diff-old">5
February
2004
</del>
<a href="https://www.w3.org/Consortium/Patent-Policy/">
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
Patent
Policy
</a>.
<abbr title="World Wide Web Consortium">
W3C
</abbr>
maintains
a
<a rel="disclosure" href= "https://www.w3.org/2004/01/pp-impl/95969/status">
public
list
of
any
patent
disclosures
</a>
made
in
connection
with
the
deliverables
of
the
group;
that
page
also
includes
instructions
for
disclosing
a
patent.
An
individual
who
has
actual
knowledge
of
a
patent
which
the
individual
believes
contains
<a href= "https://www.w3.org/Consortium/Patent-Policy/#def-essential">
Essential
Claim(s)
</a>
must
disclose
the
information
in
accordance
with
<a href= "https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">
section
6
of
the
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Patent
Policy
</a>.
</p>
<p>
This
document
is
governed
by
the
<a id="w3c_process_revision" href="https://www.w3.org/2018/Process-20180201/">
1
<del class="diff-old">March
2017
</del>
<ins class="diff-chg">February
2018
</ins>
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Process
Document
</a>.
</p>
</section>
<nav id="toc">
<h2 class="introductory" id="table-of-contents">
Table
of
Contents
</h2>
<ol class="toc">
<li class="tocline">
<a href="#introduction" class= "tocxref">
<span class="secno">
1.
</span>
Introduction
</a>
</li>
<li class="tocline">
<a href="#use-cases" class= "tocxref">
<span class="secno">
2.
</span>
Use
Cases
</a>
<ol class="toc">
<li class="tocline">
<a href="#discovery" class= "tocxref">
<span class="secno">
<ins class="diff-new">2.1
</ins></span><ins class="diff-new">
Discovery
</ins></a></li><li class="tocline"><a href="#consuming-a-thing" class= "tocxref"><span class="secno"><ins class="diff-new">
2.2
</ins></span><ins class="diff-new">
Consuming
a
Thing
</ins></a></li><li class="tocline"><a href="#exposing-a-thing" class= "tocxref"><span class="secno"><ins class="diff-new">
2.3
</ins></span><ins class="diff-new">
Exposing
a
Thing
</ins></a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#the-wot-object" class= "tocxref">
<span class="secno">
3.
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "WoT">
<code>
WoT
</code>
</span>
object
</a>
<ol class="toc">
<li class="tocline">
<a href="#the-discover-method" class= "tocxref">
<span class="secno">
3.1
</span>
The
<span data-dfn-for= "wot" data-dfn-type="dfn" data-idl="" data-title="discover()" data-lt="discover()|discover">
<code>
discover()
</code>
</span>
method
</a>
<ol class="toc">
<li class="tocline">
<a href="#the-discoverymethod-enumeration" class="tocxref">
<span class="secno">
3.1.1
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "DiscoveryMethod">
<code>
<del class="diff-old">ThingFilter
</del>
<ins class="diff-chg">DiscoveryMethod
</ins>
</code>
</span>
<del class="diff-old">dictionary
</del>
<ins class="diff-chg">enumeration
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-thingfilter-dictionary" class= "tocxref">
<span class="secno">
3.1.2
</span>
The
<span data-dfn-for= "" data-dfn-type="dfn" data-idl="" data-title= "ThingFilter">
<code>
<del class="diff-old">DiscoveryMethod
</del>
<ins class="diff-chg">ThingFilter
</ins>
</code>
</span>
<del class="diff-old">enumeration
</del>
<ins class="diff-chg">dictionary
</ins>
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#the-fetch-method" class= "tocxref">
<span class="secno">
3.2
</span>
The
<span data-dfn-for= "wot" data-dfn-type="dfn" data-idl="" data-title="fetch()" data-lt= "fetch()|fetch">
<code>
<del class="diff-old">consume()
</del>
<ins class="diff-chg">fetch()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-thingdescription-type" class= "tocxref">
<span class="secno">
3.3
</span>
The
<del class="diff-old">expose()
method
3.3.1
The
</del>
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "ThingDescription">
<code>
<del class="diff-old">ThingInit
</del>
<ins class="diff-chg">ThingDescription
</ins>
</code>
</span>
<del class="diff-old">dictionary
</del>
<ins class="diff-chg">type
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-consume-method" class= "tocxref">
<span class="secno">
3.4
</span>
<del class="diff-old">Examples
4.
The
ConsumedThing
interface
4.1
</del>
The
<span data-dfn-for= "wot" data-dfn-type="dfn" data-idl="" data-title="consume()" data-lt="consume()|consume">
<code>
<del class="diff-old">invokeAction()
</del>
<ins class="diff-chg">consume()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-produce-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.2
</del>
<ins class="diff-chg">3.5
</ins>
</span>
The
<span data-dfn-for= "wot" data-dfn-type="dfn" data-idl="" data-title="produce()" data-lt="produce()|produce">
<code>
<del class="diff-old">setProperty()
</del>
<ins class="diff-chg">produce()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-thingmodel-type" class= "tocxref">
<span class="secno">
<del class="diff-old">4.3
</del>
<ins class="diff-chg">3.6
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "ThingModel">
<code>
<del class="diff-old">getProperty()
</del>
<ins class="diff-chg">ThingModel
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">type
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-semanticannotations-dictionary" class="tocxref">
<span class="secno">
<del class="diff-old">4.4
</del>
<ins class="diff-chg">3.7
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "SemanticAnnotations">
<code>
<del class="diff-old">addListener()
</del>
<ins class="diff-chg">SemanticAnnotations
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">dictionary
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-semantictype-dictionary" class= "tocxref">
<span class="secno">
<del class="diff-old">4.5
</del>
<ins class="diff-chg">3.8
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "SemanticType">
<code>
<del class="diff-old">removeListener()
</del>
<ins class="diff-chg">SemanticType
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">dictionary
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-semanticmetadata-dictionary" class="tocxref">
<span class="secno">
<del class="diff-old">4.6
</del>
<ins class="diff-chg">3.9
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "SemanticMetadata">
<code>
<del class="diff-old">removeAllListeners()
</del>
<ins class="diff-chg">SemanticMetadata
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">dictionary
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-thingtemplate-dictionary" class= "tocxref">
<span class="secno">
<del class="diff-old">4.7
</del>
<ins class="diff-chg">3.10
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "ThingTemplate">
<code>
<del class="diff-old">observe()
</del>
<ins class="diff-chg">ThingTemplate
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">dictionary
</ins>
</a>
</li>
<li class="tocline">
<a href="#examples" class= "tocxref">
<span class="secno">
<del class="diff-old">4.8
The
ThingEventListener
</del>
<ins class="diff-chg">3.11
</ins>
</span>
<del class="diff-old">callback
</del>
<ins class="diff-chg">Examples
</ins>
</a>
</li>
</ol>
</li>
<li class="tocline">
<del class="diff-old">4.9
Events
</del>
<a href="#the-consumedthing-interface" class= "tocxref">
<span class="secno">
<del class="diff-old">4.9.1
</del>
<ins class="diff-chg">4.
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "ConsumedThing">
<code>
<del class="diff-old">PropertyChangeEvent
</del>
<ins class="diff-chg">ConsumedThing
</ins>
</code>
</span>
interface
</a>
<ol class="toc">
<li class="tocline">
<a href="#the-name-property" class= "tocxref">
<span class="secno">
<del class="diff-old">4.9.1.1
</del>
<ins class="diff-chg">4.1
</ins>
</span>
The
<span data-dfn-for= "consumedthing" data-dfn-type="dfn" data-idl="" data-title= "name">
<code>
<del class="diff-old">PropertyChangeEventInit
</del>
<ins class="diff-chg">name
</ins>
</code>
</span>
<del class="diff-old">dictionary
</del>
<ins class="diff-chg">property
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-getthingdescription-method" class="tocxref">
<span class="secno">
<del class="diff-old">4.9.2
</del>
<ins class="diff-chg">4.2
</ins>
</span>
The
<span data-dfn-for="consumedthing" data-dfn-type="dfn" data-idl="" data-title="getThingDescription()" data-lt= "getthingdescription()|getThingDescription">
<code>
<del class="diff-old">ActionInvocationEvent
</del>
<ins class="diff-chg">getThingDescription()
</ins>
</code>
</span>
<del class="diff-old">interface
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-readproperty-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.9.2.1
</del>
<ins class="diff-chg">4.3
</ins>
</span>
The
<span data-dfn-for= "consumedthing" data-dfn-type="dfn" data-idl="" data-title= "readProperty()" data-lt= "readproperty()|readProperty">
<code>
<del class="diff-old">ActionInvocationEventInit
</del>
<ins class="diff-chg">readProperty()
</ins>
</code>
</span>
<del class="diff-old">dictionary
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-writeproperty-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.9.3
</del>
<ins class="diff-chg">4.4
</ins>
</span>
The
<span data-dfn-for= "consumedthing" data-dfn-type="dfn" data-idl="" data-title= "writeProperty()" data-lt= "writeproperty()|writeProperty">
<code>
<del class="diff-old">ThingDescriptionChangeEvent
</del>
<ins class="diff-chg">writeProperty()
</ins>
</code>
</span>
<del class="diff-old">interface
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-invokeaction-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.9.3.1
</del>
<ins class="diff-chg">4.5
</ins>
</span>
The
<span data-dfn-for= "consumedthing" data-dfn-type="dfn" data-idl="" data-title= "invokeAction()" data-lt= "invokeaction()|invokeAction">
<code>
<del class="diff-old">ThingDescriptionChangeEventInit
</del>
<ins class="diff-chg">invokeAction()
</ins>
</code>
</span>
<del class="diff-old">dictionary
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-onpropertychange-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.9.3.1.1
</del>
<ins class="diff-chg">4.6
</ins>
</span>
The
<span data-dfn-for= "consumedthing" data-dfn-type="dfn" data-idl="" data-title= "onPropertyChange()" data-lt= "onpropertychange()|onPropertyChange">
<code>
<del class="diff-old">TDChangeMethod
</del>
<ins class="diff-chg">onPropertyChange()
</ins>
</code>
</span>
<del class="diff-old">enumeration
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-onevent-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.9.3.1.2
</del>
<ins class="diff-chg">4.7
</ins>
</span>
The
<span data-dfn-for= "consumedthing" data-dfn-type="dfn" data-idl="" data-title= "onEvent()" data-lt= "onevent()|onEvent">
<code>
<del class="diff-old">TDChangeType
</del>
<ins class="diff-chg">onEvent()
</ins>
</code>
</span>
<del class="diff-old">enumeration
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-ontdchange-method" class= "tocxref">
<span class="secno">
<del class="diff-old">4.9.3.1.3
</del>
<ins class="diff-chg">4.8
</ins>
</span>
The
<span data-dfn-for= "consumedthing" data-dfn-type="dfn" data-idl="" data-title= "onTDChange()" data-lt= "ontdchange()|onTDChange">
<code>
<del class="diff-old">TDChangeData
</del>
<ins class="diff-chg">onTDChange()
</ins>
</code>
</span>
<del class="diff-old">type
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#examples-0" class= "tocxref">
<span class="secno">
<del class="diff-old">4.10
</del>
<ins class="diff-chg">4.9
</ins>
</span>
Examples
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#the-exposedthing-interface" class= "tocxref">
<span class="secno">
5.
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "ExposedThing">
<code>
ExposedThing
</code>
</span>
interface
</a>
<ol class="toc">
<li class="tocline">
<a href="#the-start-method" class= "tocxref">
<span class="secno">
5.1
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="" data-title="start()" data-lt="start()|start">
<code>
<del class="diff-old">ThingDescription
</del>
<ins class="diff-chg">start()
</ins>
</code>
</span>
<del class="diff-old">type
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-stop-method" class= "tocxref">
<span class="secno">
5.2
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="" data-title="stop()" data-lt="stop()|stop">
<code>
<del class="diff-old">Request
</del>
<ins class="diff-chg">stop()
</ins>
</code>
</span>
<del class="diff-old">interface
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-register-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.2.1
</del>
<ins class="diff-chg">5.3
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="" data-title= "register()" data-lt= "register()|register">
<code>
<del class="diff-old">RequestType
</del>
<ins class="diff-chg">register()
</ins>
</code>
</span>
<del class="diff-old">enumeration
</del>
<ins class="diff-chg">method
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-unregister-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.2.2
</del>
<ins class="diff-chg">5.4
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="" data-title= "unregister()" data-lt= "unregister()|unregister">
<code>
<del class="diff-old">respond()
</del>
<ins class="diff-chg">unregister()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-emitevent-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.2.3
</del>
<ins class="diff-chg">5.5
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="" data-title= "emitEvent()" data-lt= "emitevent()|emitEvent">
<code>
<del class="diff-old">respondWithError()
</del>
<ins class="diff-chg">emitEvent()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-dataschema-type" class= "tocxref">
<span class="secno">
<del class="diff-old">5.3
</del>
<ins class="diff-chg">5.6
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "DataSchema">
<code>
<del class="diff-old">RequestHandler
</del>
<ins class="diff-chg">DataSchema
</ins>
</code>
</span>
<del class="diff-old">callback
</del>
<ins class="diff-chg">type
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-addproperty-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.4
</del>
<ins class="diff-chg">5.7
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="" data-title= "addProperty()" data-lt= "addproperty()|addProperty">
<code>
addProperty()
</code>
</span>
method
</a>
<ol class="toc">
<li class="tocline">
<del class="diff-old">5.4.1
The
ThingPropertyInit
dictionary
</del>
<a href="#the-thingproperty-dictionary" class= "tocxref">
<span class="secno">
<del class="diff-old">5.4.2
</del>
<ins class="diff-chg">5.7.1
</ins>
</span>
The
<span data-dfn-for= "" data-dfn-type="dfn" data-idl="" data-title= "ThingProperty">
<code>
<del class="diff-old">SemanticType
</del>
<ins class="diff-chg">ThingProperty
</ins>
</code>
</span>
dictionary
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#the-removeproperty-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.5
</del>
<ins class="diff-chg">5.8
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="" data-title= "removeProperty()" data-lt= "removeproperty()|removeProperty">
<code>
removeProperty()
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-addaction-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.6
</del>
<ins class="diff-chg">5.9
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="" data-title= "addAction()" data-lt= "addaction()|addAction">
<code>
addAction()
</code>
</span>
method
</a>
<ol class="toc">
<li class="tocline">
<a href="#the-thingaction-dictionary" class= "tocxref">
<span class="secno">
<del class="diff-old">5.6.1
</del>
<ins class="diff-chg">5.9.1
</ins>
</span>
The
<span data-dfn-for= "" data-dfn-type="dfn" data-idl="" data-title= "ThingAction">
<code>
<del class="diff-old">ThingActionInit
</del>
<ins class="diff-chg">ThingAction
</ins>
</code>
</span>
dictionary
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#the-removeaction-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.7
</del>
<ins class="diff-chg">5.10
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="" data-title= "removeAction()" data-lt= "removeaction()|removeAction">
<code>
removeAction()
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-addevent-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.8
</del>
<ins class="diff-chg">5.11
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="" data-title= "addEvent()" data-lt= "addevent()|addEvent">
<code>
addEvent()
</code>
</span>
method
</a>
<ol class="toc">
<li class="tocline">
<a href="#the-thingevent-dictionary" class= "tocxref">
<span class="secno">
<del class="diff-old">5.8.1
</del>
<ins class="diff-chg">5.11.1
</ins>
</span>
The
<span data-dfn-for= "" data-dfn-type="dfn" data-idl="" data-title= "ThingEvent">
<code>
<del class="diff-old">ThingEventInit
</del>
<ins class="diff-chg">ThingEvent
</ins>
</code>
</span>
dictionary
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#the-removeevent-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.9
</del>
<ins class="diff-chg">5.12
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="" data-title= "removeEvent()" data-lt= "removeevent()|removeEvent">
<code>
removeEvent()
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-propertyreadhandler-callback" class="tocxref">
<span class="secno">
<del class="diff-old">5.10
</del>
<ins class="diff-chg">5.13
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "PropertyReadHandler">
<code>
<del class="diff-old">onRetrieveProperty()
</del>
<ins class="diff-chg">PropertyReadHandler
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">callback
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-propertywritehandler-callback" class="tocxref">
<span class="secno">
<del class="diff-old">5.11
</del>
<ins class="diff-chg">5.14
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "PropertyWriteHandler">
<code>
<del class="diff-old">onUpdateProperty()
</del>
<ins class="diff-chg">PropertyWriteHandler
</ins>
</code>
</span>
<del class="diff-old">method
</del>
<ins class="diff-chg">callback
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-actionhandler-callback" class= "tocxref">
<span class="secno">
<del class="diff-old">5.12
</del>
<ins class="diff-chg">5.15
</ins>
</span>
The
<span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "ActionHandler">
<code>
<del class="diff-old">onInvokeAction()
</del>
<ins class="diff-chg">ActionHandler
</ins></code></span><ins class="diff-chg">
callback
</ins></a></li><li class="tocline"><a href="#the-setpropertyreadhandler-method" class="tocxref"><span class="secno"><ins class="diff-chg">
5.16
</ins></span><ins class="diff-chg">
The
</ins><span data-dfn-for="exposedthing" data-dfn-type="dfn" data-idl="" data-title="setPropertyReadHandler()" data-lt= "setpropertyreadhandler()|setPropertyReadHandler"><code><ins class="diff-chg">
setPropertyReadHandler()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-setpropertywritehandler-method" class="tocxref">
<span class="secno">
<del class="diff-old">5.13
</del>
<ins class="diff-chg">5.17
</ins>
</span>
The
<span data-dfn-for="exposedthing" data-dfn-type="dfn" data-idl="" data-title="setPropertyWriteHandler()" data-lt= "setpropertywritehandler()|setPropertyWriteHandler">
<code>
<del class="diff-old">onObserve()
</del>
<ins class="diff-chg">setPropertyWriteHandler()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-setactionhandler-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.14
</del>
<ins class="diff-chg">5.18
</ins>
</span>
The
<span data-dfn-for= "exposedthing" data-dfn-type="dfn" data-idl="" data-title= "setActionHandler()" data-lt= "setactionhandler()|setActionHandler">
<code>
<del class="diff-old">register()
</del>
<ins class="diff-chg">setActionHandler()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#examples-1" class= "tocxref">
<span class="secno">
<del class="diff-old">5.15
</del>
<ins class="diff-chg">5.19
</ins></span><ins class="diff-chg">
Examples
</ins></a></li></ol></li><li class="tocline"><a href= "#experimental-extensions-to-the-consumedthing-interface" class= "tocxref"><span class="secno"><ins class="diff-chg">
6.
</ins></span><ins class="diff-chg">
Experimental
extensions
to
the
</ins><strong><ins class="diff-chg">
ConsumedThing
</ins></strong><ins class="diff-chg">
interface
</ins></a><ol class="toc"><li class="tocline"><a href="#the-getproperties-method" class= "tocxref"><span class="secno"><ins class="diff-chg">
6.1
</ins>
</span>
The
<span data-dfn-for= "consumedthing" data-dfn-type="dfn" data-idl="" data-title= "getProperties()" data-lt= "getproperties()|getProperties">
<code>
<del class="diff-old">unregister()
</del>
<ins class="diff-chg">getProperties()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-getactions-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.16
</del>
<ins class="diff-chg">6.2
</ins>
</span>
The
<span data-dfn-for= "consumedthing" data-dfn-type="dfn" data-idl="" data-title= "getActions()" data-lt= "getactions()|getActions">
<code>
<del class="diff-old">start()
</del>
<ins class="diff-chg">getActions()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-getevents-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.17
</del>
<ins class="diff-chg">6.3
</ins>
</span>
The
<span data-dfn-for= "consumedthing" data-dfn-type="dfn" data-idl="" data-title= "getEvents()" data-lt= "getevents()|getEvents">
<code>
<del class="diff-old">stop()
</del>
<ins class="diff-chg">getEvents()
</ins>
</code>
</span>
method
</a>
</li>
<li class="tocline">
<a href="#the-getlinks-method" class= "tocxref">
<span class="secno">
<del class="diff-old">5.18
</del>
<ins class="diff-chg">6.4
</ins>
</span>
The
<span data-dfn-for= "consumedthing" data-dfn-type="dfn" data-idl="" data-title= "getLinks()" data-lt= "getlinks()|getLinks">
<code>
<del class="diff-old">emitEvent()
</del>
<ins class="diff-chg">getLinks()
</ins>
</code>
</span>
method
</a>
<ol class="toc">
<li class="tocline">
<a href="#the-tdlink-dictionary" class= "tocxref">
<span class="secno">
<ins class="diff-new">6.4.1
</ins></span><ins class="diff-new">
The
</ins><span data-dfn-for= "" data-dfn-type="dfn" data-idl="" data-title= "TDLink"><code><ins class="diff-new">
TDLink
</ins></code></span><ins class="diff-new">
dictionary
</ins></a>
</li>
</ol>
</li>
</ol>
</li>
<li class="tocline">
<a href="#observables" class= "tocxref">
<span class="secno">
<del class="diff-old">5.19
</del>
<ins class="diff-chg">7.
</ins>
</span>
<del class="diff-old">Events
supported
by
ExposedThing
</del>
<ins class="diff-chg">Observables
</ins></a><ol class="toc"><li class="tocline"><a href="#the-observer-interface" class= "tocxref"><span class="secno"><ins class="diff-chg">
7.1
</ins></span><ins class="diff-chg">
The
</ins><span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "Observer"><code><ins class="diff-chg">
Observer
</ins></code></span><ins class="diff-chg">
interface
</ins>
</a>
</li>
<li class="tocline">
<a href="#the-subscription-interface" class= "tocxref">
<span class="secno">
<del class="diff-old">5.20
</del>
<ins class="diff-chg">7.2
</ins>
</span>
<del class="diff-old">Examples
</del>
<ins class="diff-chg">The
</ins><span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "Subscription"><code><ins class="diff-chg">
Subscription
</ins></code></span><ins class="diff-chg">
interface
</ins></a></li><li class="tocline"><a href="#the-observable-interface" class= "tocxref"><span class="secno"><ins class="diff-chg">
7.3
</ins></span><ins class="diff-chg">
The
</ins><span data-dfn-for="" data-dfn-type="dfn" data-idl="" data-title= "Observable"><code><ins class="diff-chg">
Observable
</ins></code></span><ins class="diff-chg">
interface
</ins>
</a>
</li>
</ol>
</li>
<li class="tocline">
<a href="#security" class= "tocxref">
<span class="secno">
<del class="diff-old">6.
</del>
<ins class="diff-chg">8.
</ins>
</span>
Security
and
Privacy
</a>
</li>
<li class="tocline">
<a href="#terminology-and-conventions" class= "tocxref">
<span class="secno">
<del class="diff-old">7.
</del>
<ins class="diff-chg">9.
</ins>
</span>
Terminology
and
conventions
</a>
</li>
<li class="tocline">
<a href="#conformance" class= "tocxref">
<span class="secno">
<del class="diff-old">8.
</del>
<ins class="diff-chg">10.
</ins>
</span>
Conformance
</a>
</li>
<li class="tocline">
<a href="#Changes" class="tocxref">
<span class= "secno">
A.
</span>
Changes
</a>
</li>
<li class="tocline">
<a href="#openissues" class= "tocxref">
<span class="secno">
B.
</span>
Open
issues
</a>
</li>
<li class="tocline">
<a href="#acknowledgements" class= "tocxref">
<span class="secno">
C.
</span>
Acknowledgements
</a>
</li>
<li class="tocline">
<a href="#references" class= "tocxref">
<span class="secno">
D.
</span>
References
</a>
<ol class="toc">
<li class="tocline">
<a href="#normative-references" class= "tocxref">
<span class="secno">
D.1
</span>
Normative
references
</a>
</li>
<li class="tocline">
<a href="#informative-references" class= "tocxref">
<span class="secno">
<ins class="diff-new">D.2
</ins></span><ins class="diff-new">
Informative
references
</ins></a></li>
</ol>
</li>
</ol>
</nav>
<section id="introduction">
<h2 id="x1-introduction">
<span class="secno">
1.
</span>
Introduction
</h2>
<p>
The
overall
WoT
concepts
are
described
in
the
<a href= "https://www.w3.org/TR/2017/WD-wot-architecture-20170914/">
WoT
Architecture
</a>
document.
The
Web
of
Things
is
made
of
entities
(
<a href="#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>
s)
that
can
describe
their
capabilities
in
a
machine-interpretable
format,
the
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
</a>
(TD)
and
expose
these
capabilities
through
the
<a href= "#dfn-wot-interface" class="internalDFN" data-link-type="dfn">
WoT
Interface
</a>.
Support
for
scripting
is
optional
for
WoT
devices.
</p>
<p>
By
<a href="#dfn-consume" class="internalDFN" data-link-type= "dfn">
consuming
a
TD
</a>,
a
client
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>
creates
a
runtime
resource
model
that
allows
accessing
the
<del class="diff-old">properties,
</del>
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Properties
</ins></a>,<a href= "#dfn-actions" class="internalDFN" data-link-type="dfn">
Actions
</a>
and
<a href="#dfn-events" class="internalDFN" data-link-type= "dfn">
Events
</a>
exposed
by
the
server
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>.
</p>
<p>
Exposing
a
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
requires
defining
a
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
</a>
<ins class="diff-new">(TD)
</ins>
and
instantiating
a
software
stack
needed
to
serve
requests
for
accessing
the
exposed
<del class="diff-old">properties,
</del>
<a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Properties
</ins></a>,<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Actions
</a>
and
<a href="#dfn-events" class= "internalDFN" data-link-type="dfn">
Events
</a>.
This
specification
describes
how
to
expose
and
consume
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>
s
by
a
script.
</p>
<div class="note">
<div role="heading" class="note-title marker" id="h-note" aria-level="3">
<span>
Note
</span>
</div>
<p class="">
Typically
scripts
are
meant
to
be
used
on
devices
able
to
provide
resources
(with
a
<a href="#dfn-wot-interface" class= "internalDFN" data-link-type="dfn">
WoT
interface
</a>
)
for
managing
(installing,
updating,
running)
scripts,
such
as
bridges
or
gateways
that
expose
and
control
simpler
devices
as
WoT
<a href= "#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>
s.
</p>
</div>
<div class="note">
<div role="heading" class="note-title marker" id="h-note-0" aria-level="3">
<span>
<ins class="diff-new">Note
</ins></span></div><p class=""><ins class="diff-new">
This
specification
does
not
make
assumptions
on
how
the
</ins><a href="#dfn-wot-runtime" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
WoT
Runtime
</ins></a><ins class="diff-new">
handles
and
runs
scripts,
including
single
or
multiple
tenancy,
script
deployment
and
lifecycle
management.
The
API
already
supports
the
generic
mechanisms
that
make
it
possible
to
implement
script
management,
for
instance
by
exposing
a
manager
</ins><a href="#dfn-things" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
Thing
</ins></a><ins class="diff-new">
whose
</ins><a href="#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Actions
</ins></a><ins class="diff-new">
(action
handlers)
implement
script
lifecycle
management
operations.
</ins></p></div>
<p>
For
an
introduction
on
how
scripts
could
be
used
in
<a href= "#dfn-web-of-things" class="internalDFN" data-link-type="dfn">
Web
of
Things
</a>,
check
the
<a href= "https://w3c.github.io/wot-scripting-api/primer">
Primer
</a>
document.
For
some
background
on
API
design
decisions
check
the
<a href= "https://w3c.github.io/wot-scripting-api/rationale">
Rationale
</a>
document.
</p>
</section>
<section class="informative" id="use-cases">
<h2 id="x2-use-cases">
<span class="secno">
2.
</span>
Use
Cases
</h2>
<p>
<em>
This
section
is
non-normative.
</em>
</p>
<p>
The
following
scripting
use
cases
are
<del class="diff-old">covered
</del>
<ins class="diff-chg">supported
</ins>
in
this
specification:
</p>
<section id="discovery">
<h3 id="x2-1-discovery">
<span class="secno">
<ins class="diff-new">2.1
</ins></span><ins class="diff-new">
Discovery
</ins></h3>
<ul>
<li>
Discover
all
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
in
the
WoT
network
by
sending
a
broadcast
request.
</li>
<li>
Discover
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
running
in
the
local
<a href= "#dfn-wot-runtime" class="internalDFN" data-link-type="dfn">
WoT
Runtime
</a>.
</li>
<li>
Discover
nearby
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s,
for
instance
by
NFC
or
Bluetooth.
</li>
<li>
Discover
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
by
sending
a
discovery
request
to
a
given
registry.
</li>
<li>
Discover
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
by
filters
defined
on
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
</a>
s
</li>
<li>
Discover
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
by
semantic
filters.
</li>
<li>
Stop
or
suppress
an
ongoing
discovery
process.
</li>
<li>
<ins class="diff-new">Optionally
specify
a
timeout
to
the
discovery
process
after
which
it
is
stopped/suppressed.
</ins></li></ul></section><section id="consuming-a-thing"><h3 id="x2-2-consuming-a-thing"><span class="secno"><ins class="diff-new">
2.2
</ins></span><ins class="diff-new">
Consuming
a
Thing
</ins></h3><ul><li>
Fetch
<del class="diff-old">and
consume
</del>
<ins class="diff-chg">a
</ins><a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
Description
</ins></a><ins class="diff-chg">
of
a
</ins><a href= "#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
</ins></a><ins class="diff-chg">
given
its
URL.
</ins></li><li><a href="#dfn-consume" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Consume
</ins>
a
TD
</a>
of
a
<del class="diff-old">remote
</del>
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
<del class="diff-old">.
</del>
</a>,
<ins class="diff-chg">including
parsing
the
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
TD
</ins></a><ins class="diff-chg">
and
generating
the
protocol
bindings
in
order
to
access
lower
level
functionality.
</ins>
</li>
<li>
On
a
consumed
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>,
<ul>
<li>
<del class="diff-old">Get
</del>
<ins class="diff-chg">Read
</ins>
the
value
of
a
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>
or
set
of
properties.
</li>
<li>
Set
the
value
of
a
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>
or
a
set
of
properties.
</li>
<li>
<del class="diff-old">Invoke
an
Action
.
</del>
Observe
<del class="diff-old">Events
.
Add
</del>
<ins class="diff-chg">value
changes
of
</ins>
a
<del class="diff-old">listener
to
an
Event
</del>
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
<ins class="diff-chg">Property
</ins>
</a>.
</li>
<li>
<del class="diff-old">Remove
a
listener
from
</del>
<ins class="diff-chg">Invoke
</ins>
an
<del class="diff-old">Event
</del>
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Action
</ins>
</a>.
</li>
<li>
<del class="diff-old">Remove
all
listeners.
Default
</del>
<ins class="diff-chg">Observe
</ins><a href="#dfn-events" class="internalDFN" data-link-type="dfn">
Events
</a>
<del class="diff-old">are
</del>
<ins class="diff-chg">emitted
by
</ins>
the
<del class="diff-old">following:
A
Property
has
changed.
</del>
<a href= "#dfn-things" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Thing
</ins></a>.
</li>
<li>
<del class="diff-old">An
Action
</del>
<ins class="diff-chg">Observe
changes
to
the
</ins><a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
Description
</ins>
</a>
<del class="diff-old">has
been
invoked.
</del>
<ins class="diff-chg">of
the
</ins><a href="#dfn-things" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Thing
</ins></a>.
</li>
<li>
<ins class="diff-chg">Get
the
</ins><a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
<del class="diff-old">has
changed,
i.e.
Properties
,
Events
or
Actions
have
been
defined,
removed,
or
</del>
</a>.
</li>
<li>
<ins class="diff-chg">Get
</ins>
the
<del class="diff-old">definition
has
changed.
</del>
<ins class="diff-chg">list
of
linked
resources
based
on
the
</ins><a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Thing
Description
</ins></a>.
</li>
</ul>
</li>
</ul>
<del class="diff-old">Consume
</del>
</section>
<section id="exposing-a-thing">
<h3 id="x2-3-exposing-a-thing">
<span class="secno">
<ins class="diff-chg">2.3
</ins></span><ins class="diff-chg">
Exposing
</ins>
a
<del class="diff-old">thing.
</del>
<ins class="diff-chg">Thing
</ins></h3><ul><li><ins class="diff-chg">
Exposing
the
</ins><a href="#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
</ins></a><ins class="diff-chg">
includes
generating
the
protocol
bindings
in
order
to
access
lower
level
functionality.
</ins>
</li>
<li>
Create
<del class="diff-old">and
expose
</del>
a
local
<del class="diff-old">Thing
</del>
<a href="#dom-exposedthing" class="internalDFN" data-link-type="dfn">
<code>
<ins class="diff-chg">ExposedThing
</ins></code>
</a>
<ins class="diff-new">to
be
exposed,
</ins>
based
on
a
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
<del class="diff-old">.
Programmatically
create
and
expose
a
local
Thing
.
This
may
include
the
following
use
cases:
Create
</del>
</a>
<ins class="diff-chg">provided
in
string
serialized
format,
or
out
of
</ins>
a
<del class="diff-old">local
Thing
.
</del>
<ins class="diff-chg">template
or
an
existing
</ins><a href= "#dom-consumedthing" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ConsumedThing
</ins></code></a><ins class="diff-chg">
object.
</ins>
</li>
<li>
Add
a
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
definition
to
the
<a href= "#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>.
</li>
<li>
Add
an
<del class="diff-old">Event
</del>
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Action
</ins>
</a>
definition
to
the
<a href= "#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>.
</li>
<li>
Add
an
<del class="diff-old">Action
</del>
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Event
</ins>
</a>
definition
to
the
<a href= "#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>.
</li>
<li>
Attach
semantic
information
to
<del class="diff-old">an
Action
</del>
<ins class="diff-chg">the
</ins><a href="#dfn-things" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
</ins></a>.
</li>
<li>
Attach
semantic
information
to
a
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>.
</li>
<li>
Attach
semantic
information
to
an
<a href="#dfn-actions" class= "internalDFN" data-link-type="dfn">
<ins class="diff-chg">Action
</ins></a>.</li><li><ins class="diff-chg">
Attach
semantic
information
to
an
</ins><a href="#dfn-events" class= "internalDFN" data-link-type="dfn">
Event
</a>.
</li>
<li>
Emit
an
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
Event
</a>,
i.e.
notify
all
listeners
subscribed
to
that
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
Event
</a>.
</li>
<li>
<del class="diff-old">Register
handlers
</del>
<ins class="diff-chg">Provide
notifications
</ins>
for
<del class="diff-old">external
requests:
to
retrieve
a
Property
value;
to
update
a
Property
</del>
<a href="#dfn-td" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">TD
</ins>
</a>
<del class="diff-old">value;
to
run
an
Action
:
take
the
parameters
from
the
request,
execute
the
defined
action,
and
return
the
result;
to
add
a
listener
</del>
<ins class="diff-chg">changes
</ins>
to
<del class="diff-old">an
Event
;
</del>
<ins class="diff-chg">clients
subscribed
</ins>
to
<del class="diff-old">remove
an
Event
listener.
</del>
<ins class="diff-chg">that.
</ins>
</li>
<li>
<del class="diff-old">to
fetch
</del>
<ins class="diff-chg">Mark/unmark
</ins>
the
Thing
<del class="diff-old">Description
;
Register
the
Thing.
</del>
<ins class="diff-chg">to
be
discoverable.
</ins>
</li>
<li>
<del class="diff-old">Unregister
</del>
<ins class="diff-chg">Mark/unmark
</ins>
the
<del class="diff-old">Thing.
</del>
<ins class="diff-chg">Thing
to
be
consumable.
</ins>
</li>
<li>
Start
the
exposed
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
in
order
to
process
external
requests.
</li>
<li>
Stop
the
exposed
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>.
</li>
<del class="diff-old">The
following
use
cases
are
being
considered
</del>
<li>
<ins class="diff-chg">Register
handlers
</ins>
for
<del class="diff-old">next
versions:
</del>
<ins class="diff-chg">external
requests:
</ins>
<ul>
<li>
<del class="diff-old">Add,
remove
and
update
the
definition
of
</del>
<ins class="diff-chg">to
retrieve
</ins>
a
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
<del class="diff-old">on
a
Thing
that
runs
in
the
same
the
WoT
Runtime.
</del>
<ins class="diff-chg">value;
</ins>
</li>
<li>
<del class="diff-old">Add,
remove
and
</del>
<ins class="diff-chg">to
</ins>
update
<del class="diff-old">the
definition
of
an
Action
on
</del>
a
<del class="diff-old">Thing
that
runs
in
the
same
the
WoT
Runtime.
</del>
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Property
</ins></a><ins class="diff-chg">
value;
</ins>
</li>
<li>
<del class="diff-old">Add,
remove
and
update
the
definition
of
</del>
<ins class="diff-chg">to
run
</ins>
an
<del class="diff-old">Event
on
a
Thing
that
runs
in
</del>
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Action
</ins></a>:<ins class="diff-chg">
take
</ins>
the
<del class="diff-old">same
</del>
<ins class="diff-chg">parameters
from
</ins>
the
<del class="diff-old">WoT
Runtime.
</del>
<ins class="diff-chg">request,
execute
the
defined
action,
and
return
the
result;
</ins>
</li>
</ul>
</li>
</ul>
</section>
</section>
<section data-dfn-for="WoT" id="the-wot-object">
<h2 id="x3-the-wot-object">
<span class="secno">
3.
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-wot" data-idl="" data-title="WoT">
<code>
WoT
</code>
</dfn>
object
</h2>
<p>
The
WoT
object
is
the
<del class="diff-old">main
</del>
API
entry
point
and
it
is
exposed
by
an
implementation
of
the
<a href="#dfn-wot-runtime" class= "internalDFN" data-link-type="dfn">
WoT
Runtime
</a>.
The
<dfn data-dfn-type="dfn" id="dfn-wot-object">
WoT
object
</dfn>
<del class="diff-old">has
no
internal
state
and
provides
</del>
<ins class="diff-chg">does
not
expose
properties,
only
</ins>
methods
for
discovering,
consuming
and
exposing
a
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>.
</p>
<div class="note">
<div role="heading" class="note-title marker" id="h-note-1" aria-level="3">
<span>
Note
</span>
</div>
<p class="">
Browser
implementations
<em class="rfc2119" title= "SHOULD">
SHOULD
</em>
use
a
namespace
object
such
as
<code>
wot
</code>,
and
<a href= "https://nodejs.org/en/">
Node.js
</a>
-like
runtimes
<em class= "rfc2119" title="MAY">
MAY
</em>
provide
the
API
object
through
the
<a href= "https://nodejs.org/api/modules.html">
<code>
require()
</code>
</a>
or
<a href= "http://www.ecma-international.org/ecma-262/6.0/#sec-imports">
<code>
import
</code>
</a>
mechanism.
</p>
</div>
<div>
<pre class="def idl"><span class="idlInterface" id="idl-def-wot"
data-idl="" data-title="WoT">interface <span class=
<del class="diff-old">"idlInterfaceID"&gt;&lt;a data-lt="WoT" href="#dom-wot" class=
"internalDFN" data-link-type="dfn" data-for=
""&gt; {
&lt;span class="idlMethod" id="idl-def-wot-discover(filter)" data-idl=
</del>
<ins class="diff-chg">"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-wot" class="internalDFN" data-link-type=
"dfn"><code>WoT</code></a></span> {
</ins><span class="idlMethod" id="idl-def-wot-discover-filter" data-idl=
"" data-title="discover" data-dfn-for="wot">    <span class=
<del class="diff-old">"idlMethType"&gt;&lt;a href="#dfn-observable" class="internalDFN"
data-link-type="dfn"&gt;Observable&lt;&lt;a href="#dom-consumedthing"
class="internalDFN" data-link-type=
</del>
<ins class="diff-chg">"idlMethType"><a href="#dom-observable" class="internalDFN"
data-link-type="dfn"><code>Observable</code></a>&lt;<a href=
"#dom-consumedthing" class="internalDFN" data-link-type=
</ins>
"dfn"><code>ConsumedThing</code></a>&gt;</span> <span class=
<del class="diff-old">"idlMethName"&gt;&lt;a data-lt="discover()|discover()|discover"
data-lt-nodefault="" href="#dom-wot-discover()" class="internalDFN"
data-link-type="dfn" data-for=
"WoT"&gt;discover&lt;a href="#dom-thingfilter"
class="internalDFN" data-link-type=
</del>
<ins class="diff-chg">"idlMethName"><a data-no-default="" data-link-for="wot" data-lt=
"discover()|discover" href="#dom-wot-discover" class="internalDFN"
data-link-type="dfn">discover</a></span>(<span class=
"idlParam">optional <span class="idlParamType"><a href=
"#dom-thingfilter" class="internalDFN" data-link-type=
</ins>
"dfn"><code>ThingFilter</code></a></span> <span class=
"idlParamName">filter</span></span>);</span>
<del class="diff-old">&lt;span class="idlMethod" id="idl-def-wot-consume(url)" data-idl=""
data-title="consume" data-dfn-for="wot"&gt;    &lt;span class=
</del>
<span class="idlMethod" id="idl-def-wot-fetch-url" data-idl=""
<ins class="diff-chg">data-title="fetch" data-dfn-for="wot">    <span class=
</ins>
"idlMethType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;&lt;a href="#dom-consumedthing"
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="#dom-thingdescription"
</ins>
class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt;    &lt;span class=
"idlMethName"&gt;&lt;a data-lt="consume()|consume()|consume"
data-lt-nodefault="" href="#dom-wot-consume()" class="internalDFN"
data-link-type="dfn" data-for="WoT"&gt;consume(&lt;span class=
</del>
<ins class="diff-chg">"dfn"><code>ThingDescription</code></a>&gt;</span> <span class=
"idlMethName"><a data-no-default="" data-link-for="wot" data-lt=
"fetch()|fetch" href="#dom-wot-fetch" class="internalDFN"
data-link-type="dfn">fetch</a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">url</span></span>);</span>
<del class="diff-old">&lt;span class="idlMethod" id="idl-def-wot-expose(init)" data-idl=""
data-title="expose" data-dfn-for="wot"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;&lt;a href="#dom-exposedthing"
class="internalDFN" data-link-type=
"dfn"&gt;     &lt;span class=
"idlMethName"&gt;&lt;a data-lt="expose()|expose()|expose"
data-lt-nodefault="" href="#dom-wot-expose()" class="internalDFN"
data-link-type="dfn" data-for="WoT"&gt;expose(&lt;span class=
"idlParam"&gt;&lt;a href="#dom-thinginit"
class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;init
};
</del>
<span class="idlMethod" id="idl-def-wot-consume-td" data-idl=""
<ins class="diff-chg">data-title="consume" data-dfn-for="wot">    <span class=
"idlMethType"><a href="#dom-consumedthing" class="internalDFN"
data-link-type=
"dfn"><code>ConsumedThing</code></a></span>             <span class="idlMethName"><a data-no-default=""
data-link-for="wot" data-lt="consume()|consume" href=
"#dom-wot-consume" class="internalDFN" data-link-type=
"dfn">consume</a></span>(<span class="idlParam"><span class=
"idlParamType"><a href="#dom-thingdescription" class="internalDFN"
data-link-type=
"dfn"><code>ThingDescription</code></a></span> <span class=
"idlParamName">td</span></span>);</span>
</ins><span class="idlMethod" id="idl-def-wot-produce-model" data-idl=""<ins class="diff-chg">
data-title="produce" data-dfn-for="wot">    <span class=
"idlMethType"><a href="#dom-exposedthing" class="internalDFN"
data-link-type=
"dfn"><code>ExposedThing</code></a></span>              <span class="idlMethName"><a data-no-default=""
data-link-for="wot" data-lt="produce()|produce" href=
"#dom-wot-produce" class="internalDFN" data-link-type=
"dfn">produce</a></span>(<span class="idlParam"><span class=
"idlParamType"><a href="#dom-thingmodel" class="internalDFN"
data-link-type=
"dfn"><code>ThingModel</code></a></span> <span class="idlParamName">model</span></span>);</span>
};</span>
</ins><span class="idlTypedef" id="idl-def-thingdescription" data-idl=""<ins class="diff-chg">
data-title="ThingDescription">typedef <span class=
"idlTypedefType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-thingdescription" class=
"internalDFN" data-link-type=
"dfn"><code>ThingDescription</code></a></span>;</span>
</ins><span class="idlTypedef" id="idl-def-thingmodel" data-idl=""<ins class="diff-chg">
data-title="ThingModel">typedef <span class=
"idlTypedefType">(<a href="#dom-thingtemplate" class="internalDFN"
data-link-type="dfn"><code>ThingTemplate</code></a> or <a href=
"#dom-thingdescription" class="internalDFN" data-link-type=
"dfn"><code>ThingDescription</code></a>)</span> <span class=
"idlTypedefID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingmodel" class="internalDFN" data-link-type=
"dfn">
</ins><code><ins class="diff-chg">
ThingModel
</ins></code></a></span><ins class="diff-chg">
;
</ins>
</span>
</pre>
</div>
<div class="ednote">
<div role="heading" class="ednote-title marker" id="h-ednote-0" aria-level="3">
<span>
Editor's
note
</span>
</div>
<p class="">
The
algorithms
for
the
WoT
methods
will
be
specified
<del class="diff-old">later.
</del>
<ins class="diff-chg">later,
including
error
handling
and
security
considerations.
</ins>
</p>
</div>
<section id="the-discover-method">
<h3 id="x3-1-the-discover-method">
<span class="secno">
3.1
</span>
The
<dfn data-dfn-for="wot" data-dfn-type="dfn" id= "dom-wot-discover" data-idl="" data-title="discover()" data-lt= "discover()|discover">
<code>
discover()
</code>
</dfn>
method
</h3>
<p>
Starts
the
discovery
process
that
will
provide
<code>
<a href= "#dom-consumedthing" class="internalDFN" data-link-type= "dfn">
<code>
ConsumedThing
</code>
</a>
</code>
objects
that
match
the
optional
argument
<code>
<a href="#dom-thingfilter" class= "internalDFN" data-link-type= "dfn">
<code>
ThingFilter
</code>
</a>
<del class="diff-old">.
</del>
</code>.
When
the
argument
is
not
provided,
starts
the
widest
discovery
the
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
</a>
and
<a href="#dfn-protocol-bindings" class="internalDFN" data-link-type="dfn">
Protocol
Bindings
</a>
<del class="diff-old">allow.
</del>
<ins class="diff-chg">allow
and
support.
</ins>
Returns
an
<a href= "https://github.com/tc39/proposal-observable">
<code>
Observable
</code>
</a>
object
that
can
be
subscribed
<ins class="diff-new">to
</ins>
and
unsubscribed
<del class="diff-old">to.
</del>
<ins class="diff-chg">from.
</ins>
</p>
<section data-dfn-for="DiscoveryMethod" id= "the-discoverymethod-enumeration">
<h4 id="x3-1-1-the-discoverymethod-enumeration">
<span class= "secno">
3.1.1
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-discoverymethod" data-idl="" data-title= "DiscoveryMethod">
<code>
<ins class="diff-new">DiscoveryMethod
</ins></code></dfn><ins class="diff-new">
enumeration
</ins></h4><div><pre class="def idl"><span class="idlTypedef" id=<ins class="diff-new">
"idl-def-discoverymethod" data-idl="" data-title=
"DiscoveryMethod">typedef <span class="idlTypedefType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-discoverymethod" class=
"internalDFN" data-link-type=
"dfn">
</ins><code><ins class="diff-new">
DiscoveryMethod
</ins></code></a></span><ins class="diff-new">
;
</ins></span></pre></div><p><a href="#dom-discoverymethod" class="internalDFN" data-link-type="dfn"><code><ins class="diff-new">
DiscoveryMethod
</ins></code></a><ins class="diff-new">
represents
the
discovery
type
to
be
used:
</ins></p><ul><li><dfn data-dfn-type="dfn" id="dfn-any"><ins class="diff-new">
"any"
</ins></dfn><ins class="diff-new">
does
not
provide
any
restriction
</ins></li><li><dfn data-dfn-type="dfn" id="dfn-local"><ins class="diff-new">
"local"
</ins></dfn><ins class="diff-new">
for
discovering
</ins><a href="#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Thing
</ins></a><ins class="diff-new">
s
defined
in
the
same
device
</ins></li><li><dfn data-dfn-type="dfn" id="dfn-nearby"><ins class="diff-new">
"nearby"
</ins></dfn><ins class="diff-new">
for
discovering
</ins><a href="#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Thing
</ins></a><ins class="diff-new">
s
nearby
the
device,
e.g.
by
Bluetooth
or
NFC
</ins></li><li><dfn data-dfn-type="dfn" id="dfn-directory"><ins class="diff-new">
"directory"
</ins></dfn><ins class="diff-new">
for
discovery
based
on
a
service
provided
by
a
directory
or
repository
of
</ins><a href="#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Thing
</ins></a><ins class="diff-new">
s
</ins></li><li><dfn data-dfn-type="dfn" id="dfn-broadcast"><ins class="diff-new">
"broadcast"
</ins></dfn><ins class="diff-new">
for
an
open
ended
discovery
based
on
sending
a
request
to
a
broadcast
address
</ins></li><li><dfn data-dfn-type="dfn" id="dfn-other"><ins class="diff-new">
"other"
</ins></dfn><ins class="diff-new">
for
a
proprietary
method
defined
by
the
solution.
</ins></li></ul></section><section data-dfn-for="ThingFilter" id= "the-thingfilter-dictionary"><h4 id="x3-1-2-the-thingfilter-dictionary"><span class= "secno"><ins class="diff-new">
3.1.2
</ins></span><ins class="diff-new">
The
</ins>
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-thingfilter" data-idl="" data-title= "ThingFilter">
<code>
ThingFilter
</code>
</dfn>
dictionary
</h4>
<p>
The
<a href="#dom-thingfilter" class="internalDFN" data-link-type="dfn">
<code>
ThingFilter
</code>
</a>
dictionary
that
represents
the
constraints
for
discovering
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
s
as
key-value
pairs.
</p>
<div>
<pre class="def idl"><span class="idlDictionary" id=
"idl-def-thingfilter" data-idl="" data-title=
<del class="diff-old">"ThingFilter"&gt;dictionary &lt;a data-lt=
"ThingFilter" href="#dom-thingfilter" class="internalDFN"
data-link-type="dfn" data-for=
""&gt; {
</del>
<ins class="diff-chg">"ThingFilter">dictionary <span class=
"idlDictionaryID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingfilter" class="internalDFN" data-link-type=
"dfn"><code>ThingFilter</code></a></span> {
</ins>
<span class="idlMember" id="idl-def-thingfilter-method" data-idl=""
data-title="method" data-dfn-for="thingfilter">    <span class=
<del class="diff-old">"idlMemberType"&gt;(DiscoveryType or &lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-lt="method"
href="#dom-thingfilter-method" class="internalDFN" data-link-type=
"dfn" data-for=
"ThingFilter"&gt; = &lt;span class=
</del>
<ins class="diff-chg">"idlMemberType"><a href="#dom-discoverymethod" class="internalDFN"
data-link-type=
"dfn"><code>DiscoveryMethod</code></a></span>      <span class=
"idlMemberName"><a data-no-default="" data-link-for="thingfilter"
data-lt="" href="#dom-thingfilter-method" class="internalDFN"
data-link-type="dfn"><code>method</code></a></span> = <span class=
</ins>
"idlMemberValue">"any"</span>;</span>
<span class="idlMember" id="idl-def-thingfilter-url" data-idl=""
data-title="url" data-dfn-for="thingfilter">    <span class=
"idlMemberType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString&lt;a data-lt="url"
href="#dom-thingfilter-url" class="internalDFN" data-link-type=
"dfn" data-for="ThingFilter"&gt;
&lt;span class="idlMember" id="idl-def-thingfilter-description"
data-idl="" data-title="description" data-dfn-for=
"thingfilter"&gt;    &lt;span class=
"idlMemberType"&gt;Dictionary                   &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="description" href=
"#dom-thingfilter-description" class="internalDFN" data-link-type=
"dfn" data-for=
"ThingFilter"&gt;
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span>            <span class="idlMemberName"><a data-no-default=""
data-link-for="thingfilter" data-lt="" href="#dom-thingfilter-url"
class="internalDFN" data-link-type=
"dfn"><code>url</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-thingfilter-query" data-idl=""<ins class="diff-chg">
data-title="query" data-dfn-for="thingfilter">    <span class=
"idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span>            <span class="idlMemberName"><a data-no-default=""
data-link-for="thingfilter" data-lt="" href=
"#dom-thingfilter-query" class="internalDFN" data-link-type=
"dfn"><code>query</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-thingfilter-constraints"<ins class="diff-chg">
data-idl="" data-title="constraints" data-dfn-for=
"thingfilter">    <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;Dictionary&gt;</span> <span class="idlMemberName"><a data-no-default=""
data-link-for="thingfilter" data-lt="" href=
"#dom-thingfilter-constraints" class="internalDFN" data-link-type=
"dfn"><code>constraints</code></a></span>;</span>
</ins>
};
</span>
</pre>
</div>
<p>
The
<dfn data-dfn-for="thingfilter" data-dfn-type="dfn" id= "dom-thingfilter-method" data-idl="" data-title= "method">
<code>
method
</code>
</dfn>
property
represents
the
discovery
type
that
should
be
used
in
the
discovery
process.
The
possible
values
are
defined
by
the
<code>
<a href= "#dom-discoverymethod" class="internalDFN" data-link-type= "dfn">
<code>
DiscoveryMethod
</code>
</a>
</code>
enumeration
that
can
be
extended
by
string
values
defined
by
solutions
(with
no
guarantee
of
interoperability).
</p>
<del class="diff-old">The
url
property
represents
additional
information
for
the
discovery
method,
such
as
the
URL
of
the
Thing
Directory
server
to
be
used.
The
description
property
represents
additional
information
for
the
discovery
method
in
the
form
of
a
set
of
key-value
pairs,
as
defined
in
the
Thing
Description
.
</del>
<div class="ednote">
<div role="heading" class="ednote-title marker" id="h-ednote-1" aria-level="5">
<span>
Editor's
note
</span>
</div>
<p class="">
The
<a href="#dom-discoverymethod" class="internalDFN" data-link-type="dfn">
<code>
DiscoveryMethod
</code>
</a>
enumeration
can
be
extended
by
the
<a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn">
Thing
Description
</a>
with
values
that
are
not
specified
here.
This
extensibility
of
<a href= "#dom-discoverymethod" class="internalDFN" data-link-type= "dfn">
<code>
DiscoveryMethod
</code>
</a>
by
proprietary
or
private
methods
is
a
working
assumption
until
consensus
is
formed
and
may
be
removed
later.
</p>
</div>
<del class="diff-old">Editor's
note
</del>
<p>
The
<dfn data-dfn-for="thingfilter" data-dfn-type="dfn" id= "dom-thingfilter-url" data-idl="" data-title= "url">
<code>
<del class="diff-old">ThingFilter
</del>
<ins class="diff-chg">url
</ins>
</code>
</dfn>
<ins class="diff-new">property
represents
additional
information
for
the
discovery
method,
such
as
the
URL
of
the
target
entity
serving
the
discovery
request,
such
as
a
</ins><a href= "#dfn-thing-directory" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
Thing
Directory
</ins>
</a>
<del class="diff-old">dictionary
may
be
extended
later
with
further
attributes.
</del>
<ins class="diff-chg">or
a
Thing.
</ins>
</p>
<del class="diff-old">3.1.2
</del>
<p>
The
<dfn data-dfn-for="thingfilter" data-dfn-type="dfn" id= "dom-thingfilter-query" data-idl="" data-title= "query">
<code>
<del class="diff-old">DiscoveryMethod
</del>
<ins class="diff-chg">query
</ins>
</code>
</dfn>
<del class="diff-old">enumeration
&lt;span class="idlEnum" id=
"idl-def-discoverymethod" data-idl="" data-title=
"DiscoveryMethod"&gt;enum &lt;a data-lt=
"DiscoveryMethod" href="#dom-discoverymethod" class="internalDFN"
data-link-type="dfn" data-for=
""&gt; {
    &lt;a href="#dom-discoverymethod-any" class=
"idlEnumItem"&gt;"any",
    &lt;a href="#dom-discoverymethod-local" class=
"idlEnumItem"&gt;"local",
    &lt;a href="#dom-discoverymethod-nearby" class=
"idlEnumItem"&gt;"nearby",
    &lt;a href="#dom-discoverymethod-directory" class=
"idlEnumItem"&gt;"directory",
    &lt;a href="#dom-discoverymethod-broadcast" class=
"idlEnumItem"&gt;"broadcast",
    &lt;a href="#dom-discoverymethod-other" class=
"idlEnumItem"&gt;"other"
};
</del>
<ins class="diff-chg">property
represents
a
query
string
accepted
by
the
implementation,
for
instance
a
SPARQL
query.
</ins></p>
<p>
The
<dfn data-dfn-for="thingfilter" data-dfn-type="dfn" id= "dom-thingfilter-constraints" data-idl="" data-title= "constraints">
<code>
<del class="diff-old">DiscoveryMethod
</del>
<ins class="diff-chg">constraints
</ins>
</code>
<del class="diff-old">enumeration
</del>
</dfn>
<ins class="diff-chg">property
</ins>
represents
<ins class="diff-new">additional
information
for
</ins>
the
discovery
<del class="diff-old">type
</del>
<ins class="diff-chg">method
in
the
form
of
a
list
of
sets
of
property-value
pairs
(dictionaries).
The
list
elements
(dictionaries)
are
in
OR
relationship,
and
within
a
constraint
dictionary
the
key-value
pairs
are
in
AND
relationship.
Implementations
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
make
the
following
mapping
from
the
constraint
dictionaries
</ins>
to
<del class="diff-old">be
used:
"
</del>
<a href= "#dom-semanticannotations" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">any
</del>
<ins class="diff-chg">SemanticAnnotations
</ins>
</code>
<del class="diff-old">"
does
not
provide
any
restriction
</del>
</a>:
<ins class="diff-chg">for
each
property-value
pair
in
a
constraint
dictionary,
</ins></p><ul>
<li>
<del class="diff-old">"
</del>
<ins class="diff-chg">Each
property
name
in
the
constraint
dictionary
</ins><em class= "rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
match
the
either
the
</ins>
<code>
<del class="diff-old">local
</del>
<ins class="diff-chg">name
</ins>
</code>
<del class="diff-old">"
for
discovering
Thing
s
</del>
<ins class="diff-chg">property
of
a
</ins>
defined
<del class="diff-old">in
the
same
device
"
</del>
<a href="#dom-semantictype" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">nearby
</del>
<ins class="diff-chg">SemanticType
</ins>
</code>
<del class="diff-old">"
for
discovering
Thing
</del>
</a>
<del class="diff-old">s
nearby
</del>
<ins class="diff-chg">on
</ins>
the
<del class="diff-old">device,
e.g.
by
Bluetooth
</del>
<ins class="diff-chg">target
</ins><a href= "#dfn-things" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
</ins></a><ins class="diff-chg">
object,
</ins>
or
<del class="diff-old">NFC
</del>
<ins class="diff-chg">the
name
of
a
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
on
the
target
</ins><a href="#dfn-things" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Thing
</ins></a>.
</li>
<li>
<del class="diff-old">"
</del>
<ins class="diff-chg">When
the
name
matches,
the
values
are
compared.
If
the
values
match,
the
constraint
is
matched.
</ins></li></ul><div class="ednote"><div role="heading" class="ednote-title marker" id="h-ednote-2" aria-level="5"><span><ins class="diff-chg">
Editor's
note
</ins></span></div><p class=""><ins class="diff-chg">
Constraints
are
experimental
feature,
implementations
are
not
required
to
support
them.
</ins></p></div><div class="ednote"><div role="heading" class="ednote-title marker" id="h-ednote-3" aria-level="5"><span><ins class="diff-chg">
Editor's
note
</ins></span></div><p class=""><ins class="diff-chg">
Semantic
annotations
need
revisiting
in
order
to
simplify
their
representation.
In
the
[
</ins><cite><a class="bibref" href="#bib-WOT-TD"><ins class="diff-chg">
WOT-TD
</ins></a>
</cite>
<ins class="diff-new">]
specification
they
represent
the
</ins>
<code>
<del class="diff-old">directory
</del>
<ins class="diff-chg">@type
</ins></code><ins class="diff-chg">
construct.
At
the
moment
only
</ins><code><ins class="diff-chg">
@context
</ins></code>,<code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
@id
</ins>
</code>
<ins class="diff-new">constructs
are
used
in
the
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
TD
</ins></a>.</p></div></section></section><section id="the-fetch-method"><h3 id="x3-2-the-fetch-method">
<del class="diff-old">"
for
discovery
based
on
a
service
provided
by
a
directory
or
repository
of
Thing
s
"
</del>
<span class="secno">
<ins class="diff-chg">3.2
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="wot" data-dfn-type="dfn" id="dom-wot-fetch" data-idl="" data-title="fetch()" data-lt= "fetch()|fetch">
<code>
<del class="diff-old">broadcast
</del>
<ins class="diff-chg">fetch()
</ins>
</code>
</dfn>
<del class="diff-old">"
for
</del>
<ins class="diff-chg">method
</ins></h3><p><ins class="diff-chg">
Accepts
</ins>
an
<del class="diff-old">open
ended
discovery
based
on
sending
</del>
<code>
<ins class="diff-chg">url
</ins></code><ins class="diff-chg">
argument
and
returns
</ins>
a
<del class="diff-old">request
to
</del>
<code>
<a href="#dfn-promise" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Promise
</ins></a></code><ins class="diff-chg">
that
resolves
with
</ins>
a
<del class="diff-old">broadcast
address
"
</del>
<a href= "#dom-thingdescription" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">other
</del>
<ins class="diff-chg">ThingDescription
</ins></code></a>.</p></section><section data-dfn-for="ThingDescription" id= "the-thingdescription-type"><h3 id="x3-3-the-thingdescription-type"><span class= "secno"><ins class="diff-chg">
3.3
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-thingdescription" data-idl="" data-title= "ThingDescription"><code><ins class="diff-chg">
ThingDescription
</ins>
</code>
</dfn>
<del class="diff-old">"
for
a
proprietary
method
defined
by
</del>
<ins class="diff-chg">type
</ins></h3><p><ins class="diff-chg">
Representation
of
</ins>
the
<del class="diff-old">solution.
</del>
<a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn">
<ins class="diff-chg">Thing
Description
</ins></a>,<ins class="diff-chg">
standardized
in
the
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20180405/"><ins class="diff-chg">
Wot
Things
Description
</ins></a><ins class="diff-chg">
specification.
</ins></p><div class="note"><div role="heading" class="note-title marker" id="h-note-2" aria-level="4"><span><ins class="diff-chg">
Note
</ins></span></div><p class=""><ins class="diff-chg">
In
this
version
of
the
API,
</ins><a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Thing
Description
</ins></a><ins class="diff-chg">
s
are
represented
as
opaque
strings,
denoting
a
serialized
form,
for
instance
JSON
or
JSON-LD.
See
</ins><a href="https://github.com/w3c/wot-scripting-api/issues/38"><ins class="diff-chg">
Issue
38
</ins></a><ins class="diff-chg">
and
</ins><a href= "https://github.com/w3c/wot-scripting-api/issues/45"><ins class="diff-chg">
Issue
45
</ins></a>.</p></div>
</section>
<section id="the-consume-method">
<h3 id="x3-4-the-consume-method">
<span class="secno">
<del class="diff-old">3.2
</del>
<ins class="diff-chg">3.4
</ins>
</span>
The
<dfn data-dfn-for="wot" data-dfn-type="dfn" id="dom-wot-consume" data-idl="" data-title="consume()" data-lt= "consume()|consume">
<code>
consume()
</code>
</dfn>
method
</h3>
<p>
Accepts
an
<code>
<del class="diff-old">url
</del>
<ins class="diff-chg">td
</ins>
</code>
argument
<del class="diff-old">and
returns
a
</del>
<ins class="diff-chg">of
type
</ins>
<code>
<del class="diff-old">Promise
</del>
<a href= "#dom-thingdescription" class="internalDFN" data-link-type= "dfn">
<code>
<ins class="diff-chg">ThingDescription
</ins></code>
</a>
</code>
<del class="diff-old">of
</del>
<ins class="diff-chg">and
returns
</ins>
a
<a href="#dom-consumedthing" class="internalDFN" data-link-type= "dfn">
<code>
ConsumedThing
</code>
<del class="diff-old">.
</del>
</a>
<ins class="diff-chg">object
instantiated
based
on
that
description.
</ins>
</p>
</section>
<section id="the-produce-method">
<h3 id="x3-5-the-produce-method">
<span class="secno">
<del class="diff-old">3.3
</del>
<ins class="diff-chg">3.5
</ins>
</span>
The
<dfn id="dom-wot-produce" data-dfn-for="wot" data-dfn-type="dfn" data-idl="" data-title="produce()" data-lt= "produce()|produce">
<code>
<del class="diff-old">expose()
</del>
<ins class="diff-chg">produce()
</ins>
</code>
</dfn>
method
</h3>
<p>
<del class="diff-old">Returns
</del>
<ins class="diff-chg">Accepts
</ins>
a
<code>
<ins class="diff-new">model
</ins></code><ins class="diff-new">
argument
of
type
</ins><code><a href= "#dom-thingmodel" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
ThingModel
</ins></code>
<del class="diff-old">Promise
</del>
</a>
</code>
<del class="diff-old">of
a
locally
created
</del>
<ins class="diff-chg">and
returns
an
</ins><a href= "#dom-exposedthing" class="internalDFN" data-link-type= "dfn">
<code>
ExposedThing
</code>
</a>
<ins class="diff-new">object,
locally
created
</ins>
based
on
the
provided
initialization
parameters.
<del class="diff-old">Editor's
note
The
reason
</del>
<ins class="diff-chg">An
</ins><a href= "#dom-exposedthing" class="internalDFN" data-link-type= "dfn">
<code>
ExposedThing
</code>
</a>
<del class="diff-old">s
are
</del>
<ins class="diff-chg">can
be
</ins>
created
<del class="diff-old">by
</del>
<ins class="diff-chg">in
the
following
ways:
</ins></p><ol><li><ins class="diff-chg">
from
an
initial
model
(including
</ins>
a
<del class="diff-old">factory
method
instead
</del>
<ins class="diff-chg">user
given
name
and
</ins><a href= "#the-semanticannotations-dictionary"><ins class="diff-chg">
semantic
annotations
</ins></a><ins class="diff-chg">
),
then
adding
properties,
actions,
events
and
request
handlers;
</ins></li><li><ins class="diff-chg">
from
a
</ins><a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
Description
</ins></a><ins class="diff-chg">
(possibly
</ins>
of
a
<del class="diff-old">constructor
</del>
<a href= "#dom-consumedthing" class="internalDFN" data-link-type= "dfn">
<code>
<ins class="diff-chg">ConsumedThing
</ins></code></a><ins class="diff-chg">
object),
then
adding
request
handlers.
</ins></li></ol></section><section data-dfn-for="ThingModel" id="the-thingmodel-type"><h3 id="x3-6-the-thingmodel-type"><span class="secno"><ins class="diff-chg">
3.6
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id="dom-thingmodel" data-idl="" data-title="ThingModel"><code><ins class="diff-chg">
ThingModel
</ins></code></dfn><ins class="diff-chg">
type
</ins></h3><p><ins class="diff-chg">
A
Thing
model
</ins>
is
<del class="diff-old">that
an
</del>
<ins class="diff-chg">used
for
producing
a
new
</ins><a href= "#dom-exposedthing" class="internalDFN" data-link-type= "dfn">
<code>
ExposedThing
</code>
</a>
<del class="diff-old">may
</del>
<ins class="diff-chg">and
can
</ins>
be
<del class="diff-old">created
in
the
local
WoT
Runtime
</del>
<ins class="diff-chg">either
a
</ins><a href= "#dom-thingtemplate" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ThingTemplate
</ins></code></a>,
or
<del class="diff-old">in
</del>
a
<del class="diff-old">remote
runtime.
Even
though
currently
only
local
creation
is
supported,
the
method
is
designed
with
this
possible
future
compatibility
in
mind.
</del>
<a href= "#dom-thingdescription" class="internalDFN" data-link-type= "dfn">
<code>
<ins class="diff-chg">ThingDescription
</ins></code></a>.
</p>
</section>
<section data-dfn-for="SemanticAnnotations" id= "the-semanticannotations-dictionary">
<h3 id="x3-7-the-semanticannotations-dictionary">
<span class= "secno">
<del class="diff-old">3.3.1
</del>
<ins class="diff-chg">3.7
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-semanticannotations" data-idl="" data-title= "SemanticAnnotations">
<code>
<del class="diff-old">ThingInit
</del>
<ins class="diff-chg">SemanticAnnotations
</ins>
</code>
</dfn>
dictionary
</h3>
<p>
<ins class="diff-chg">A
dictionary
that
provides
the
semantic
types
and
semantic
metadata.
</ins></p>
<div>
<pre class="def idl"><span class="idlDictionary" id=
<del class="diff-old">"idl-def-thinginit" data-idl="" data-title=
"ThingInit"&gt;dictionary &lt;a data-lt=
"ThingInit" href="#dom-thinginit" class="internalDFN"
data-link-type="dfn" data-for=
""&gt; {
&lt;span class="idlMember" id="idl-def-thinginit-name" data-idl=""
data-title="name" data-dfn-for="thinginit"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-lt="name"
href="#dom-thinginit-name" class="internalDFN" data-link-type="dfn"
data-for="ThingInit"&gt;
&lt;span class="idlMember" id="idl-def-thinginit-url" data-idl=""
data-title="url" data-dfn-for="thinginit"&gt;    &lt;span class=
</del>
<ins class="diff-chg">"idl-def-semanticannotations" data-idl="" data-title=
"SemanticAnnotations">dictionary <span class=
"idlDictionaryID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-semanticannotations" class="internalDFN" data-link-type=
"dfn"><code>SemanticAnnotations</code></a></span> {
</ins><span class="idlMember" id=<ins class="diff-chg">
"idl-def-semanticannotations-semantictype" data-idl="" data-title=
"semanticType" data-dfn-for="semanticannotations">    <span class=
</ins>
"idlMemberType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString&lt;a data-lt="url"
href="#dom-thinginit-url" class="internalDFN" data-link-type="dfn"
data-for="ThingInit"&gt;
&lt;span class="idlMember" id="idl-def-thinginit-description"
data-idl="" data-title="description" data-dfn-for=
"thinginit"&gt;    &lt;span class=
"idlMemberType"&gt;Dictionary &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="description" href=
"#dom-thinginit-description" class="internalDFN" data-link-type=
"dfn" data-for=
"ThingInit"&gt;
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a href="#dom-semantictype"
class="internalDFN" data-link-type=
"dfn"><code>SemanticType</code></a>&gt;</span>     <span class=
"idlMemberName"><a data-no-default="" data-link-for=
"semanticannotations" data-lt="" href=
"#dom-semanticannotations-semantictype" class="internalDFN"
data-link-type="dfn"><code>semanticType</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-semanticannotations-metadata"<ins class="diff-chg">
data-idl="" data-title="metadata" data-dfn-for=
"semanticannotations">    <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a href="#dom-semanticmetadata"
class="internalDFN" data-link-type=
"dfn"><code>SemanticMetadata</code></a>&gt;</span> <span class=
"idlMemberName"><a data-no-default="" data-link-for=
"semanticannotations" data-lt="" href=
"#dom-semanticannotations-metadata" class="internalDFN"
data-link-type="dfn"><code>metadata</code></a></span>;</span>
</ins>
};
</span>
</pre>
</div>
<p>
The
<dfn data-dfn-for="semanticannotations" data-dfn-type="dfn" id="dom-semanticannotations-semantictype" data-idl="" data-title= "semanticType">
<code>
<del class="diff-old">ThingInit
</del>
<ins class="diff-chg">semanticType
</ins></code></dfn><ins class="diff-chg">
property
denotes
a
list
of
</ins><a href="#dom-semantictype" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
SemanticType
</ins></code></a><ins class="diff-chg">
objects
that
define
the
semantic
types
that
can
be
used
in
semantic
metadata
type-value
pairs.
</ins></p><p><ins class="diff-chg">
The
</ins><dfn data-dfn-for="semanticannotations" data-dfn-type="dfn" id="dom-semanticannotations-metadata" data-idl="" data-title= "metadata"><code><ins class="diff-chg">
metadata
</ins></code></dfn><ins class="diff-chg">
property
denotes
a
list
of
</ins><a href="#dom-semanticmetadata" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
SemanticMetadata
</ins>
</code>
</a>
<ins class="diff-new">objects
(type-value
pairs).
</ins></p></section><section data-dfn-for="SemanticType" id= "the-semantictype-dictionary"><h3 id="x3-8-the-semantictype-dictionary"><span class= "secno"><ins class="diff-new">
3.8
</ins></span><ins class="diff-new">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-semantictype" data-idl="" data-title= "SemanticType"><code><ins class="diff-new">
SemanticType
</ins></code></dfn>
dictionary
<del class="diff-old">contains
properties
to
initialize
</del>
</h3>
<div>
<pre class="def idl"><span class="idlDictionary" id=
<ins class="diff-chg">"idl-def-semantictype" data-idl="" data-title=
"SemanticType">dictionary <span class=
"idlDictionaryID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-semantictype" class="internalDFN" data-link-type=
"dfn"><code>SemanticType</code></a></span> {
</ins><span class="idlMember" id="idl-def-semantictype-name" data-idl=""<ins class="diff-chg">
data-title="name" data-dfn-for=
"semantictype">    required <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlMemberName"><a data-no-default=""
data-link-for="semantictype" data-lt="" href=
"#dom-semantictype-name" class="internalDFN" data-link-type=
"dfn"><code>name</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-semantictype-context" data-idl=<ins class="diff-chg">
"" data-title="context" data-dfn-for=
"semantictype">    required <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlMemberName"><a data-no-default=""
data-link-for="semantictype" data-lt="" href=
"#dom-semantictype-context" class="internalDFN" data-link-type=
"dfn"><code>context</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-semantictype-prefix" data-idl=<ins class="diff-chg">
"" data-title="prefix" data-dfn-for=
"semantictype">             <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlMemberName"><a data-no-default=""
data-link-for="semantictype" data-lt="" href=
"#dom-semantictype-prefix" class="internalDFN" data-link-type=
"dfn"><code>prefix</code></a></span>;</span>
};
</ins></span></pre></div><p><ins class="diff-chg">
Represents
</ins>
a
<del class="diff-old">Thing
:
</del>
<ins class="diff-chg">semantic
type
annotation,
containing
a
name,
a
context
and
a
prefix.
</ins>
</p>
<ul>
<li>
The
<dfn data-dfn-for="semantictype" data-dfn-type="dfn" id= "dom-semantictype-name" data-idl="" data-title= "name">
<code>
name
</code>
</dfn>
attribute
represents
the
<del class="diff-old">user
given
</del>
name
of
the
<del class="diff-old">Thing
.
</del>
<ins class="diff-chg">semantic
type
in
the
given
context.
</ins>
</li>
<li>
The
<dfn data-dfn-for="semantictype" data-dfn-type="dfn" id= "dom-semantictype-context" data-idl="" data-title= "context">
<code>
<del class="diff-old">url
</del>
<ins class="diff-chg">context
</ins>
</code>
</dfn>
attribute
represents
<ins class="diff-new">an
URL
link
to
</ins>
the
<del class="diff-old">address
</del>
<ins class="diff-chg">context
</ins>
of
the
<del class="diff-old">Thing
.
</del>
<ins class="diff-chg">semantic
classification.
</ins>
</li>
<li>
The
<dfn data-dfn-for="semantictype" data-dfn-type="dfn" id= "dom-semantictype-prefix" data-idl="" data-title= "prefix">
<code>
<del class="diff-old">description
</del>
<ins class="diff-chg">prefix
</ins></code></dfn><ins class="diff-chg">
attribute
represents
a
short
prefix
associated
with
a
context.
</ins></li></ul><div class="ednote"><div role="heading" class="ednote-title marker" id="h-ednote-4" aria-level="4"><span><ins class="diff-chg">
Editor's
note
</ins></span></div><p class=""><ins class="diff-chg">
Semantic
type
examples
to
be
added.
</ins></p></div></section><section data-dfn-for="SemanticMetadata" id= "the-semanticmetadata-dictionary"><h3 id="x3-9-the-semanticmetadata-dictionary"><span class= "secno"><ins class="diff-chg">
3.9
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-semanticmetadata" data-idl="" data-title= "SemanticMetadata"><code><ins class="diff-chg">
SemanticMetadata
</ins></code></dfn><ins class="diff-chg">
dictionary
</ins></h3><div><pre class="def idl"><span class="idlDictionary" id=<ins class="diff-chg">
"idl-def-semanticmetadata" data-idl="" data-title=
"SemanticMetadata">dictionary <span class=
"idlDictionaryID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-semanticmetadata" class="internalDFN" data-link-type=
"dfn"><code>SemanticMetadata</code></a></span> {
</ins><span class="idlMember" id="idl-def-semanticmetadata-type"<ins class="diff-chg">
data-idl="" data-title="type" data-dfn-for=
"semanticmetadata">    <span class="idlMemberType"><a href=
"#dom-semantictype" class="internalDFN" data-link-type=
"dfn"><code>SemanticType</code></a></span> <span class=
"idlMemberName"><a data-no-default="" data-link-for=
"semanticmetadata" data-lt="" href="#dom-semanticmetadata-type"
class="internalDFN" data-link-type=
"dfn"><code>type</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-semanticmetadata-value"<ins class="diff-chg">
data-idl="" data-title="value" data-dfn-for=
"semanticmetadata">    <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span>          <span class="idlMemberName"><a data-no-default=""
data-link-for="semanticmetadata" data-lt="" href=
"#dom-semanticmetadata-value" class="internalDFN" data-link-type=
"dfn"><code>value</code></a></span>;</span>
};
</ins></span></pre></div><p><ins class="diff-chg">
The
</ins><a href="#dom-semanticmetadata" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
SemanticMetadata
</ins></code></a><ins class="diff-chg">
dictionary
describes
a
pair
of
semantic
type
and
value:
</ins></p><ul><li><ins class="diff-chg">
The
</ins><dfn data-dfn-for="semanticmetadata" data-dfn-type="dfn" id="dom-semanticmetadata-type" data-idl="" data-title= "type"><code><ins class="diff-chg">
type
</ins>
</code>
</dfn>
attribute
represents
the
<ins class="diff-chg">semantic
type
name
defined
by
a
</ins><a href="#dom-semantictype" class= "internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
SemanticType
</ins></code></a><ins class="diff-chg">
object.
</ins></li><li><ins class="diff-chg">
The
</ins><dfn data-dfn-for="semanticmetadata" data-dfn-type="dfn" id="dom-semanticmetadata-value" data-idl="" data-title= "value"><code><ins class="diff-chg">
value
</ins></code></dfn><ins class="diff-chg">
attribute
represents
the
metadata
value.
</ins></li></ul></section><section data-dfn-for="ThingTemplate" id= "the-thingtemplate-dictionary"><h3 id="x3-10-the-thingtemplate-dictionary"><span class= "secno"><ins class="diff-chg">
3.10
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id="dom-thingtemplate" data-idl="" data-title= "ThingTemplate"><code><ins class="diff-chg">
ThingTemplate
</ins></code></dfn><ins class="diff-chg">
dictionary
</ins></h3><p><ins class="diff-chg">
A
Thing
Template
is
a
dictionary
that
provides
a
user
given
name,
and
the
semantic
types
and
semantic
metadata
attached
to
the
</ins><a href="#dom-exposedthing" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ExposedThing
</ins></code></a><a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
</a>
<ins class="diff-new">'s
root
level.
</ins></p><div><pre class="def idl"><span class="idlDictionary" id=<ins class="diff-new">
"idl-def-thingtemplate" data-idl="" data-title=
"ThingTemplate">dictionary <span class=
"idlDictionaryID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingtemplate" class="internalDFN" data-link-type=
"dfn"><code>ThingTemplate</code></a></span> : <span class=
"idlSuperclass"><a href="#dom-semanticannotations" class=
"internalDFN" data-link-type=
"dfn"><code>SemanticAnnotations</code></a></span> {
</ins><span class="idlMember" id="idl-def-thingtemplate-name" data-idl=""<ins class="diff-new">
data-title="name" data-dfn-for=
"thingtemplate">    required <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlMemberName"><a data-no-default=""
data-link-for="thingtemplate" data-lt="" href=
"#dom-thingtemplate-name" class="internalDFN" data-link-type=
"dfn"><code>name</code></a></span>;</span>
};
</ins></span></pre></div><p><ins class="diff-new">
The
</ins><a href="#dom-thingtemplate" class="internalDFN" data-link-type="dfn"><code><ins class="diff-new">
ThingTemplate
</ins></code></a><ins class="diff-new">
dictionary
extends
</ins><a href="#dom-semanticannotations" class="internalDFN" data-link-type="dfn"><code><ins class="diff-new">
SemanticAnnotations
</ins></code></a><ins class="diff-new">
and
contains
properties
to
initialize
a
</ins><a href="#dfn-things" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
Thing
</ins></a>:</p><ul><li><ins class="diff-new">
The
</ins><dfn data-dfn-for="thingtemplate" data-dfn-type="dfn" id= "dom-thingtemplate-name" data-idl="" data-title= "name"><code><ins class="diff-new">
name
</ins></code></dfn><ins class="diff-new">
attribute
represents
the
user
given
name
</ins>
of
the
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>.
</li>
</ul>
<div class="ednote">
<div role="heading" class="ednote-title marker" id="h-ednote-5" aria-level="4">
<span>
<ins class="diff-chg">Editor's
note
</ins></span></div><p class=""><ins class="diff-chg">
Support
for
configuration
and
security
data
might
be
added
later.
</ins></p></div>
</section>
<section id="examples">
<h3 id="x3-11-examples">
<span class="secno">
<del class="diff-old">3.4
</del>
<ins class="diff-chg">3.11
</ins>
</span>
Examples
</h3>
<div class="example">
<div class="example-title marker">
<span>
Example
1
</span>
<span style="text-transform: none">:
Discover
Things
via
directory
</span>
</div>
<del class="diff-old">&lt;span class=
"hljs-keyword"&gt;let };
</del>
<pre class="hljs javascript" aria-busy="false"><span class=
<ins class="diff-chg">"hljs-keyword">let</span> discoveryFilter = {
</ins>  <span class="hljs-attr">method</span>: <span class=<ins class="diff-chg">
"hljs-string">"directory"</span>,
</ins>  <span class="hljs-attr">url</span>: <span class=<ins class="diff-chg">
"hljs-string">"http://directory.wotservice.org"</span>
};
</ins>
<span class=
<del class="diff-old">"hljs-keyword"&gt;let subscription = wot.discover(discoveryType).subscribe(
</del>
<ins class="diff-chg">"hljs-keyword">let</span> subscription = wot.discover(discoveryFilter).subscribe(
</ins>
  <span class="hljs-function"><span class=
"hljs-params">thing</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
<del class="diff-old">"hljs-string"&gt;"Found Thing " + thing.url); },
</del>
<ins class="diff-chg">"hljs-string">"Found Thing "</span> + thing.name); },
</ins>
  error =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished because an error: "</span> + error.message); },
  () =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
);
<del class="diff-old">setTimeout(
  &lt;span class=
"hljs-params"&gt;()); },
</del>
<ins class="diff-chg">setTimeout( <span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> {
    subscription.unsubscribe();
</ins>    <span class="hljs-built_in">console</span>.log(<span class=<ins class="diff-chg">
"hljs-string">"Discovery timeout"</span>);
  },
</ins>
<span class="hljs-number">
5000
</span>
);
</pre>
</div>
<div class="note">
<div role="heading" class="note-title marker" id="h-note-3" aria-level="4">
<span>
Note
</span>
</div>
<p class="">
Note
that
canceling
a
discovery
(through
<del class="diff-old">unsubscribe)
</del>
<code>
<ins class="diff-chg">unsubscribe()
</ins></code><ins class="diff-chg">
)
</ins>
may
not
be
successful
in
all
cases,
for
instance
when
discovery
is
based
on
open
ended
broadcast
requests.
However,
once
<code>
unsubscribe()
</code>
has
been
called,
implementations
<em class="rfc2119" title="MUST">
MUST
</em>
suppress
further
event
handling
(
i.e.
further
discoveries
and
errors)
on
the
Observable.
Also,
a
discovery
error
may
not
mean
the
end
of
the
discovery
process.
However,
in
order
to
respect
Observable
semantics
(error
always
terminates
processing),
implementations
<em class="rfc2119" title="MUST">
MUST
</em>
close
or
suppress
further
event
handling
on
the
Observable.
</p>
</div>
<div class="example">
<div class="example-title marker">
<span>
Example
2
</span>
<span style="text-transform: none">:
Discover
Things
exposed
by
local
hardware
</span>
</div>
<del class="diff-old">&lt;span class=
</del>
<pre class="hljs javascript" aria-busy="false"><span class=
"hljs-keyword">let</span> subscription = wot.discover({ <span class="hljs-attr">method</span>: <span class="hljs-string">"local"</span> }).subscribe(
  <span class="hljs-function"><span class=
"hljs-params">thing</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
<del class="diff-old">"hljs-string"&gt;"Found local Thing " + thing.url); },
</del>
<ins class="diff-chg">"hljs-string">"Found local Thing "</span> + thing.name); },
</ins>
  error =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery error: "</span> + error.message); },
  () =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
);
</pre>
</div>
<div class="example">
<div class="example-title marker">
<span>
Example
3
</span>
<span style="text-transform: none">:
<ins class="diff-new">Same
as
above
but
with
different
Observable
syntax
</ins></span></div><pre class="hljs javascript" aria-busy="false"><span class=<ins class="diff-new">
"hljs-keyword">let</span> subscription = wot.discover({ <span class="hljs-attr">method</span>: <span class="hljs-string">"local"</span> }).subscribe({
  thing =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Found local Thing "</span> + thing.name); },
</ins>  <span class="hljs-attr">error</span>: <span class=<ins class="diff-new">
"hljs-function"><span class=
"hljs-params">err</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery error: "</span> + err.message); },
</ins>  <span class="hljs-attr">complete</span>: <span class=<ins class="diff-new">
"hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
});
</ins></pre></div><div class="example"><div class="example-title marker"><span><ins class="diff-new">
Example
4
</ins></span><span style="text-transform: none">:
Discover
Things
exposed
nearby,
<del class="diff-old">e.g.
</del>
via
Bluetooth
<ins class="diff-new">or
NFC
</ins>
</span>
</div>
<del class="diff-old">&lt;span class=
"hljs-keyword"&gt;let} }).subscribe(
</del>
<pre class="hljs javascript" aria-busy="false"><span class=
<ins class="diff-chg">"hljs-keyword">let</span> subscription = wot.discover({
</ins>  <span class="hljs-attr">method</span>: <span class=<ins class="diff-chg">
"hljs-string">"nearby"</span>,
</ins>  <span class="hljs-attr">constraints</span>: [{ <span class=<ins class="diff-chg">
"hljs-attr">protocol</span>: <span class=
"hljs-string">"BLE-4.2"</span> }, { <span class=
"hljs-attr">protocol</span>: <span class=
"hljs-string">"NFC"</span>}]
}).subscribe(
</ins>
  <span class="hljs-function"><span class=
"hljs-params">thing</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
<del class="diff-old">"hljs-string"&gt;"Found nearby Thing " + thing.url); },
</del>
<ins class="diff-chg">"hljs-string">"Found nearby Thing "</span> + thing.name); },
</ins>
  error =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery error: "</span> + error.message); },
  () =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
);
</pre>
</div>
<div class="example">
<div class="example-title marker">
<span>
Example
<del class="diff-old">4
</del>
<ins class="diff-chg">5
</ins>
</span>
<span style="text-transform: none">:
Discover
Things
exposed
in
a
proprietary
way
</span>
</div>
<del class="diff-old">&lt;span class=
"hljs-keyword"&gt;let} }).subscribe(
</del>
<pre class="hljs javascript" aria-busy="false"><span class=
<ins class="diff-chg">"hljs-keyword">let</span> subscription = wot.discover({
</ins>  <span class="hljs-attr">method</span>: <span class=<ins class="diff-chg">
"hljs-string">"other"</span>,
</ins>  <span class="hljs-attr">constraints</span>: [{ <span class=<ins class="diff-chg">
"hljs-attr">solution</span>: <span class=
"hljs-string">"XYZ123"</span>, <span class=
"hljs-attr">key</span>: <span class="hljs-string">"..."</span>}]
}).subscribe(
</ins>
  <span class="hljs-function"><span class=
"hljs-params">thing</span> =&gt;</span> { <span class=
"hljs-built_in">console</span>.log(<span class=
<del class="diff-old">"hljs-string"&gt;"Found Thing " + thing.url); },
</del>
<ins class="diff-chg">"hljs-string">"Found Thing "</span> + thing.name); },
</ins>
  error =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery error: "</span> + error.message); },
  () =&gt; { <span class=
"hljs-built_in">console</span>.log(<span class=
"hljs-string">"Discovery finished successfully"</span>);}
);
</pre>
</div>
</section>
</section>
<section data-dfn-for="ConsumedThing" id= "the-consumedthing-interface">
<h2 id="x4-the-consumedthing-interface">
<span class= "secno">
4.
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-consumedthing" data-idl="" data-title= "ConsumedThing">
<code>
ConsumedThing
</code>
</dfn>
interface
</h2>
<p>
The
<a href="#dom-consumedthing" class="internalDFN" data-link-type="dfn">
<code>
ConsumedThing
</code>
</a>
interface
is
a
client
API
for
sending
requests
to
servers
in
order
to
retrieve
or
update
<del class="diff-old">properties,
</del>
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Properties
</ins></a>,
invoke
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Actions
</a>,
and
observe
<del class="diff-old">properties,
Actions
</del>
<a href="#dfn-properties" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Properties
</ins>
</a>
and
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
Events
</a>.
</p>
<div>
<pre class="def idl"><span class="idlInterface" id=
"idl-def-consumedthing" data-idl="" data-title=
<del class="diff-old">"ConsumedThing"&gt;interface &lt;a data-lt=
"ConsumedThing" href="#dom-consumedthing" class="internalDFN"
data-link-type="dfn" data-for=
""&gt; {
</del>
<ins class="diff-chg">"ConsumedThing">interface <span class=
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-consumedthing" class="internalDFN" data-link-type=
"dfn"><code>ConsumedThing</code></a></span> {
</ins>
<span class="idlAttribute" id="idl-def-consumedthing-name"
data-idl="" data-title="name" data-dfn-for=
"consumedthing">    readonly attribute <span class=
"idlAttrType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-lt="name"
href="#dom-consumedthing-name" class="internalDFN" data-link-type=
"dfn" data-for="ConsumedThing"&gt;
&lt;span class="idlAttribute" id="idl-def-consumedthing-url" data-idl=
"" data-title="url" data-dfn-for=
"consumedthing"&gt;    readonly attribute &lt;span class=
"idlAttrType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString&lt;a data-lt="url"
href="#dom-consumedthing-url" class="internalDFN" data-link-type=
"dfn" data-for="ConsumedThing"&gt;
&lt;span class="idlAttribute" id="idl-def-consumedthing-description"
data-idl="" data-title="description" data-dfn-for=
"consumedthing"&gt;    readonly attribute &lt;span class=
"idlAttrType"&gt;&lt;a href="#dom-thingdescription" class="internalDFN"
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlAttrName"><a data-no-default=""
data-link-for="consumedthing" data-lt="" href=
"#dom-consumedthing-name" class="internalDFN" data-link-type=
"dfn"><code>name</code></a></span>;</span>
</ins><span class="idlMethod" id=<ins class="diff-chg">
"idl-def-consumedthing-getthingdescription" data-idl="" data-title=
"getThingDescription" data-dfn-for="consumedthing">    <span class=
"idlMethType"><a href="#dom-thingdescription" class="internalDFN"
</ins>
data-link-type=
"dfn"><code>ThingDescription</code></a></span> <span class=
<del class="diff-old">"idlAttrName"&gt;&lt;a data-lt="description" href=
"#dom-consumedthing-description" class="internalDFN"
data-link-type="dfn" data-for=
"ConsumedThing"&gt;
&lt;span class="idlMethod" id=
"idl-def-consumedthing-invokeaction(name,parameters)" data-idl=""
data-title="invokeAction" data-dfn-for=
"consumedthing"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-lt="invokeAction()|invokeaction()|invokeAction"
data-lt-nodefault="" href="#dom-consumedthing-invokeaction()"
class="internalDFN" data-link-type="dfn" data-for=
"ConsumedThing"&gt;invokeAction(&lt;span class=
"idlParam"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
&lt;span class="idlMethod" id=
"idl-def-consumedthing-setproperty(name,value)" data-idl=""
data-title="setProperty" data-dfn-for=
"consumedthing"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-lt="setProperty()|setproperty()|setProperty"
data-lt-nodefault="" href="#dom-consumedthing-setproperty()" class=
"internalDFN" data-link-type="dfn" data-for=
"ConsumedThing"&gt;setProperty(&lt;span class=
"idlParam"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
</del>
<ins class="diff-chg">"idlMethName"><a data-no-default="" data-link-for="consumedthing"
data-lt="getthingdescription()|getThingDescription" href=
"#dom-consumedthing-getthingdescription" class="internalDFN"
data-link-type="dfn">getThingDescription</a></span>();</span>
</ins>
<span class="idlMethod" id=
<del class="diff-old">"idl-def-consumedthing-getproperty(name)" data-idl="" data-title=
"getProperty" data-dfn-for="consumedthing"&gt;    &lt;span class=
</del>
<ins class="diff-chg">"idl-def-consumedthing-readproperty-name" data-idl="" data-title=
"readProperty" data-dfn-for="consumedthing">    <span class=
</ins>
"idlMethType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-lt="getProperty()|getproperty()|getProperty"
data-lt-nodefault="" href="#dom-consumedthing-getproperty()" class=
"internalDFN" data-link-type="dfn" data-for=
"ConsumedThing"&gt;getProperty(&lt;span class=
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span>     <span class="idlMethName"><a data-no-default=""
data-link-for="consumedthing" data-lt="readproperty()|readProperty"
href="#dom-consumedthing-readproperty" class="internalDFN"
data-link-type="dfn">readProperty</a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span>
<span class="idlMethod" id=
<del class="diff-old">"idl-def-consumedthing-addlistener(eventname,listener)" data-idl=""
data-title="addListener" data-dfn-for=
</del>
<ins class="diff-chg">"idl-def-consumedthing-writeproperty-name-value" data-idl=""
data-title="writeProperty" data-dfn-for=
</ins>
"consumedthing">    <span class="idlMethType"><a href=
<del class="diff-old">"#dom-consumedthing" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlMethName"&gt;&lt;a data-lt="addListener()|addlistener()|addListener"
data-lt-nodefault="" href="#dom-consumedthing-addlistener()" class=
"internalDFN" data-link-type="dfn" data-for=
"ConsumedThing"&gt;addListener(&lt;span class=
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span>    <span class="idlMethName"><a data-no-default=""
data-link-for="consumedthing" data-lt=
"writeproperty()|writeProperty" href=
"#dom-consumedthing-writeproperty" class="internalDFN"
data-link-type="dfn">writeProperty</a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a href="#dom-thingeventlistener"
class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;listener
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>, <span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">value</span></span>);</span>
</ins>
<span class="idlMethod" id=
<del class="diff-old">"idl-def-consumedthing-removelistener(eventname,listener)"
data-idl="" data-title="removeListener" data-dfn-for=
</del>
<ins class="diff-chg">"idl-def-consumedthing-invokeaction-name-parameters" data-idl=""
data-title="invokeAction" data-dfn-for=
</ins>
"consumedthing">    <span class="idlMethType"><a href=
<del class="diff-old">"#dom-consumedthing" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlMethName"&gt;&lt;a data-lt=
"removeListener()|removelistener()|removeListener"
data-lt-nodefault="" href="#dom-consumedthing-removelistener()"
class="internalDFN" data-link-type="dfn" data-for=
"ConsumedThing"&gt;removeListener(&lt;span class=
"idlParam"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString,
                                 &lt;span class=
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span>     <span class="idlMethName"><a data-no-default=""
data-link-for="consumedthing" data-lt="invokeaction()|invokeAction"
href="#dom-consumedthing-invokeaction" class="internalDFN"
data-link-type="dfn">invokeAction</a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
<del class="diff-old">"#dom-thingeventlistener" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;listener
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>, <span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">parameters</span></span>);</span>
</ins>
<span class="idlMethod" id=
<del class="diff-old">"idl-def-consumedthing-removealllisteners(eventname)" data-idl=""
data-title="removeAllListeners" data-dfn-for=
</del>
<ins class="diff-chg">"idl-def-consumedthing-onpropertychange-name" data-idl=""
data-title="onPropertyChange" data-dfn-for=
</ins>
"consumedthing">    <span class="idlMethType"><a href=
<del class="diff-old">"#dom-consumedthing" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlMethName"&gt;&lt;a data-lt=
"removeAllListeners()|removealllisteners()|removeAllListeners"
data-lt-nodefault="" href="#dom-consumedthing-removealllisteners()"
class="internalDFN" data-link-type="dfn" data-for=
"ConsumedThing"&gt;removeAllListeners(&lt;span class=
"idlParam"&gt;optional &lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
&lt;span class="idlMethod" id=
"idl-def-consumedthing-observe(name,requesttype)" data-idl=""
data-title="observe" data-dfn-for="consumedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href="#dfn-observable" class="internalDFN"
data-link-type="dfn"&gt;Observable    &lt;span class=
"idlMethName"&gt;&lt;a data-lt="observe()|observe()|observe"
data-lt-nodefault="" href="#dom-consumedthing-observe()" class=
"internalDFN" data-link-type="dfn" data-for=
"ConsumedThing"&gt;observe(&lt;span class=
</del>
<ins class="diff-chg">"#dom-observable" class="internalDFN" data-link-type=
"dfn"><code>Observable</code></a></span>       <span class=
"idlMethName"><a data-no-default="" data-link-for="consumedthing"
data-lt="onpropertychange()|onPropertyChange" href=
"#dom-consumedthing-onpropertychange" class="internalDFN"
data-link-type="dfn">onPropertyChange</a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a href="#dom-requesttype"
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span>
</ins><span class="idlMethod" id="idl-def-consumedthing-onevent-name"<ins class="diff-chg">
data-idl="" data-title="onEvent" data-dfn-for=
"consumedthing">    <span class="idlMethType"><a href=
"#dom-observable" class="internalDFN" data-link-type=
"dfn"><code>Observable</code></a></span>       <span class=
"idlMethName"><a data-no-default="" data-link-for="consumedthing"
data-lt="onevent()|onEvent" href="#dom-consumedthing-onevent"
</ins>
class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt; &lt;span class=
"idlParamName"&gt;requestType
};
&lt;span class="idlCallback" id="idl-def-thingeventlistener" data-idl=
"" data-title="ThingEventListener"&gt;callback &lt;span class=
"idlCallbackID"&gt;&lt;a data-lt="ThingEventListener" href=
"#dom-thingeventlistener" class="internalDFN" data-link-type="dfn"
data-for=
""&gt; = &lt;span class=
"idlCallbackType"&gt;void&lt;span class=
"idlParamType"&gt;&lt;a href="#dfn-event" class="internalDFN"
data-link-type="dfn"&gt;Event &lt;span class=
"idlParamName"&gt;
event
);
</del>
<ins class="diff-chg">"dfn">onEvent</a></span>(<span class="idlParam"><span class=
"idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span>
</ins><span class="idlMethod" id="idl-def-consumedthing-ontdchange"<ins class="diff-chg">
data-idl="" data-title="onTDChange" data-dfn-for=
"consumedthing">    <span class="idlMethType"><a href=
"#dom-observable" class="internalDFN" data-link-type=
"dfn"><code>Observable</code></a></span>       <span class=
"idlMethName"><a data-no-default="" data-link-for="consumedthing"
data-lt="ontdchange()|onTDChange" href=
"#dom-consumedthing-ontdchange" class="internalDFN" data-link-type=
"dfn">onTDChange</a></span>();</span>
};
</ins>
</span>
</pre>
</div>
<p>
<del class="diff-old">Represents
</del>
<code>
<ins class="diff-chg">ConsumedThing
</ins></code><ins class="diff-chg">
represents
</ins>
a
local
proxy
object
of
the
remote
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>.
</p>
<section id="the-name-property">
<h3 id="x4-1-the-name-property">
<span class="secno">
<ins class="diff-chg">4.1
</ins></span>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id= "dom-consumedthing-name" data-idl="" data-title= "name">
<code>
name
</code>
</dfn>
<del class="diff-old">read-only
attribute
represents
the
name
of
the
Thing
.
</del>
<ins class="diff-chg">property
</ins></h3><p>
The
<code>
<del class="diff-old">url
</del>
<ins class="diff-chg">name
</ins>
</code>
<del class="diff-old">read-only
attribute
</del>
<ins class="diff-chg">property
</ins>
represents
the
<del class="diff-old">URL
</del>
<ins class="diff-chg">name
</ins>
of
the
<a href="#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>
<ins class="diff-new">as
specified
in
the
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
TD
</ins>
</a>.
<ins class="diff-chg">In
this
version
it
is
read
only.
</ins></p></section><section id="the-getthingdescription-method"><h3 id="x4-2-the-getthingdescription-method"><span class= "secno"><ins class="diff-chg">
4.2
</ins></span>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id="dom-consumedthing-getthingdescription" data-idl="" data-title="getThingDescription()" data-lt= "getthingdescription()|getThingDescription">
<code>
<del class="diff-old">description
</del>
<ins class="diff-chg">getThingDescription()
</ins>
</code>
</dfn>
<del class="diff-old">attribute
read-only
attribute
represents
</del>
<ins class="diff-chg">method
</ins></h3><p><ins class="diff-chg">
Returns
</ins>
the
<del class="diff-old">description
</del>
<a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn">
<ins class="diff-chg">Thing
Description
</ins></a>
of
the
<a href="#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>.
</p>
<div class="ednote">
<div role="heading" class="ednote-title marker" id="h-ednote-6" aria-level="4">
<span>
Editor's
note
</span>
</div>
<p class="">
<ins class="diff-new">In
this
version,
introspection
based
on
</ins><a href= "#dfn-td" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
TD
</ins></a><ins class="diff-new">
is
out
of
scope.
</ins>
Parsing
and
exposing
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
</a>
s
is
discussed
in
<a href= "https://github.com/w3c/wot-scripting-api/issues/38">
Issue
38
</a>.
</p>
</div>
</section>
<section id="the-readproperty-method">
<h3 id="x4-3-the-readproperty-method">
<span class= "secno">
<del class="diff-old">4.1
</del>
<ins class="diff-chg">4.3
</ins>
</span>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id="dom-consumedthing-readproperty" data-idl="" data-title="readProperty()" data-lt= "readproperty()|readProperty">
<code>
<del class="diff-old">invokeAction()
</del>
<ins class="diff-chg">readProperty()
</ins>
</code>
</dfn>
method
</h3>
<p>
Takes
the
<del class="diff-old">Action
</del>
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Property
</ins>
</a>
name
<del class="diff-old">from
</del>
<ins class="diff-chg">as
</ins>
the
<var>
name
</var>
<del class="diff-old">argument
and
the
list
of
parameters,
</del>
<ins class="diff-chg">argument,
</ins>
then
requests
from
the
underlying
platform
and
the
<a href="#dfn-protocol-bindings" class="internalDFN" data-link-type="dfn">
Protocol
Bindings
</a>
to
<del class="diff-old">invoke
</del>
<ins class="diff-chg">retrieve
</ins>
the
<del class="diff-old">Action
</del>
<a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Property
</ins>
</a>
on
the
remote
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>
and
return
the
result.
Returns
a
<code>
<a href="#dfn-promise" class="internalDFN" data-link-type="dfn">
Promise
</a>
</code>
that
resolves
with
the
<del class="diff-old">return
</del>
<a href="#dfn-properties" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Property
</ins></a>
value
or
rejects
with
an
<a href="#dfn-error" class="internalDFN" data-link-type="dfn">
Error
</a>.
</p>
</section>
<section id="the-writeproperty-method">
<h3 id="x4-4-the-writeproperty-method">
<span class= "secno">
<del class="diff-old">4.2
</del>
<ins class="diff-chg">4.4
</ins>
</span>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id="dom-consumedthing-writeproperty" data-idl= "" data-title="writeProperty()" data-lt= "writeproperty()|writeProperty">
<code>
<del class="diff-old">setProperty()
</del>
<ins class="diff-chg">writeProperty()
</ins>
</code>
</dfn>
method
</h3>
<p>
Takes
the
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
name
as
the
<var>
name
</var>
argument
and
the
new
value
as
the
<var>
value
</var>
argument,
then
requests
from
the
underlying
platform
and
the
<a href= "#dfn-protocol-bindings" class="internalDFN" data-link-type= "dfn">
Protocol
Bindings
</a>
to
update
the
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
on
the
remote
<a href="#dfn-things" class="internalDFN" data-link-type= "dfn">
Thing
</a>
and
return
the
result.
Returns
a
<code>
<a href= "#dfn-promise" class="internalDFN" data-link-type= "dfn">
Promise
</a>
</code>
that
resolves
on
success
or
rejects
with
an
<a href="#dfn-error" class="internalDFN" data-link-type= "dfn">
Error
</a>.
</p>
</section>
<section id="the-invokeaction-method">
<h3 id="x4-5-the-invokeaction-method">
<span class= "secno">
<del class="diff-old">4.3
</del>
<ins class="diff-chg">4.5
</ins>
</span>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id="dom-consumedthing-invokeaction" data-idl="" data-title="invokeAction()" data-lt= "invokeaction()|invokeAction">
<code>
<del class="diff-old">getProperty()
</del>
<ins class="diff-chg">invokeAction()
</ins>
</code>
</dfn>
method
</h3>
<p>
Takes
the
<del class="diff-old">Property
</del>
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Action
</ins>
</a>
name
<del class="diff-old">as
</del>
<ins class="diff-chg">from
</ins>
the
<var>
name
</var>
<del class="diff-old">argument,
</del>
<ins class="diff-chg">argument
and
the
list
of
parameters,
</ins>
then
requests
from
the
underlying
platform
and
the
<a href="#dfn-protocol-bindings" class= "internalDFN" data-link-type="dfn">
Protocol
Bindings
</a>
to
<del class="diff-old">retrieve
</del>
<ins class="diff-chg">invoke
</ins>
the
<del class="diff-old">Property
</del>
<a href="#dfn-actions" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Action
</ins>
</a>
on
the
remote
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>
and
return
the
result.
Returns
a
<code>
<a href="#dfn-promise" class="internalDFN" data-link-type="dfn">
Promise
</a>
</code>
that
resolves
with
the
<del class="diff-old">Property
</del>
<ins class="diff-chg">return
</ins>
value
or
rejects
with
an
<a href="#dfn-error" class= "internalDFN" data-link-type="dfn">
Error
</a>.
</p>
</section>
<section id="the-onpropertychange-method">
<h3 id="x4-6-the-onpropertychange-method">
<span class= "secno">
<del class="diff-old">4.4
</del>
<ins class="diff-chg">4.6
</ins>
</span>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id="dom-consumedthing-onpropertychange" data-idl="" data-title="onPropertyChange()" data-lt= "onpropertychange()|onPropertyChange">
<code>
<del class="diff-old">addListener()
</del>
<ins class="diff-chg">onPropertyChange()
</ins>
</code>
</dfn>
method
</h3>
<p>
<del class="diff-old">Adds
the
listener
provided
in
the
argument
listener
to
the
Event
name
provided
in
the
argument
eventName
.
4.5
The
</del>
<ins class="diff-chg">Returns
an
</ins><a href="#dom-observable" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">removeListener()
</del>
<ins class="diff-chg">Observable
</ins>
</code>
<del class="diff-old">method
Removes
a
listener
from
</del>
</a>
<ins class="diff-chg">for
</ins>
the
<del class="diff-old">Event
</del>
<a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Property
</ins>
</a>
<del class="diff-old">identified
by
</del>
<ins class="diff-chg">specified
in
</ins>
the
<del class="diff-old">provided
</del>
<var>
<del class="diff-old">eventName
</del>
<ins class="diff-chg">name
</ins>
</var>
<ins class="diff-new">argument,
allowing
subscribing
to
</ins>
and
<del class="diff-old">listener
argument.
</del>
<ins class="diff-chg">unsubscribing
from
notifications.
</ins>
</p>
<del class="diff-old">4.6
</del>
<p>
The
<ins class="diff-chg">callback
function
passed
to
the
</ins>
<code>
<del class="diff-old">removeAllListeners()
</del>
<ins class="diff-chg">subscribe()
</ins>
</code>
method
<del class="diff-old">Removes
all
listeners
for
</del>
<ins class="diff-chg">when
invoked
on
</ins>
the
<del class="diff-old">Event
provided
by
</del>
<ins class="diff-chg">returned
observer
will
receive
</ins>
the
<del class="diff-old">eventName
optional
argument,
or
if
that
was
not
provided,
then
removes
all
listeners
from
all
Events
.
</del>
<ins class="diff-chg">new
property
value
each
time
it
is
changed.
</ins>
</p>
</section>
<section id="the-onevent-method">
<h3 id="x4-7-the-onevent-method">
<span class="secno">
4.7
</span>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id= "dom-consumedthing-onevent" data-idl="" data-title="onEvent()" data-lt="onevent()|onEvent">
<code>
<del class="diff-old">observe()
</del>
<ins class="diff-chg">onEvent()
</ins>
</code>
</dfn>
method
</h3>
<p>
Returns
an
<a href="#dom-observable" class="internalDFN" data-link-type="dfn">
<code>
Observable
</code>
</a>
for
the
<del class="diff-old">Property
,
</del>
<a href= "#dfn-events" class="internalDFN" data-link-type="dfn">
Event
</a>
<del class="diff-old">or
Action
</del>
specified
in
the
<var>
name
</var>
argument,
allowing
subscribing
<ins class="diff-new">to
</ins>
and
unsubscribing
<del class="diff-old">to
</del>
<ins class="diff-chg">from
</ins>
notifications.
<del class="diff-old">The
requestType
specifies
whether
a
Property
,
an
Event
or
an
Action
is
observed.
Editor's
note
The
observe()
method
could
replace
addListener()
and
removeListener()
,
though
they
could
be
kept
for
convenience.
</del>
</p>
<del class="diff-old">4.8
</del>
<p>
The
<del class="diff-old">ThingEventListener
</del>
callback
<del class="diff-old">A
</del>
function
<del class="diff-old">called
with
an
Event
object
when
an
event
is
emitted.
4.9
Events
Clients
can
subscribe
</del>
<ins class="diff-chg">passed
</ins>
to
the
<del class="diff-old">Events
defined
in
ExposedThing
events
.
The
event
types
are
described
in
this
section.
4.9.1
The
PropertyChangeEvent
interface
&lt;span class="idlInterface" id=
"idl-def-propertychangeevent" data-idl="" data-title=
"PropertyChangeEvent"&gt;[&lt;span class=
"extAttrName"&gt;&lt;a href=
"https://heycam.github.io/webidl/#Constructor"&gt;Constructor&lt;a href="#dom-propertychangeeventinit"
class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;init]
interface &lt;a data-lt=
"PropertyChangeEvent" href="#dom-propertychangeevent" class=
"internalDFN" data-link-type="dfn" data-for=
""&gt; : &lt;span class=
"idlSuperclass"&gt;&lt;a href="#dfn-event" class="internalDFN"
data-link-type="dfn"&gt;Event {
&lt;span class="idlAttribute" id="idl-def-propertychangeevent-data"
data-idl="" data-title="data" data-dfn-for=
"propertychangeevent"&gt;    readonly attribute &lt;span class=
"idlAttrType"&gt;&lt;a href="#dom-propertychangeeventinit" class=
"internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlAttrName"&gt;&lt;a data-lt="data" href=
"#dom-propertychangeevent-data" class="internalDFN" data-link-type=
"dfn" data-for=
"PropertyChangeEvent"&gt;
};
The
data
attribute
represents
the
changed
Property
.
4.9.1.1
The
</del>
<code>
<del class="diff-old">PropertyChangeEventInit
dictionary
&lt;span class="idlDictionary" id=
"idl-def-propertychangeeventinit" data-idl="" data-title=
"PropertyChangeEventInit"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-lt="PropertyChangeEventInit" href=
"#dom-propertychangeeventinit" class="internalDFN" data-link-type=
"dfn" data-for=""&gt; {
&lt;span class="idlMember" id="idl-def-propertychangeeventinit-name"
data-idl="" data-title="name" data-dfn-for=
"propertychangeeventinit"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-lt="name"
href="#dom-propertychangeeventinit-name" class="internalDFN"
data-link-type="dfn" data-for=
"PropertyChangeEventInit"&gt;
&lt;span class="idlMember" id="idl-def-propertychangeeventinit-value"
data-idl="" data-title="value" data-dfn-for=
"propertychangeeventinit"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-any"&gt;any&lt;a data-lt="value"
href="#dom-propertychangeeventinit-value" class="internalDFN"
data-link-type="dfn" data-for=
"PropertyChangeEventInit"&gt;
};
The
name
&gt;
attribute
represents
the
Property
name.
The
value
</del>
<ins class="diff-chg">subscribe()
</ins>
</code>
<del class="diff-old">attribute
represents
the
new
value
of
</del>
<ins class="diff-chg">method
when
invoked
on
</ins>
the
<del class="diff-old">Property
.
4.9.2
The
ActionInvocationEvent
interface
&lt;span class="idlInterface" id=
"idl-def-actioninvocationevent" data-idl="" data-title=
"ActionInvocationEvent"&gt;[&lt;span class=
"extAttrName"&gt;&lt;a href=
"https://heycam.github.io/webidl/#Constructor"&gt;Constructor&lt;a href="#dom-actioninvocationeventinit"
class="internalDFN" data-link-type=
"dfn"&gt;]
interface &lt;a data-lt=
"ActionInvocationEvent" href="#dom-actioninvocationevent" class=
"internalDFN" data-link-type="dfn" data-for=
""&gt; : &lt;span class=
"idlSuperclass"&gt;&lt;a href="#dfn-event" class="internalDFN"
data-link-type="dfn"&gt;Event {
&lt;span class="idlAttribute" id="idl-def-actioninvocationevent-data"
data-idl="" data-title="data" data-dfn-for=
"actioninvocationevent"&gt;    readonly attribute &lt;span class=
"idlAttrType"&gt;&lt;a href="#dom-actioninvocationeventinit" class=
"internalDFN" data-link-type=
"dfn"&gt;&lt;a data-lt="data"
href="#dom-actioninvocationevent-data" class="internalDFN"
data-link-type="dfn" data-for=
"ActionInvocationEvent"&gt;
};
The
data
attribute
represents
</del>
<ins class="diff-chg">returned
observer
will
receive
</ins>
the
<del class="diff-old">notification
</del>
<ins class="diff-chg">event
</ins>
data
<del class="diff-old">from
the
Action
invocation.
4.9.2.1
The
ActionInvocationEventInit
dictionary
&lt;span class="idlDictionary" id=
"idl-def-actioninvocationeventinit" data-idl="" data-title=
"ActionInvocationEventInit"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-lt="ActionInvocationEventInit" href=
"#dom-actioninvocationeventinit" class="internalDFN"
data-link-type="dfn" data-for=
""&gt; {
&lt;span class="idlMember" id=
"idl-def-actioninvocationeventinit-actionname" data-idl=""
data-title="actionName" data-dfn-for=
"actioninvocationeventinit"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a data-lt="actionName"
href="#dom-actioninvocationeventinit-actionname" class=
"internalDFN" data-link-type="dfn" data-for=
"ActionInvocationEventInit"&gt;
&lt;span class="idlMember" id=
"idl-def-actioninvocationeventinit-returnvalue" data-idl=""
data-title="returnValue" data-dfn-for=
"actioninvocationeventinit"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a data-lt="returnValue"
href="#dom-actioninvocationeventinit-returnvalue" class=
"internalDFN" data-link-type="dfn" data-for=
"ActionInvocationEventInit"&gt;
};
Editor's
note
Action
parameters
could
be
also
included,
but
it's
debatable
because
privacy
reasons.
The
actionName
attribute
represents
the
name
of
the
Action
that
has
been
invoked.
The
returnValue
attribute
represents
the
return
value
of
</del>
<ins class="diff-chg">each
time
</ins>
the
<del class="diff-old">Action
.
</del>
<ins class="diff-chg">event
is
fired.
</ins>
</p>
</section>
<section id="the-ontdchange-method">
<h3 id="x4-8-the-ontdchange-method">
<span class="secno">
<del class="diff-old">4.9.3
</del>
<ins class="diff-chg">4.8
</ins>
</span>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id= "dom-consumedthing-ontdchange" data-idl="" data-title= "onTDChange()" data-lt= "ontdchange()|onTDChange">
<code>
<del class="diff-old">ThingDescriptionChangeEvent
</del>
<ins class="diff-chg">onTDChange()
</ins>
</code>
</dfn>
<del class="diff-old">interface
&lt;span class="idlInterface" id=
"idl-def-thingdescriptionchangeevent" data-idl="" data-title=
"ThingDescriptionChangeEvent"&gt;[&lt;span class=
"extAttrName"&gt;&lt;a href=
"https://heycam.github.io/webidl/#Constructor"&gt;Constructor&lt;a href="#dom-thingdescriptionchangeeventinit"
class="internalDFN" data-link-type=
"dfn"&gt;]
interface &lt;a data-lt=
"ThingDescriptionChangeEvent" href=
"#dom-thingdescriptionchangeevent" class="internalDFN"
data-link-type="dfn" data-for=
""&gt;&lt;a href="#dfn-event"
class="internalDFN" data-link-type="dfn"&gt;Event {
&lt;span class="idlAttribute" id=
"idl-def-thingdescriptionchangeevent-data" data-idl="" data-title=
"data" data-dfn-for=
"thingdescriptionchangeevent"&gt;    readonly attribute &lt;span class=
"idlAttrType"&gt;&lt;a href="#dom-thingdescriptionchangeeventinit" class=
"internalDFN" data-link-type=
"dfn"&gt;&lt;a data-lt="data"
href="#dom-thingdescriptionchangeevent-data" class="internalDFN"
data-link-type="dfn" data-for=
"ThingDescriptionChangeEvent"&gt;
};
</del>
<ins class="diff-chg">method
</ins></h3>
<p>
<del class="diff-old">The
</del>
<ins class="diff-chg">Returns
an
</ins><a href="#dom-observable" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">data
</del>
<ins class="diff-chg">Observable
</ins>
</code>
<del class="diff-old">attribute
represents
the
changes
that
occurred
</del>
</a>,
<ins class="diff-chg">allowing
subscribing
to
and
unsubscribing
from
notifications
</ins>
to
the
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
</a>.
</p>
<del class="diff-old">4.9.3.1
The
ThingDescriptionChangeEventInit
dictionary
&lt;span class="idlDictionary" id=
"idl-def-thingdescriptionchangeeventinit" data-idl="" data-title=
"ThingDescriptionChangeEventInit"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-lt="ThingDescriptionChangeEventInit"
href="#dom-thingdescriptionchangeeventinit" class="internalDFN"
data-link-type="dfn" data-for=
""&gt; {
&lt;span class="idlMember" id=
"idl-def-thingdescriptionchangeeventinit-type" data-idl=""
data-title="type" data-dfn-for=
"thingdescriptionchangeeventinit"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href="#dom-tdchangetype" class="internalDFN"
data-link-type=
"dfn"&gt;     &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="type" href=
"#dom-thingdescriptionchangeeventinit-type" class="internalDFN"
data-link-type="dfn" data-for=
"ThingDescriptionChangeEventInit"&gt;
&lt;span class="idlMember" id=
"idl-def-thingdescriptionchangeeventinit-method" data-idl=""
data-title="method" data-dfn-for=
"thingdescriptionchangeeventinit"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href="#dom-tdchangemethod" class="internalDFN"
data-link-type=
"dfn"&gt;   &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="method" href=
"#dom-thingdescriptionchangeeventinit-method" class="internalDFN"
data-link-type="dfn" data-for=
"ThingDescriptionChangeEventInit"&gt;
&lt;span class="idlMember" id=
"idl-def-thingdescriptionchangeeventinit-name" data-idl=""
data-title="name" data-dfn-for=
"thingdescriptionchangeeventinit"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-lt="name"
href="#dom-thingdescriptionchangeeventinit-name" class=
"internalDFN" data-link-type="dfn" data-for=
"ThingDescriptionChangeEventInit"&gt;
&lt;span class="idlMember" id=
"idl-def-thingdescriptionchangeeventinit-data" data-idl=""
data-title="data" data-dfn-for=
"thingdescriptionchangeeventinit"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href="#dom-tdchangedata" class="internalDFN"
data-link-type=
"dfn"&gt;     &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="data" href=
"#dom-thingdescriptionchangeeventinit-data" class="internalDFN"
data-link-type="dfn" data-for=
"ThingDescriptionChangeEventInit"&gt;
&lt;span class="idlMember" id=
"idl-def-thingdescriptionchangeeventinit-description" data-idl=""
data-title="description" data-dfn-for=
"thingdescriptionchangeeventinit"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href="#dom-thingdescription" class="internalDFN"
data-link-type=
"dfn"&gt; &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="description" href=
"#dom-thingdescriptionchangeeventinit-description" class=
"internalDFN" data-link-type="dfn" data-for=
"ThingDescriptionChangeEventInit"&gt;
};
The
type
attribute
represents
the
change
type,
whether
has
it
been
applied
on
properties,
Actions
or
Events
.
The
method
attribute
tells
what
operation
has
been
applied,
addition,
removal
or
change.
The
name
attribute
represents
the
name
of
the
Property
,
Action
or
event
that
has
changed.
The
description
attribute
is
defined
for
the
addition
and
change
methods,
and
represents
the
new
description.
The
data
attribute
provides
the
initialization
data
for
the
added
or
changed
elements.
4.9.3.1.1
The
TDChangeMethod
enumeration
&lt;span class="idlEnum" id=
"idl-def-tdchangemethod" data-idl="" data-title=
"TDChangeMethod"&gt;enum &lt;a data-lt=
"TDChangeMethod" href="#dom-tdchangemethod" class="internalDFN"
data-link-type="dfn" data-for=
""&gt; {
    &lt;a href="#dom-tdchangemethod-add" class=
"idlEnumItem"&gt;"add",
    &lt;a href="#dom-tdchangemethod-remove" class=
"idlEnumItem"&gt;"remove",
    &lt;a href="#dom-tdchangemethod-change" class=
"idlEnumItem"&gt;"change"
};
The
add
value
denotes
addition
of
a
Property
,
Action
or
event.
The
remove
value
denotes
removal
of
a
Property
,
Action
or
event.
The
change
value
denotes
a
change
applied
on
a
Property
,
Action
or
event.
4.9.3.1.2
The
TDChangeType
enumeration
&lt;span class="idlEnum" id=
"idl-def-tdchangetype" data-idl="" data-title=
"TDChangeType"&gt;enum &lt;a data-lt=
"TDChangeType" href="#dom-tdchangetype" class="internalDFN"
data-link-type="dfn" data-for=
""&gt; {
    &lt;a href="#dom-tdchangetype-property" class=
"idlEnumItem"&gt;"property",
    &lt;a href="#dom-tdchangetype-action" class=
"idlEnumItem"&gt;"action",
    &lt;a href="#dom-tdchangetype-event" class=
"idlEnumItem"&gt;"event"
};
&lt;span class="idlTypedef" id="idl-def-tdchangedata" data-idl=""
data-title="TDChangeData"&gt;typedef &lt;span class=
"idlTypedefType"&gt;(&lt;a href="#dom-thingpropertyinit" class=
"internalDFN" data-link-type=
"dfn"&gt; or &lt;a href=
"#dom-thingactioninit" class="internalDFN" data-link-type=
"dfn"&gt; or &lt;a href=
"#dom-thingeventinit" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlTypedefID"&gt;&lt;a data-lt="TDChangeData" href="#dom-tdchangedata"
class="internalDFN" data-link-type="dfn" data-for=
""&gt;
TDChangeData
;
</del>
<p>
The
<del class="diff-old">property
value
tells
</del>
<ins class="diff-chg">callback
function
passed
to
</ins>
the
<del class="diff-old">operation
was
applied
on
a
Property
definition.
The
</del>
<code>
<del class="diff-old">action
</del>
<ins class="diff-chg">subscribe()
</ins>
</code>
<del class="diff-old">value
tells
the
operation
was
applied
</del>
<ins class="diff-chg">method
when
invoked
</ins>
on
<del class="diff-old">a
action
definition.
The
event
value
tells
</del>
the
<del class="diff-old">operation
was
applied
on
an
event
definition.
4.9.3.1.3
The
TDChangeData
type
Represents
</del>
<ins class="diff-chg">returned
observer
will
receive
</ins>
the
new
<del class="diff-old">description
of
the
changed
element.
Depending
on
the
change
type,
</del>
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Thing
Description
</ins></a><ins class="diff-chg">
each
time
</ins>
it
<del class="diff-old">can
be
either
a
ThingPropertyInit
,
ThingActionInit
,
or
ThingEventInit
.
</del>
<ins class="diff-chg">is
changed.
</ins>
</p>
</section>
<section id="examples-0">
<h3 id="x4-9-examples">
<span class="secno">
<del class="diff-old">4.10
</del>
<ins class="diff-chg">4.9
</ins>
</span>
Examples
</h3>
<p>
Below
a
<code>
<a href="#dom-consumedthing" class="internalDFN" data-link-type="dfn">
<code>
ConsumedThing
</code>
</a>
</code>
interface
example
is
given.
</p>
<div class="example">
<div class="example-title marker">
<span>
Example
<del class="diff-old">5
</del>
<ins class="diff-chg">6
</ins>
</span>
<span style="text-transform: none">:
Consume
a
Thing
</span>
</div>
<del class="diff-old">wot.consume(&lt;span class=
"hljs-string"&gt;"http://mmyservice.org/mySensor" {
    .log(&lt;span class=
"hljs-string"&gt;"Thing " + thing.name + &lt;span class=
"hljs-string"&gt;" has been consumed.");
    .log(&lt;span class=
"hljs-string"&gt;"{ " + &lt;span class=
"hljs-built_in"&gt;JSON.serialize(thing) + &lt;span class=
"hljs-string"&gt;" }");
    thing.addListener(&lt;span class=
"hljs-string"&gt;"onchange", &lt;span class=
"hljs-function"&gt;&lt;span class=
"hljs-keyword"&gt;function(&lt;span class=
"hljs-params"&gt;event{
         (event &lt;span class=
"hljs-keyword"&gt;instanceof PropertyChangeEvent) {
            &lt;span class=
"hljs-built_in"&gt;console.log(&lt;span class=
"hljs-string"&gt;"Property " + event.name + &lt;span class=
"hljs-string"&gt;" value has changed to " + event.value);
        }
    }).invokeAction(&lt;span class=
"hljs-string"&gt;"startMeasurement", [&lt;span class=
"hljs-string"&gt;"Celsius"]);
  },
).catch(&lt;span class=
"hljs-params"&gt;error {
  .log(&lt;span class=
"hljs-string"&gt;"Discovery finished because an error: " + error.message);
});
</del>
<pre class="hljs" aria-busy="false">try {
<ins class="diff-chg">  let td = await wot.fetch("http://mmyservice.org/mySensor");
  let thing = wot.consume(td);
  console.log("Thing " + thing.name + " has been consumed.");
  let subscription = thing.onPropertyChange("temperature")
    .subscribe(function(value) {
      console.log("Temperature + " has changed to " + value);
    });
  thing.invokeAction("startMeasurement", { units: "Celsius" })
    .then(() =&gt; { console.log("Temperature measurement started."); })
    .catch(e =&gt; {
       console.log("Error starting measurement.");
       subscription.unsubscribe();
     })
} catch(error) {
  console.log("Error during fetch or consume: " + error.message);
};
</ins>
</pre>
</div>
</section>
</section>
<section data-dfn-for="ExposedThing" id= "the-exposedthing-interface">
<h2 id="x5-the-exposedthing-interface">
<span class= "secno">
5.
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-exposedthing" data-idl="" data-title= "ExposedThing">
<code>
ExposedThing
</code>
</dfn>
interface
</h2>
<p>
The
<a href="#dom-exposedthing" class="internalDFN" data-link-type="dfn">
<code>
ExposedThing
</code>
</a>
interface
is
the
server
API
that
allows
defining
request
handlers,
properties,
<a href="#dfn-actions" class="internalDFN" data-link-type= "dfn">
Actions
</a>,
and
<a href="#dfn-events" class="internalDFN" data-link-type="dfn">
Events
</a>
to
a
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>.
<ins class="diff-new">It
also
implements
the
</ins><a href="#dom-consumedthing" class="internalDFN" data-link-type="dfn"><code><ins class="diff-new">
ConsumedThing
</ins></code></a><ins class="diff-new">
interface.
An
</ins><a href="#dom-exposedthing" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
ExposedThing
</ins></code></a><ins class="diff-new">
is
created
by
the
</ins><a href= "#the-produce-method"><ins class="diff-new">
produce()
</ins></a><ins class="diff-new">
method.
</ins>
</p>
<del class="diff-old">&lt;span class="idlTypedef" id=
"idl-def-thingdescription" data-idl="" data-title=
"ThingDescription"&gt;typedef &lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString&lt;a data-lt="ThingDescription"
href="#dom-thingdescription" class="internalDFN" data-link-type=
"dfn" data-for=""&gt;
</del>
<div class="ednote">
<div role="heading" class="ednote-title marker" id="h-ednote-7" aria-level="3">
<del class="diff-old">&lt;span class="idlCallback" id="idl-def-requesthandler" data-idl=""
data-title="RequestHandler"&gt;callback &lt;span class=
"idlCallbackID"&gt;&lt;a data-lt="RequestHandler" href=
"#dom-requesthandler" class="internalDFN" data-link-type="dfn"
data-for=""&gt; = &lt;span class=
"idlCallbackType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-any"&gt;any&lt;a href="#dom-request"
class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;request
</del>
<span>
<ins class="diff-chg">Editor's
note
</ins></span></div><p class=""><ins class="diff-chg">
It
is
under
consideration
to
use
a
constructor
for
</ins><a href="#dom-exposedthing" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ExposedThing
</ins></code></a><ins class="diff-chg">
instead
of
a
factory
method.
</ins></p></div><div><pre class="def idl"><span class="idlImplements"><a href=<ins class="diff-chg">
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a> implements <a href=
"#dom-consumedthing" class="internalDFN" data-link-type=
"dfn"><code>ConsumedThing</code></a>;</span>
</ins>
<span class="idlInterface" id="idl-def-exposedthing" data-idl=""
data-title="ExposedThing">interface <span class=
<del class="diff-old">"idlInterfaceID"&gt;&lt;a data-lt="ExposedThing" href="#dom-exposedthing"
class="internalDFN" data-link-type="dfn" data-for=
""&gt; {
</del>
<ins class="diff-chg">"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span> {
</ins><span class=<ins class="diff-chg">
"idlSectionComment">    // define how to expose and run the Thing</span>
</ins><span class="idlMethod" id="idl-def-exposedthing-start" data-idl=""<ins class="diff-chg">
data-title="start" data-dfn-for="exposedthing">    <span class=
"idlMethType"><a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="exposedthing" data-lt="start()|start" href=
"#dom-exposedthing-start" class="internalDFN" data-link-type=
"dfn">start</a></span>();</span>
</ins><span class="idlMethod" id="idl-def-exposedthing-stop" data-idl=""<ins class="diff-chg">
data-title="stop" data-dfn-for="exposedthing">    <span class=
"idlMethType"><a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="exposedthing" data-lt="stop()|stop" href=
"#dom-exposedthing-stop" class="internalDFN" data-link-type=
"dfn">stop</a></span>();</span>
</ins><span class="idlMethod" id=<ins class="diff-chg">
"idl-def-exposedthing-register-directory" data-idl="" data-title=
"register" data-dfn-for="exposedthing">    <span class=
"idlMethType"><a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="exposedthing" data-lt="register()|register" href=
"#dom-exposedthing-register" class="internalDFN" data-link-type=
"dfn">register</a></span>(<span class=
"idlParam">optional <span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">directory</span></span>);</span>
</ins><span class="idlMethod" id=<ins class="diff-chg">
"idl-def-exposedthing-unregister-directory" data-idl="" data-title=
"unregister" data-dfn-for="exposedthing">    <span class=
"idlMethType"><a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="exposedthing" data-lt="unregister()|unregister"
href="#dom-exposedthing-unregister" class="internalDFN"
data-link-type="dfn">unregister</a></span>(<span class=
"idlParam">optional <span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlParamName">directory</span></span>);</span>
</ins><span class="idlMethod" id=<ins class="diff-chg">
"idl-def-exposedthing-emitevent-eventname-payload" data-idl=""
data-title="emitEvent" data-dfn-for="exposedthing">    <span class=
"idlMethType"><a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> <span class="idlMethName"><a data-no-default=""
data-link-for="exposedthing" data-lt="emitevent()|emitEvent" href=
"#dom-exposedthing-emitevent" class="internalDFN" data-link-type=
"dfn">emitEvent</a></span>(<span class="idlParam"><span class=
"idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">eventName</span></span>, <span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">payload</span></span>);</span>
</ins>
<span class=
"idlSectionComment">    // define Thing Description modifiers</span>
<span class="idlMethod" id=
<del class="diff-old">"idl-def-exposedthing-addproperty(property)" data-idl=""
data-title="addProperty" data-dfn-for=
"exposedthing"&gt;    &lt;a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
</del>
<ins class="diff-chg">"idl-def-exposedthing-addproperty-property" data-idl="" data-title=
"addProperty" data-dfn-for="exposedthing">    <span class=
"idlMethType"><a href="#dom-exposedthing" class="internalDFN"
data-link-type=
</ins>
"dfn"><code>ExposedThing</code></a></span>  <span class=
<del class="diff-old">"idlMethName"&gt;&lt;a data-lt="addProperty()|addproperty()|addProperty"
data-lt-nodefault="" href="#dom-exposedthing-addproperty()" class=
"internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;addProperty(&lt;span class=
"idlParam"&gt;&lt;a href=
"#dom-thingpropertyinit" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
</del>
<ins class="diff-chg">"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt="addproperty()|addProperty" href=
"#dom-exposedthing-addproperty" class="internalDFN" data-link-type=
"dfn">addProperty</a></span>(<span class="idlParam"><span class=
"idlParamType"><a href="#dom-thingproperty" class="internalDFN"
data-link-type=
"dfn"><code>ThingProperty</code></a></span> <span class=
</ins>
"idlParamName">property</span></span>);</span>
<span class="idlMethod" id=
<del class="diff-old">"idl-def-exposedthing-removeproperty(name)" data-idl="" data-title=
</del>
<ins class="diff-chg">"idl-def-exposedthing-removeproperty-name" data-idl="" data-title=
</ins>
"removeProperty" data-dfn-for="exposedthing">    <span class=
"idlMethType"><a href="#dom-exposedthing" class="internalDFN"
data-link-type=
"dfn"><code>ExposedThing</code></a></span>  <span class=
<del class="diff-old">"idlMethName"&gt;&lt;a data-lt=
"removeProperty()|removeproperty()|removeProperty"
data-lt-nodefault="" href="#dom-exposedthing-removeproperty()"
class="internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;removeProperty(&lt;span class=
</del>
<ins class="diff-chg">"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt="removeproperty()|removeProperty" href=
"#dom-exposedthing-removeproperty" class="internalDFN"
data-link-type="dfn">removeProperty</a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span>
<del class="diff-old">&lt;span class="idlMethod" id="idl-def-exposedthing-addaction(action)"
</del>
<span class="idlMethod" id="idl-def-exposedthing-addaction-action"
data-idl="" data-title="addAction" data-dfn-for=
"exposedthing">    <span class="idlMethType"><a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span>  <span class=
<del class="diff-old">"idlMethName"&gt;&lt;a data-lt="addAction()|addaction()|addAction"
data-lt-nodefault="" href="#dom-exposedthing-addaction()" class=
"internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;addAction(&lt;span class=
"idlParam"&gt;&lt;a href=
"#dom-thingactioninit" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;action
&lt;span class="idlMethod" id=
"idl-def-exposedthing-removeaction(name)" data-idl="" data-title=
"removeAction" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href="#dom-exposedthing" class="internalDFN"
</del>
<ins class="diff-chg">"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt="addaction()|addAction" href="#dom-exposedthing-addaction"
class="internalDFN" data-link-type=
"dfn">addAction</a></span>(<span class="idlParam"><span class=
"idlParamType"><a href="#dom-thingaction" class="internalDFN"
</ins>
data-link-type=
<ins class="diff-new">"dfn"><code>ThingAction</code></a></span> <span class=
"idlParamName">action</span></span>);</span>
</ins><span class="idlMethod" id="idl-def-exposedthing-removeaction-name"<ins class="diff-new">
data-idl="" data-title="removeAction" data-dfn-for=
"exposedthing">    <span class="idlMethType"><a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
</ins>
"dfn"><code>ExposedThing</code></a></span>  <span class=
<del class="diff-old">"idlMethName"&gt;&lt;a data-lt=
"removeAction()|removeaction()|removeAction" data-lt-nodefault=""
href="#dom-exposedthing-removeaction()" class="internalDFN"
data-link-type="dfn" data-for=
"ExposedThing"&gt;removeAction(&lt;span class=
</del>
<ins class="diff-chg">"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt="removeaction()|removeAction" href=
"#dom-exposedthing-removeaction" class="internalDFN"
data-link-type="dfn">removeAction</a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span>
<del class="diff-old">&lt;span class="idlMethod" id="idl-def-exposedthing-addevent(event)"
</del>
<span class="idlMethod" id="idl-def-exposedthing-addevent-event"
data-idl="" data-title="addEvent" data-dfn-for=
"exposedthing">    <span class="idlMethType"><a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span>  <span class=
<del class="diff-old">"idlMethName"&gt;&lt;a data-lt="addEvent()|addevent()|addEvent"
data-lt-nodefault="" href="#dom-exposedthing-addevent()" class=
"internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;addEvent(&lt;span class=
"idlParam"&gt;&lt;a href="#dom-thingeventinit"
</del>
<ins class="diff-chg">"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt="addevent()|addEvent" href="#dom-exposedthing-addevent"
</ins>
class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt; &lt;span class=
"idlParamName"&gt;event
&lt;span class="idlMethod" id="idl-def-exposedthing-removeevent(name)"
</del>
<ins class="diff-chg">"dfn">addEvent</a></span>(<span class="idlParam"><span class=
"idlParamType"><a href="#dom-thingevent" class="internalDFN"
data-link-type=
"dfn"><code>ThingEvent</code></a></span> <span class="idlParamName">event</span></span>);</span>
</ins><span class="idlMethod" id="idl-def-exposedthing-removeevent-name"
data-idl="" data-title="removeEvent" data-dfn-for=
"exposedthing">    <span class="idlMethType"><a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span>  <span class=
<del class="diff-old">"idlMethName"&gt;&lt;a data-lt="removeEvent()|removeevent()|removeEvent"
data-lt-nodefault="" href="#dom-exposedthing-removeevent()" class=
"internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;removeEvent(&lt;span class=
"idlParam"&gt;&lt;a href=
</del>
<ins class="diff-chg">"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt="removeevent()|removeEvent" href=
"#dom-exposedthing-removeevent" class="internalDFN" data-link-type=
"dfn">removeEvent</a></span>(<span class="idlParam"><span class=
"idlParamType"><a href=
</ins>
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>);</span>
<span class=
"idlSectionComment">    // define request handlers</span>
<span class="idlMethod" id=
<del class="diff-old">"idl-def-exposedthing-onretrieveproperty(handler)" data-idl=""
data-title="onRetrieveProperty" data-dfn-for=
</del>
<ins class="diff-chg">"idl-def-exposedthing-setpropertyreadhandler-name-readhandler"
data-idl="" data-title="setPropertyReadHandler" data-dfn-for=
</ins>
"exposedthing">    <span class="idlMethType"><a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span>  <span class=
<del class="diff-old">"idlMethName"&gt;&lt;a data-lt=
"onRetrieveProperty()|onretrieveproperty()|onRetrieveProperty"
data-lt-nodefault="" href="#dom-exposedthing-onretrieveproperty()"
class="internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;onRetrieveProperty(&lt;span class=
"idlParam"&gt;&lt;a href="#dom-requesthandler"
class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;handler
</del>
<ins class="diff-chg">"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt="setpropertyreadhandler()|setPropertyReadHandler" href=
"#dom-exposedthing-setpropertyreadhandler" class="internalDFN"
data-link-type="dfn">setPropertyReadHandler</a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,
</ins>                                         <span class=<ins class="diff-chg">
"idlParam"><span class="idlParamType"><a href=
"#dom-propertyreadhandler" class="internalDFN" data-link-type=
"dfn"><code>PropertyReadHandler</code></a></span> <span class=
"idlParamName">readHandler</span></span>);</span>
</ins>
<span class="idlMethod" id=
<del class="diff-old">"idl-def-exposedthing-onupdateproperty(handler)" data-idl=""
data-title="onUpdateProperty" data-dfn-for=
</del>
<ins class="diff-chg">"idl-def-exposedthing-setpropertywritehandler-name-writehandler"
data-idl="" data-title="setPropertyWriteHandler" data-dfn-for=
</ins>
"exposedthing">    <span class="idlMethType"><a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span>  <span class=
<del class="diff-old">"idlMethName"&gt;&lt;a data-lt=
"onUpdateProperty()|onupdateproperty()|onUpdateProperty"
data-lt-nodefault="" href="#dom-exposedthing-onupdateproperty()"
class="internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;onUpdateProperty(&lt;span class=
"idlParam"&gt;&lt;a href="#dom-requesthandler"
class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;handler
</del>
<ins class="diff-chg">"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt="setpropertywritehandler()|setPropertyWriteHandler" href=
"#dom-exposedthing-setpropertywritehandler" class="internalDFN"
data-link-type=
"dfn">setPropertyWriteHandler</a></span>(<span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>,
</ins>                                          <span class=<ins class="diff-chg">
"idlParam"><span class="idlParamType"><a href=
"#dom-propertywritehandler" class="internalDFN" data-link-type=
"dfn"><code>PropertyWriteHandler</code></a></span> <span class=
"idlParamName">writeHandler</span></span>);</span>
</ins>
<span class="idlMethod" id=
<del class="diff-old">"idl-def-exposedthing-oninvokeaction(handler)" data-idl=""
data-title="onInvokeAction" data-dfn-for=
</del>
<ins class="diff-chg">"idl-def-exposedthing-setactionhandler-name-action" data-idl=""
data-title="setActionHandler" data-dfn-for=
</ins>
"exposedthing">    <span class="idlMethType"><a href=
"#dom-exposedthing" class="internalDFN" data-link-type=
"dfn"><code>ExposedThing</code></a></span>  <span class=
<del class="diff-old">"idlMethName"&gt;&lt;a data-lt=
"onInvokeAction()|oninvokeaction()|onInvokeAction"
data-lt-nodefault="" href="#dom-exposedthing-oninvokeaction()"
class="internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;onInvokeAction(&lt;span class=
"idlParam"&gt;&lt;a href="#dom-requesthandler"
class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;handler
&lt;span class="idlMethod" id=
"idl-def-exposedthing-onobserve(handler)" data-idl="" data-title=
"onObserve" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href="#dom-exposedthing" class="internalDFN"
data-link-type=
"dfn"&gt;  &lt;span class=
"idlMethName"&gt;&lt;a data-lt="onObserve()|onobserve()|onObserve"
data-lt-nodefault="" href="#dom-exposedthing-onobserve()" class=
"internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;onObserve(&lt;span class=
"idlParam"&gt;&lt;a href="#dom-requesthandler"
class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlParamName"&gt;handler
&lt;span class=
"idlSectionComment"&gt;    // define how to expose and run the Thing
&lt;span class="idlMethod" id=
"idl-def-exposedthing-register(directory)" data-idl="" data-title=
"register" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-lt="register()|register()|register"
data-lt-nodefault="" href="#dom-exposedthing-register()" class=
"internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;register(&lt;span class=
"idlParam"&gt;optional &lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString
&lt;span class="idlMethod" id=
"idl-def-exposedthing-unregister(directory)" data-idl=""
data-title="unregister" data-dfn-for=
"exposedthing"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-lt="unregister()|unregister()|unregister"
data-lt-nodefault="" href="#dom-exposedthing-unregister()" class=
"internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;unregister(&lt;span class=
"idlParam"&gt;optional &lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString
&lt;span class="idlMethod" id="idl-def-exposedthing-start()" data-idl=
"" data-title="start" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-lt="start()|start()|start"
data-lt-nodefault="" href="#dom-exposedthing-start()" class=
"internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;start
&lt;span class="idlMethod" id="idl-def-exposedthing-stop()" data-idl=
"" data-title="stop" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-lt="stop()|stop()|stop"
data-lt-nodefault="" href="#dom-exposedthing-stop()" class=
"internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;stop
&lt;span class="idlMethod" id=
"idl-def-exposedthing-emitevent(eventname,payload)" data-idl=""
data-title="emitEvent" data-dfn-for="exposedthing"&gt;    &lt;span class=
"idlMethType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-lt="emitEvent()|emitevent()|emitEvent"
data-lt-nodefault="" href="#dom-exposedthing-emitevent()" class=
"internalDFN" data-link-type="dfn" data-for=
"ExposedThing"&gt;emitEvent(&lt;span class=
</del>
<ins class="diff-chg">"idlMethName"><a data-no-default="" data-link-for="exposedthing"
data-lt="setactionhandler()|setActionHandler" href=
"#dom-exposedthing-setactionhandler" class="internalDFN"
data-link-type="dfn">setActionHandler</a></span>(<span class=
</ins>
"idlParam"><span class="idlParamType"><a href=
<del class="diff-old">"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString
</del>
<ins class="diff-chg">"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlParamName">name</span></span>, <span class="idlParam"><span class="idlParamType"><a href="#dom-actionhandler"
class="internalDFN" data-link-type=
"dfn"><code>ActionHandler</code></a></span> <span class=
"idlParamName">action</span></span>);</span>
</ins>
};</span>
<del class="diff-old">&lt;a href="#dom-exposedthing" class=
"internalDFN" data-link-type=
"dfn"&gt; implements &lt;a href=
"#dom-consumedthing" class="internalDFN" data-link-type=
"dfn"&gt;
</del>
<span class="idlCallback" id="idl-def-propertyreadhandler"
<ins class="diff-chg">data-idl="" data-title="PropertyReadHandler">callback <span class=
"idlCallbackID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-propertyreadhandler" class="internalDFN" data-link-type=
"dfn"><code>PropertyReadHandler</code></a></span> = <span class=
"idlCallbackType"><a href=
"https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;<a href="https://heycam.github.io/webidl/#idl-any">any</a>&gt;</span> ();</span>
</ins>
<del class="diff-old">ConsumedThing
</del>
<span class="idlCallback" id="idl-def-propertywritehandler"
<ins class="diff-chg">data-idl="" data-title="PropertyWriteHandler">callback <span class=
"idlCallbackID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-propertywritehandler" class="internalDFN"
data-link-type="dfn"><code>PropertyWriteHandler</code></a></span> = <span class="idlCallbackType"><a href="https://heycam.github.io/webidl/#idl-promise">Promise</a>&lt;void&gt;</span> (<span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">value</span></span>);</span>
</ins>
<span class="idlCallback" id="idl-def-actionhandler" data-idl=""
<ins class="diff-new">data-title="ActionHandler">callback <span class=
"idlCallbackID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-actionhandler" class="internalDFN" data-link-type=
"dfn"><code>ActionHandler</code></a></span> = <span class=
"idlCallbackType"><a href=
"https://heycam.github.io/webidl/#idl-promise">
Promise
</ins>
</a>
<del class="diff-old">;
</del>
<ins class="diff-chg">&lt;
</ins><a<ins class="diff-chg">
href="https://heycam.github.io/webidl/#idl-any">
any
</ins></a><ins class="diff-chg">
&gt;
</ins></span><ins class="diff-chg">
(
</ins><span class="idlParam"><span class="idlParamType"><a href="https://heycam.github.io/webidl/#idl-any"><ins class="diff-chg">
any
</ins></a></span><span class="idlParamName"><ins class="diff-chg">
parameters
</ins></span></span><ins class="diff-chg">
);
</ins>
</span>
</pre>
</div>
<section id="the-start-method">
<h3 id="x5-1-the-start-method">
<span class="secno">
5.1
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-start" data-idl="" data-title="start()" data-lt= "start()|start">
<code>
<del class="diff-old">ThingDescription
</del>
<ins class="diff-chg">start()
</ins>
</code>
</dfn>
<del class="diff-old">type
</del>
<ins class="diff-chg">method
</ins>
</h3>
<p>
<del class="diff-old">WoT
provides
a
unified
representation
</del>
<ins class="diff-chg">Start
serving
external
requests
</ins>
for
<del class="diff-old">data
exchange
between
Thing
s,
standardized
in
the
Wot
Things
Description
specification.
Note
In
this
version
of
</del>
the
<del class="diff-old">API,
</del>
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
<del class="diff-old">Description
s
are
represented
as
opaque
strings,
denoting
a
serialized
form,
for
instance
JSON
or
JSON-LD.
See
Issue
38
and
Issue
45
</del>
</a>.
<del class="diff-old">Parsing
and
composing
Thing
Description
s
is
left
for
external
libraries
until
standardized
here.
</del>
</p>
</section>
<section id="the-stop-method">
<h3 id="x5-2-the-stop-method">
<span class="secno">
5.2
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-stop" data-idl="" data-title="stop()" data-lt= "stop()|stop">
<code>
<del class="diff-old">Request
</del>
<ins class="diff-chg">stop()
</ins>
</code>
</dfn>
<del class="diff-old">interface
</del>
<ins class="diff-chg">method
</ins>
</h3>
<del class="diff-old">&lt;span class="idlInterface" id=
"idl-def-request" data-idl="" data-title=
"Request"&gt;interface &lt;a data-lt=
"Request" href="#dom-request" class="internalDFN" data-link-type=
"dfn" data-for=""&gt; {
&lt;span class="idlAttribute" id="idl-def-request-type" data-idl=""
data-title="type" data-dfn-for=
"request"&gt;    readonly attribute &lt;a href=
"#dom-requesttype" class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlAttrName"&gt;&lt;a data-lt="type" href="#dom-request-type" class=
"internalDFN" data-link-type="dfn" data-for=
"Request"&gt;
&lt;span class="idlAttribute" id="idl-def-request-from" data-idl=""
data-title="from" data-dfn-for=
"request"&gt;    readonly attribute &lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString&lt;a data-lt="from"
href="#dom-request-from" class="internalDFN" data-link-type="dfn"
data-for="Request"&gt;
&lt;span class="idlAttribute" id="idl-def-request-name" data-idl=""
data-title="name" data-dfn-for=
"request"&gt;    readonly attribute &lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-lt="name"
href="#dom-request-name" class="internalDFN" data-link-type="dfn"
data-for="Request"&gt;
&lt;span class="idlAttribute" id="idl-def-request-options" data-idl=""
data-title="options" data-dfn-for=
"request"&gt;    readonly attribute &lt;span class=
"idlAttrType"&gt;Dictionary  &lt;span class=
"idlAttrName"&gt;&lt;a data-lt="options" href="#dom-request-options"
class="internalDFN" data-link-type="dfn" data-for=
"Request"&gt;
&lt;span class="idlAttribute" id="idl-def-request-data" data-idl=""
data-title="data" data-dfn-for=
"request"&gt;    readonly attribute &lt;a href=
"https://heycam.github.io/webidl/#idl-any"&gt;any&lt;a data-lt="data"
href="#dom-request-data" class="internalDFN" data-link-type="dfn"
data-for="Request"&gt;
&lt;span class="idlMethod" id="idl-def-request-respond(response)"
data-idl="" data-title="respond" data-dfn-for=
"request"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-promise"&gt;Promise&lt;a data-lt="respond()|respond()|respond"
data-lt-nodefault="" href="#dom-request-respond()" class=
"internalDFN" data-link-type="dfn" data-for=
"Request"&gt;respond&lt;span class=
"idlParamType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-any"&gt;any
&lt;span class="idlMethod" id=
"idl-def-request-respondwitherror(error)" data-idl="" data-title=
"respondWithError" data-dfn-for="request"&gt;    &lt;span class=
"idlMethType"&gt;void&lt;a data-lt=
"respondWithError()|respondwitherror()|respondWithError"
data-lt-nodefault="" href="#dom-request-respondwitherror()" class=
"internalDFN" data-link-type="dfn" data-for=
"Request"&gt;respondWithError(&lt;span class=
"idlParam"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-Error"&gt;Error
};
</del>
<p>
<del class="diff-old">Represents
an
incoming
request
</del>
<ins class="diff-chg">Stop
serving
external
requests
for
</ins>
the
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Thing
</ins></a>.</p></section><section id="the-register-method"><h3 id="x5-3-the-register-method"><span class="secno"><ins class="diff-chg">
5.3
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-register" data-idl="" data-title="register()" data-lt="register()|register">
<code>
<del class="diff-old">ExposedThing
</del>
<ins class="diff-chg">register()
</ins>
</code>
</dfn>
<ins class="diff-new">method
</ins></h3><p><ins class="diff-new">
Generates
the
</ins><a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
Thing
Description
</ins>
</a>
<del class="diff-old">is
supposed
to
handle,
for
instance
retrieving
and
updating
</del>
<ins class="diff-chg">given
the
</ins>
properties,
<del class="diff-old">invoking
</del>
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Actions
</a>
and
<del class="diff-old">observing
Events
</del>
<a href="#dfn-events" class= "internalDFN" data-link-type="dfn">
<ins class="diff-chg">Event
</ins>
</a>
<del class="diff-old">(WoT
interactions).
The
type
attribute
represents
the
type
of
the
request
as
</del>
defined
<del class="diff-old">in
RequestType
.
The
</del>
<ins class="diff-chg">for
this
object.
If
a
</ins>
<code>
<del class="diff-old">from
</del>
<ins class="diff-chg">directory
</ins>
</code>
<del class="diff-old">attribute
represents
the
address
of
the
client
device
issuing
the
request.
The
type
of
the
address
(URL,
UUID
or
other)
</del>
<ins class="diff-chg">argument
</ins>
is
<del class="diff-old">defined
by
</del>
<ins class="diff-chg">given,
make
a
request
to
register
</ins>
the
<a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn">
Thing
Description
<del class="diff-old">.
The
name
attribute
represents
the
name
of
the
Property
</del>
</a>
<del class="diff-old">to
be
retrieved
or
updated,
or
the
name
of
the
invoked
Action
,
or
the
event
name
to
be
observed.
The
options
attribute
represents
the
options
relevant
to
the
request
(e.g.
the
format
or
measurement
units
for
</del>
<ins class="diff-chg">with
</ins>
the
<del class="diff-old">returned
value)
as
key-value
pairs.
The
exact
format
is
specified
</del>
<ins class="diff-chg">given
WoT
repository
</ins>
by
<del class="diff-old">the
Thing
Description
.
The
</del>
<ins class="diff-chg">invoking
its
</ins>
<code>
<del class="diff-old">data
</del>
<ins class="diff-chg">register
</ins>
</code>
<del class="diff-old">attribute
represents
the
value
of
the
Property
,
or
the
input
data
(arguments)
of
an
</del>
<a href= "#dfn-actions" class="internalDFN" data-link-type= "dfn">
Action
</a>.
<del class="diff-old">It
is
not
used
for
retrieve
requests
and
event
requests,
only
for
Property
update
and
Action
invocation
requests.
5.2.1
The
RequestType
</del>
</p>
</section>
<section id="the-unregister-method">
<h3 id="x5-4-the-unregister-method">
<del class="diff-old">enumeration
&lt;span class="idlEnum" id="idl-def-requesttype"
data-idl="" data-title="RequestType"&gt;enum &lt;span class=
"idlEnumID"&gt;&lt;a data-lt="RequestType" href="#dom-requesttype" class=
"internalDFN" data-link-type="dfn" data-for=
""&gt; {
    &lt;a href="#dom-requesttype-property" class=
"idlEnumItem"&gt;"property",
    &lt;a href="#dom-requesttype-action" class=
"idlEnumItem"&gt;"action",
    &lt;a href="#dom-requesttype-event" class=
"idlEnumItem"&gt;"event",
    
};
</del>
<span class="secno">
<ins class="diff-chg">5.4
</ins>
</span>
The
<del class="diff-old">value
"
</del>
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-unregister" data-idl="" data-title="unregister()" data-lt="unregister()|unregister">
<code>
<del class="diff-old">property
</del>
<ins class="diff-chg">unregister()
</ins>
</code>
</dfn>
<del class="diff-old">"
represents
requests
to
retrieve
or
update
</del>
<ins class="diff-chg">method
</ins></h3><p><ins class="diff-chg">
If
</ins>
a
<del class="diff-old">Property
.
The
value
"
action
"
represents
requests
to
invoke
an
Action
.
The
value
"
event
"
represents
requests
to
emit
an
event.
The
value
"
</del>
<code>
<del class="diff-old">td
</del>
<ins class="diff-chg">directory
</ins>
</code>
<del class="diff-old">"
represents
requests
</del>
<ins class="diff-chg">argument
is
given,
make
a
request
</ins>
to
<del class="diff-old">change
</del>
<ins class="diff-chg">unregister
</ins>
the
<a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn">
Thing
Description
<del class="diff-old">,
i.e.
to
add,
remove
or
modify
properties,
Actions
</del>
</a>
<del class="diff-old">or
Events
.
Editor's
note
This
functionality
is
here
for
</del>
<ins class="diff-chg">with
</ins>
the
<del class="diff-old">sake
of
completeness
for
future
versions
of
</del>
<ins class="diff-chg">given
WoT
repository
by
invoking
its
</ins><code><ins class="diff-chg">
unregister
</ins></code><a href="#dfn-actions" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Action
</ins></a>.<ins class="diff-chg">
Then,
and
in
</ins>
the
<del class="diff-old">API.
Currently
there
is
</del>
<ins class="diff-chg">case
</ins>
no
<del class="diff-old">corresponding
functionality
at
</del>
<ins class="diff-chg">arguments
were
provided
to
this
function,
stop
</ins>
the
<del class="diff-old">ConsumedThing
</del>
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
<ins class="diff-chg">Thing
</ins>
</a>
<del class="diff-old">level
</del>
and
<del class="diff-old">it
is
not
guaranteed
that
a
</del>
<ins class="diff-chg">remove
the
</ins><a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
<del class="diff-old">could
be
remotely
changed
by
scripting.
</del>
</a>.
</p>
</section>
<section id="the-emitevent-method">
<h3 id="x5-5-the-emitevent-method">
<del class="diff-old">5.2.2
</del>
<span class="secno">
<ins class="diff-chg">5.5
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-emitevent" data-idl="" data-title="emitEvent()" data-lt="emitevent()|emitEvent">
<code>
<del class="diff-old">respond()
</del>
<ins class="diff-chg">emitEvent()
</ins>
</code>
</dfn>
method
</h3>
<p>
<del class="diff-old">Sends
a
positive
response
to
</del>
<ins class="diff-chg">Emits
an
the
event
initialized
with
the
event
name
specified
by
</ins>
the
<code>
<del class="diff-old">Request
</del>
<ins class="diff-chg">eventName
</ins>
</code>
<del class="diff-old">based
on
the
Protocol
Bindings
</del>
<ins class="diff-chg">argument
</ins>
and
<del class="diff-old">includes
the
</del>
data
specified
by
the
<del class="diff-old">data
</del>
<code>
<ins class="diff-chg">payload
</ins></code>
argument.
</p>
</section>
<section data-dfn-for="DataSchema" id="the-dataschema-type">
<h3 id="x5-6-the-dataschema-type">
<del class="diff-old">5.2.3
</del>
<span class="secno">
<ins class="diff-chg">5.6
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-dataschema" data-idl="" data-title="DataSchema">
<code>
<del class="diff-old">respondWithError()
</del>
<ins class="diff-chg">DataSchema
</ins>
</code>
</dfn>
<del class="diff-old">method
Sends
a
negative
response
to
the
</del>
<ins class="diff-chg">type
</ins></h3><div><pre class="def idl"><span class="idlTypedef" id=<ins class="diff-chg">
"idl-def-dataschema" data-idl="" data-title=
"DataSchema">typedef <span class="idlTypedefType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlTypedefID"><a data-no-default=""
data-link-for="" data-lt="" href="#dom-dataschema" class=
"internalDFN" data-link-type=
"dfn">
</ins>
<code>
<del class="diff-old">Request
</del>
<ins class="diff-chg">DataSchema
</ins>
</code>
</a>
<del class="diff-old">based
on
the
Protocol
Bindings
and
includes
the
error
specified
by
the
error
argument.
</del>
<del class="diff-old">5.3
</del>
</span>
<ins class="diff-new">;
</ins></span></pre></div><p>
The
<a href="#dom-dataschema" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">RequestHandler
</del>
<ins class="diff-chg">DataSchema
</ins>
</code>
<del class="diff-old">callback
Callback
function
for
handling
interaction
requests.
Receives
an
argument
request
of
</del>
</a>
type
<ins class="diff-chg">represents
a
data
type
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20180405/#dataschema"><ins class="diff-chg">
specified
</ins></a><ins class="diff-chg">
in
the
</ins><a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
Description
</ins></a><ins class="diff-chg">
in
a
serialized
form.
</ins></p><div class="ednote"><div role="heading" class="ednote-title marker" id="h-ednote-8" aria-level="4">
<span>
<ins class="diff-chg">Editor's
note
</ins></span></div><p class=""><a href="#dom-dataschema" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">Request
</del>
<ins class="diff-chg">DataSchema
</ins>
</code>
</a>
<del class="diff-old">and
should
return
an
object
or
value
that
</del>
is
<del class="diff-old">used
by
Protocol
Bindings
to
reply
to
the
request.
The
returned
</del>
<ins class="diff-chg">under
development,
currently
it
can
denote
any
</ins>
type
<del class="diff-old">is
defined
</del>
<ins class="diff-chg">supported
</ins>
by
the
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
</a>
<ins class="diff-new">and
the
</ins><a href= "#dfn-wot-runtime" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
WoT
Runtime
</ins>
</a>.
</p>
</div>
</section>
<section id="the-addproperty-method">
<h3 id="x5-7-the-addproperty-method">
<del class="diff-old">5.4
</del>
<span class="secno">
<ins class="diff-chg">5.7
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-addproperty" data-idl="" data-title= "addProperty()" data-lt= "addproperty()|addProperty">
<code>
addProperty()
</code>
</dfn>
method
</h3>
<p>
Adds
a
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
defined
by
the
argument
and
updates
the
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
</a>.
<ins class="diff-new">Throws
on
error.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</ins>
</p>
<section data-dfn-for="ThingProperty" data-link-for="ThingProperty" id="the-thingproperty-dictionary">
<h4 id="x5-7-1-the-thingproperty-dictionary">
<span class= "secno">
<del class="diff-old">5.4.1
</del>
<ins class="diff-chg">5.7.1
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-thingproperty" data-idl="" data-title= "ThingProperty">
<code>
<del class="diff-old">ThingPropertyInit
</del>
<ins class="diff-chg">ThingProperty
</ins>
</code>
</dfn>
dictionary
</h4>
<div>
<pre class="def idl"><span class="idlDictionary" id=
<del class="diff-old">"idl-def-thingpropertyinit" data-idl="" data-title=
"ThingPropertyInit"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-lt="ThingPropertyInit" href=
"#dom-thingpropertyinit" class="internalDFN" data-link-type="dfn"
data-for=""&gt; {
&lt;span class="idlMember" id="idl-def-thingpropertyinit-name"
data-idl="" data-title="name" data-dfn-for=
"thingpropertyinit"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-lt="name"
href="#dom-thingpropertyinit-name" class="internalDFN"
data-link-type="dfn" data-for=
"ThingPropertyInit"&gt;
&lt;span class="idlMember" id="idl-def-thingpropertyinit-configurable"
data-idl="" data-title="configurable" data-dfn-for=
"thingpropertyinit"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-boolean"&gt;boolean&lt;a data-lt="configurable"
href="#dom-thingpropertyinit-configurable" class="internalDFN"
data-link-type="dfn" data-for=
"ThingPropertyInit"&gt;
&lt;span class="idlMember" id="idl-def-thingpropertyinit-enumerable"
data-idl="" data-title="enumerable" data-dfn-for=
"thingpropertyinit"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-boolean"&gt;boolean&lt;a data-lt="enumerable"
href="#dom-thingpropertyinit-enumerable" class="internalDFN"
data-link-type="dfn" data-for=
"ThingPropertyInit"&gt;
&lt;span class="idlMember" id="idl-def-thingpropertyinit-writable"
</del>
<ins class="diff-chg">"idl-def-thingproperty" data-idl="" data-title=
"ThingProperty">dictionary <span class=
"idlDictionaryID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingproperty" class="internalDFN" data-link-type=
"dfn"><code>ThingProperty</code></a></span> : <span class=
"idlSuperclass"><a href="#dom-semanticannotations" class=
"internalDFN" data-link-type=
"dfn"><code>SemanticAnnotations</code></a></span> {
</ins><span class="idlMember" id="idl-def-thingproperty-name" data-idl=""<ins class="diff-chg">
data-title="name" data-dfn-for=
"thingproperty">    required <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span>  <span class="idlMemberName"><a data-no-default=""
data-link-for="thingproperty" data-lt="" href=
"#dom-thingproperty-name" class="internalDFN" data-link-type=
"dfn"><code>name</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-thingproperty-schema" data-idl=<ins class="diff-chg">
"" data-title="schema" data-dfn-for=
"thingproperty">    required <span class="idlMemberType"><a href=
"#dom-dataschema" class="internalDFN" data-link-type=
"dfn"><code>DataSchema</code></a></span> <span class=
"idlMemberName"><a data-no-default="" data-link-for="thingproperty"
data-lt="" href="#dom-thingproperty-schema" class="internalDFN"
data-link-type="dfn"><code>schema</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-thingproperty-value" data-idl=<ins class="diff-chg">
"" data-title="value" data-dfn-for=
"thingproperty">             <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span>        <span class="idlMemberName"><a data-no-default=""
data-link-for="thingproperty" data-lt="" href=
"#dom-thingproperty-value" class="internalDFN" data-link-type=
"dfn"><code>value</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-thingproperty-writable"
data-idl="" data-title="writable" data-dfn-for=
<del class="diff-old">"thingpropertyinit"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-boolean"&gt;boolean&lt;a data-lt="writable"
href="#dom-thingpropertyinit-writable" class="internalDFN"
data-link-type="dfn" data-for=
"ThingPropertyInit"&gt; = &lt;span class=
"idlMemberValue"&gt;true
&lt;span class="idlMember" id=
"idl-def-thingpropertyinit-semantictypes" data-idl="" data-title=
"semanticTypes" data-dfn-for="thingpropertyinit"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-sequence"&gt;sequence&lt;&lt;a href="#dom-semantictype"
class="internalDFN" data-link-type=
"dfn"&gt; &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="semanticTypes" href=
"#dom-thingpropertyinit-semantictypes" class="internalDFN"
data-link-type="dfn" data-for=
"ThingPropertyInit"&gt;
&lt;span class="idlMember" id="idl-def-thingpropertyinit-description"
data-idl="" data-title="description" data-dfn-for=
"thingpropertyinit"&gt;    &lt;a href=
"#dom-thingdescription" class="internalDFN" data-link-type=
"dfn"&gt;       &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="description" href=
"#dom-thingpropertyinit-description" class="internalDFN"
data-link-type="dfn" data-for=
"ThingPropertyInit"&gt;
&lt;span class="idlMember" id="idl-def-thingpropertyinit-value"
data-idl="" data-title="value" data-dfn-for=
"thingpropertyinit"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-any"&gt;any&lt;a data-lt="value"
href="#dom-thingpropertyinit-value" class="internalDFN"
data-link-type="dfn" data-for=
"ThingPropertyInit"&gt;
</del>
<ins class="diff-chg">"thingproperty">             <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span>    <span class="idlMemberName"><a data-no-default=""
data-link-for="thingproperty" data-lt="" href=
"#dom-thingproperty-writable" class="internalDFN" data-link-type=
"dfn"><code>writable</code></a></span> = <span class=
"idlMemberValue">false</span>;</span>
</ins><span class="idlMember" id="idl-def-thingproperty-observable"<ins class="diff-chg">
data-idl="" data-title="observable" data-dfn-for=
"thingproperty">             <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span>    <span class="idlMemberName"><a data-no-default=""
data-link-for="thingproperty" data-lt="" href=
"#dom-thingproperty-observable" class="internalDFN" data-link-type=
"dfn"><code>observable</code></a></span> = <span class=
"idlMemberValue">false</span>;</span>
</ins>
};
</span>
</pre>
</div>
<p>
Represents
the
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
<a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>
description.
</p>
<ul>
<li>
The
<dfn data-dfn-for="thingproperty" data-dfn-type="dfn" id= "dom-thingproperty-name" data-idl="" data-title= "name">
<code>
name
</code>
</dfn>
attribute
represents
the
name
of
the
<a href="#dfn-properties" class="internalDFN" data-link-type= "dfn">
Property
</a>.
</li>
<li>
The
<dfn data-dfn-for="thingproperty" data-dfn-type="dfn" id= "dom-thingproperty-schema" data-idl="" data-title= "schema">
<code>
<del class="diff-old">value
</del>
<ins class="diff-chg">schema
</ins>
</code>
</dfn>
attribute
represents
the
<del class="diff-old">value
of
</del>
<ins class="diff-chg">data
type
for
</ins>
the
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
<ins class="diff-new">described
by
</ins><a href= "#dom-dataschema" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
DataSchema
</ins></code>
</a>.
</li>
<li>
The
<dfn data-dfn-for="thingproperty" data-dfn-type="dfn" id= "dom-thingproperty-value" data-idl="" data-title= "value">
<code>
<del class="diff-old">configurable
</del>
<ins class="diff-chg">value
</ins>
</code>
</dfn>
attribute
<del class="diff-old">defines
whether
the
Property
can
be
deleted
from
</del>
<ins class="diff-chg">represents
</ins>
the
<del class="diff-old">object
and
whether
its
properties
can
be
changed.
The
default
</del>
value
<del class="diff-old">is
false
.
</del>
<ins class="diff-chg">of
the
</ins><a href="#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Property
</ins></a>.
</li>
<li>
The
<dfn data-dfn-for="thingproperty" data-dfn-type="dfn" id= "dom-thingproperty-writable" data-idl="" data-title= "writable">
<code>
<del class="diff-old">enumerable
</del>
<ins class="diff-chg">writable
</ins>
</code>
</dfn>
attribute
defines
whether
the
<a href="#dfn-properties" class="internalDFN" data-link-type= "dfn">
Property
</a>
can
be
<del class="diff-old">listed
and
iterated.
</del>
<ins class="diff-chg">updated.
</ins>
The
default
value
is
<code>
<del class="diff-old">true
</del>
<ins class="diff-chg">false
</ins>
</code>.
</li>
<li>
The
<dfn data-dfn-for="thingproperty" data-dfn-type="dfn" id= "dom-thingproperty-observable" data-idl="" data-title= "observable">
<code>
<del class="diff-old">writable
</del>
<ins class="diff-chg">observable
</ins>
</code>
</dfn>
attribute
defines
whether
the
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
<ins class="diff-new">changes
</ins>
can
be
<del class="diff-old">updated.
</del>
<ins class="diff-chg">observed
by
an
external
client.
</ins>
The
default
value
is
<code>
<del class="diff-old">true
</del>
<ins class="diff-chg">false
</ins>
</code>.
</li>
<del class="diff-old">The
semanticTypes
attribute
represents
a
list
of
semantic
type
annotations
(e.g.
labels,
classifications
etc)
relevant
to
the
Property
,
represented
as
SemanticType
dictionaries.
The
description
attribute
represents
the
Property
description
to
be
added
to
the
Thing
Description
.
5.4.2
The
SemanticType
dictionary
&lt;span class="idlDictionary" id=
"idl-def-semantictype" data-idl="" data-title=
"SemanticType"&gt;dictionary &lt;a data-lt=
"SemanticType" href="#dom-semantictype" class="internalDFN"
data-link-type="dfn" data-for=
""&gt; {
&lt;span class="idlMember" id="idl-def-semantictype-name" data-idl=""
data-title="name" data-dfn-for="semantictype"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-lt="name"
href="#dom-semantictype-name" class="internalDFN" data-link-type=
"dfn" data-for="SemanticType"&gt;
&lt;span class="idlMember" id="idl-def-semantictype-context" data-idl=
"" data-title="context" data-dfn-for=
"semantictype"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-USVString"&gt;USVString&lt;a data-lt="context"
href="#dom-semantictype-context" class="internalDFN"
data-link-type="dfn" data-for=
"SemanticType"&gt;
};
Represents
a
semantic
type
annotation,
containing
a
name
and
a
context.
The
name
attribute
represents
the
name
of
the
semantic
type
in
the
given
context.
The
context
attribute
represents
an
URL
link
to
the
context
of
the
semantic
classification.
</del>
</ul>
<del class="diff-old">Editor's
note
Semantic
type
examples
to
be
added.
</del>
</section>
</section>
<section id="the-removeproperty-method">
<h3 id="x5-8-the-removeproperty-method">
<span class= "secno">
<del class="diff-old">5.5
</del>
<ins class="diff-chg">5.8
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id="dom-exposedthing-removeproperty" data-idl= "" data-title="removeProperty()" data-lt= "removeproperty()|removeProperty">
<code>
removeProperty()
</code>
</dfn>
method
</h3>
<p>
Removes
the
<a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
specified
by
the
<code>
name
</code>
<del class="diff-old">argument,
</del>
<ins class="diff-chg">argument
and
</ins>
updates
the
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
<del class="diff-old">and
returns
</del>
</a>.
<ins class="diff-chg">Throws
on
error.
Returns
a
reference
to
</ins>
the
<del class="diff-old">object.
</del>
<ins class="diff-chg">same
object
for
supporting
chaining.
</ins>
</p>
</section>
<section id="the-addaction-method">
<h3 id="x5-9-the-addaction-method">
<span class="secno">
<del class="diff-old">5.6
</del>
<ins class="diff-chg">5.9
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-addaction" data-idl="" data-title="addAction()" data-lt="addaction()|addAction">
<code>
addAction()
</code>
</dfn>
method
</h3>
<p>
Adds
an
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Action
</a>
to
the
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
</a>
object
as
defined
by
the
<code>
action
</code>
argument
of
type
<a href="#dom-thingaction" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">ThingActionInit
</del>
<ins class="diff-chg">ThingAction
</ins>
</code>
</a>
and
updates
the
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
</a>.
<ins class="diff-new">Throws
on
error.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</ins>
</p>
<section data-dfn-for="ThingAction" id= "the-thingaction-dictionary">
<h4 id="x5-9-1-the-thingaction-dictionary">
<span class= "secno">
<del class="diff-old">5.6.1
</del>
<ins class="diff-chg">5.9.1
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-thingaction" data-idl="" data-title= "ThingAction">
<code>
<del class="diff-old">ThingActionInit
</del>
<ins class="diff-chg">ThingAction
</ins>
</code>
</dfn>
dictionary
</h4>
<div>
<pre class="def idl"><span class="idlDictionary" id=
<del class="diff-old">"idl-def-thingactioninit" data-idl="" data-title=
"ThingActionInit"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-lt="ThingActionInit" href=
"#dom-thingactioninit" class="internalDFN" data-link-type="dfn"
data-for=""&gt; {
&lt;span class="idlMember" id="idl-def-thingactioninit-name" data-idl=
"" data-title="name" data-dfn-for=
"thingactioninit"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-lt="name"
href="#dom-thingactioninit-name" class="internalDFN"
data-link-type="dfn" data-for=
"ThingActionInit"&gt;
&lt;span class="idlMember" id=
"idl-def-thingactioninit-inputdatadescription" data-idl=""
data-title="inputDataDescription" data-dfn-for=
"thingactioninit"&gt;    &lt;a href=
"#dom-thingdescription" class="internalDFN" data-link-type=
"dfn"&gt;       &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="inputDataDescription" href=
"#dom-thingactioninit-inputdatadescription" class="internalDFN"
data-link-type="dfn" data-for=
"ThingActionInit"&gt;
&lt;span class="idlMember" id=
"idl-def-thingactioninit-outputdatadescription" data-idl=""
data-title="outputDataDescription" data-dfn-for=
"thingactioninit"&gt;    &lt;a href=
"#dom-thingdescription" class="internalDFN" data-link-type=
"dfn"&gt;       &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="outputDataDescription" href=
"#dom-thingactioninit-outputdatadescription" class="internalDFN"
data-link-type="dfn" data-for=
"ThingActionInit"&gt;
&lt;span class="idlMember" id="idl-def-thingactioninit-semantictypes"
data-idl="" data-title="semanticTypes" data-dfn-for=
"thingactioninit"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-sequence"&gt;sequence&lt;&lt;a href="#dom-semantictype"
</del>
<ins class="diff-chg">"idl-def-thingaction" data-idl="" data-title=
"ThingAction">dictionary <span class=
"idlDictionaryID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingaction" class="internalDFN" data-link-type=
"dfn"><code>ThingAction</code></a></span> : <span class=
"idlSuperclass"><a href="#dom-semanticannotations" class=
"internalDFN" data-link-type=
"dfn"><code>SemanticAnnotations</code></a></span> {
</ins><span class="idlMember" id="idl-def-thingaction-name" data-idl=""<ins class="diff-chg">
data-title="name" data-dfn-for=
"thingaction">    required <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span>  <span class="idlMemberName"><a data-no-default=""
data-link-for="thingaction" data-lt="" href="#dom-thingaction-name"
</ins>
class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt; &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="semanticTypes" href=
"#dom-thingactioninit-semantictypes" class="internalDFN"
data-link-type="dfn" data-for=
"ThingActionInit"&gt;
&lt;span class="idlMember" id="idl-def-thingactioninit-action"
data-idl="" data-title="action" data-dfn-for=
"thingactioninit"&gt;    &lt;span class=
"idlMemberType"&gt;Function               &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="action" href=
"#dom-thingactioninit-action" class="internalDFN" data-link-type=
"dfn" data-for=
"ThingActionInit"&gt;
</del>
<ins class="diff-chg">"dfn"><code>name</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-thingaction-inputschema"<ins class="diff-chg">
data-idl="" data-title="inputSchema" data-dfn-for=
"thingaction">             <span class="idlMemberType"><a href=
"#dom-dataschema" class="internalDFN" data-link-type=
"dfn"><code>DataSchema</code></a></span> <span class=
"idlMemberName"><a data-no-default="" data-link-for="thingaction"
data-lt="" href="#dom-thingaction-inputschema" class="internalDFN"
data-link-type="dfn"><code>inputSchema</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-thingaction-outputschema"<ins class="diff-chg">
data-idl="" data-title="outputSchema" data-dfn-for=
"thingaction">             <span class="idlMemberType"><a href=
"#dom-dataschema" class="internalDFN" data-link-type=
"dfn"><code>DataSchema</code></a></span> <span class=
"idlMemberName"><a data-no-default="" data-link-for="thingaction"
data-lt="" href="#dom-thingaction-outputschema" class="internalDFN"
data-link-type="dfn"><code>outputSchema</code></a></span>;</span>
</ins>
};
</span>
</pre>
</div>
<p>
The
<a href="#dom-thingaction" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">ThingActionInit
</del>
<ins class="diff-chg">ThingAction
</ins>
</code>
</a>
dictionary
describes
the
arguments
and
the
return
value.
</p>
<ul>
<li>
The
<dfn data-dfn-for="thingaction" data-dfn-type="dfn" id= "dom-thingaction-name" data-idl="" data-title= "name">
<code>
name
</code>
</dfn>
attribute
provides
the
<a href= "#dfn-actions" class="internalDFN" data-link-type="dfn">
Action
</a>
name.
</li>
<li>
The
<del class="diff-old">action
attribute
provides
a
function
that
defines
the
Action
.
The
</del>
<dfn data-dfn-for="thingaction" data-dfn-type="dfn" id= "dom-thingaction-inputschema" data-idl="" data-title= "inputSchema">
<code>
<del class="diff-old">inputDataDescription
</del>
<ins class="diff-chg">inputSchema
</ins>
</code>
</dfn>
attribute
provides
the
description
of
the
input
<ins class="diff-new">arguments
(argument
list
is
represented
by
an
object).
If
missing,
it
means
the
action
does
not
accept
</ins>
arguments.
</li>
<li>
The
<dfn data-dfn-for="thingaction" data-dfn-type="dfn" id= "dom-thingaction-outputschema" data-idl="" data-title= "outputSchema">
<code>
<del class="diff-old">outputDataDescription
</del>
<ins class="diff-chg">outputSchema
</ins>
</code>
</dfn>
attribute
provides
the
description
of
the
returned
data.
<del class="diff-old">The
semanticTypes
attribute
provides
a
list
of
semantic
type
annotations
(e.g.
labels,
classifications
etc)
relevant
to
</del>
<ins class="diff-chg">If
missing,
it
means
</ins>
the
<del class="diff-old">Action
,
represented
as
SemanticType
dictionaries.
</del>
<ins class="diff-chg">action
does
not
return
data.
</ins>
</li>
</ul>
</section>
</section>
<section id="the-removeaction-method">
<h3 id="x5-10-the-removeaction-method">
<span class= "secno">
<del class="diff-old">5.7
</del>
<ins class="diff-chg">5.10
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id="dom-exposedthing-removeaction" data-idl="" data-title="removeAction()" data-lt= "removeaction()|removeAction">
<code>
removeAction()
</code>
</dfn>
method
</h3>
<p>
Removes
the
<a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Action
</a>
specified
by
the
<code>
name
</code>
<del class="diff-old">argument,
</del>
<ins class="diff-chg">argument
and
</ins>
updates
the
<a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn">
Thing
Description
<del class="diff-old">and
returns
</del>
</a>.
<ins class="diff-chg">Throws
on
error.
Returns
a
reference
to
</ins>
the
<del class="diff-old">object.
</del>
<ins class="diff-chg">same
object
for
supporting
chaining.
</ins>
</p>
</section>
<section id="the-addevent-method">
<h3 id="x5-11-the-addevent-method">
<span class="secno">
<del class="diff-old">5.8
</del>
<ins class="diff-chg">5.11
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id= "dom-exposedthing-addevent" data-idl="" data-title="addEvent()" data-lt="addevent()|addEvent">
<code>
addEvent()
</code>
</dfn>
method
</h3>
<p>
Adds
an
event
to
the
<a href="#dfn-things" class="internalDFN" data-link-type="dfn">
Thing
</a>
object
as
defined
by
the
<code>
event
</code>
argument
of
type
<a href="#dom-thingevent" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">ThingEventInit
</del>
<ins class="diff-chg">ThingEvent
</ins>
</code>
</a>
and
updates
the
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
Description
</a>.
<ins class="diff-new">Throws
on
error.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</ins>
</p>
<section data-dfn-for="ThingEvent" id="the-thingevent-dictionary">
<h4 id="x5-11-1-the-thingevent-dictionary">
<span class= "secno">
<del class="diff-old">5.8.1
</del>
<ins class="diff-chg">5.11.1
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-thingevent" data-idl="" data-title= "ThingEvent">
<code>
<del class="diff-old">ThingEventInit
</del>
<ins class="diff-chg">ThingEvent
</ins>
</code>
</dfn>
dictionary
</h4>
<div>
<pre class="def idl"><span class="idlDictionary" id=
<del class="diff-old">"idl-def-thingeventinit" data-idl="" data-title=
"ThingEventInit"&gt;dictionary &lt;span class=
"idlDictionaryID"&gt;&lt;a data-lt="ThingEventInit" href=
"#dom-thingeventinit" class="internalDFN" data-link-type="dfn"
data-for=""&gt; {
&lt;span class="idlMember" id="idl-def-thingeventinit-name" data-idl=
"" data-title="name" data-dfn-for="thingeventinit"&gt;    &lt;span class=
"idlMemberType"&gt;&lt;a href=
"https://heycam.github.io/webidl/#idl-DOMString"&gt;DOMString&lt;a data-lt="name"
href="#dom-thingeventinit-name" class="internalDFN" data-link-type=
"dfn" data-for=
"ThingEventInit"&gt;
&lt;span class="idlMember" id="idl-def-thingeventinit-semantictypes"
data-idl="" data-title="semanticTypes" data-dfn-for=
"thingeventinit"&gt;    &lt;a href=
"https://heycam.github.io/webidl/#idl-sequence"&gt;sequence&lt;&lt;a href="#dom-semantictype"
</del>
<ins class="diff-chg">"idl-def-thingevent" data-idl="" data-title=
"ThingEvent">dictionary <span class=
"idlDictionaryID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-thingevent" class="internalDFN" data-link-type=
"dfn"><code>ThingEvent</code></a></span> : <span class=
"idlSuperclass"><a href="#dom-semanticannotations" class=
"internalDFN" data-link-type=
"dfn"><code>SemanticAnnotations</code></a></span> {
</ins><span class="idlMember" id="idl-def-thingevent-name" data-idl=""<ins class="diff-chg">
data-title="name" data-dfn-for=
"thingevent">    required <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span>  <span class="idlMemberName"><a data-no-default=""
data-link-for="thingevent" data-lt="" href="#dom-thingevent-name"
</ins>
class="internalDFN" data-link-type=
<del class="diff-old">"dfn"&gt; &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="semanticTypes" href=
"#dom-thingeventinit-semantictypes" class="internalDFN"
data-link-type="dfn" data-for=
"ThingEventInit"&gt;
&lt;span class="idlMember" id="idl-def-thingeventinit-datadescription"
data-idl="" data-title="dataDescription" data-dfn-for=
"thingeventinit"&gt;    &lt;a href=
"#dom-thingdescription" class="internalDFN" data-link-type=
"dfn"&gt;       &lt;span class=
"idlMemberName"&gt;&lt;a data-lt="dataDescription" href=
"#dom-thingeventinit-datadescription" class="internalDFN"
data-link-type="dfn" data-for=
"ThingEventInit"&gt;
</del>
<ins class="diff-chg">"dfn"><code>name</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-thingevent-schema" data-idl=""<ins class="diff-chg">
data-title="schema" data-dfn-for=
"thingevent">             <span class="idlMemberType"><a href=
"#dom-dataschema" class="internalDFN" data-link-type=
"dfn"><code>DataSchema</code></a></span> <span class=
"idlMemberName"><a data-no-default="" data-link-for="thingevent"
data-lt="" href="#dom-thingevent-schema" class="internalDFN"
data-link-type="dfn"><code>schema</code></a></span>;</span>
</ins>
};
</span>
</pre>
</div>
<ul>
<li>
The
<dfn data-dfn-for="thingevent" data-dfn-type="dfn" id= "dom-thingevent-name" data-idl="" data-title= "name">
<code>
name
</code>
</dfn>
attribute
represents
the
event
name.
</li>
<li>
The
<del class="diff-old">semanticTypes
attribute
represent
a
list
of
semantic
type
annotations
attached
to
the
event.
The
</del>
<dfn data-dfn-for="thingevent" data-dfn-type="dfn" id= "dom-thingevent-schema" data-idl="" data-title= "schema">
<code>
<del class="diff-old">dataDescription
</del>
<ins class="diff-chg">schema
</ins>
</code>
</dfn>
attribute
represents
the
<del class="diff-old">description
</del>
<ins class="diff-chg">type
</ins>
of
the
data
that
is
attached
to
the
event.
<ins class="diff-new">If
missing,
it
means
the
event
does
not
carry
data.
</ins>
</li>
</ul>
</section>
</section>
<section id="the-removeevent-method">
<h3 id="x5-12-the-removeevent-method">
<span class= "secno">
<del class="diff-old">5.9
</del>
<ins class="diff-chg">5.12
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id="dom-exposedthing-removeevent" data-idl="" data-title="removeEvent()" data-lt= "removeevent()|removeEvent">
<code>
removeEvent()
</code>
</dfn>
method
</h3>
<p>
Removes
the
event
specified
by
the
<code>
name
</code>
<del class="diff-old">argument,
</del>
<ins class="diff-chg">argument
and
</ins>
updates
the
<a href="#dfn-thing-descriptions" class= "internalDFN" data-link-type="dfn">
Thing
Description
<del class="diff-old">and
returns
</del>
</a>.
<ins class="diff-chg">Returns
a
reference
to
</ins>
the
<del class="diff-old">object.
</del>
<ins class="diff-chg">same
object
for
supporting
chaining.
</ins>
</p>
</section>
<section data-dfn-for="PropertyReadHandler" id= "the-propertyreadhandler-callback">
<h3 id="x5-13-the-propertyreadhandler-callback">
<span class= "secno">
<del class="diff-old">5.10
</del>
<ins class="diff-chg">5.13
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-propertyreadhandler" data-idl="" data-title= "PropertyReadHandler">
<code>
<del class="diff-old">onRetrieveProperty()
</del>
<ins class="diff-chg">PropertyReadHandler
</ins>
</code>
</dfn>
<del class="diff-old">method
</del>
<ins class="diff-chg">callback
</ins>
</h3>
<p>
<del class="diff-old">Registers
the
handler
</del>
<ins class="diff-chg">A
</ins>
function
<del class="diff-old">for
</del>
<ins class="diff-chg">that
returns
a
Promise
and
resolves
it
with
the
value
of
the
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
</a>
<del class="diff-old">retrieve
requests
received
for
</del>
<ins class="diff-chg">matching
</ins>
the
<del class="diff-old">Thing
,
as
defined
by
</del>
<code>
<ins class="diff-chg">name
</ins></code><ins class="diff-chg">
argument
to
</ins>
the
<code>
<del class="diff-old">handler
</del>
<ins class="diff-chg">setPropertyReadHandler
</ins>
</code>
<ins class="diff-new">function,
or
rejects
with
an
error
if
the
</ins>
property
<del class="diff-old">of
type
</del>
<ins class="diff-chg">is
not
found
or
the
value
cannot
be
retrieved.
</ins></p></section><section data-dfn-for="PropertyWriteHandler" id= "the-propertywritehandler-callback"><h3 id="x5-14-the-propertywritehandler-callback">
<span class= "secno">
<ins class="diff-chg">5.14
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id="dom-propertywritehandler" data-idl="" data-title= "PropertyWriteHandler">
<code>
<del class="diff-old">RequestHandler
</del>
<ins class="diff-chg">PropertyWriteHandler
</ins>
</code>
</dfn>
<ins class="diff-chg">callback
</ins></h3><p><ins class="diff-chg">
A
function
called
with
</ins><code><ins class="diff-chg">
value
</ins>
</code>
<del class="diff-old">.
The
handler
will
receive
an
</del>
<ins class="diff-chg">as
</ins>
argument
<del class="diff-old">request
</del>
<ins class="diff-chg">that
returns
a
Promise
which
is
resolved
when
the
value
</ins>
of
<del class="diff-old">type
</del>
<ins class="diff-chg">the
</ins><a href= "#dfn-properties" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
matching
the
</ins>
<code>
<ins class="diff-chg">name
</ins></code><ins class="diff-chg">
argument
to
the
</ins>
<code>
<del class="diff-old">Request
</del>
<ins class="diff-chg">setPropertyReadHandler
</ins>
</code>
<ins class="diff-new">function
is
updated
with
</ins><code><ins class="diff-new">
value
</ins></code>,<ins class="diff-new">
or
rejects
with
an
error
if
the
property
is
not
found
or
the
value
cannot
be
updated.
</ins></p><div class="ednote"><div role="heading" class="ednote-title marker" id="h-ednote-9" aria-level="4">
<span>
<ins class="diff-chg">Editor's
note
</ins></span>
<del class="diff-old">where
at
least
request.name
</del>
</div>
<p class="">
<ins class="diff-chg">Note
that
this
function
</ins>
is
<del class="diff-old">defined
and
represents
</del>
<ins class="diff-chg">invoked
by
implementations
before
</ins>
the
<del class="diff-old">name
</del>
<ins class="diff-chg">property
is
updated,
so
the
code
in
this
callback
function
can
invoke
the
</ins><code><ins class="diff-chg">
readProperty()
</ins></code><ins class="diff-chg">
method
to
find
out
the
old
value
</ins>
of
the
<del class="diff-old">Property
</del>
<ins class="diff-chg">property,
if
needed.
Therefore
the
old
value
is
not
provided
</ins>
to
<del class="diff-old">be
retrieved.
</del>
<ins class="diff-chg">this
method.
</ins>
</p>
</div>
</section>
<section data-dfn-for="ActionHandler" id= "the-actionhandler-callback">
<h3 id="x5-15-the-actionhandler-callback">
<span class= "secno">
<del class="diff-old">5.11
</del>
<ins class="diff-chg">5.15
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-actionhandler" data-idl="" data-title= "ActionHandler">
<code>
<del class="diff-old">onUpdateProperty()
</del>
<ins class="diff-chg">ActionHandler
</ins>
</code>
</dfn>
<del class="diff-old">method
</del>
<ins class="diff-chg">callback
</ins>
</h3>
<p>
<del class="diff-old">Defines
the
handler
</del>
<ins class="diff-chg">A
</ins>
function
<del class="diff-old">for
Property
</del>
<ins class="diff-chg">called
with
a
</ins><code><ins class="diff-chg">
parameters
</ins></code><ins class="diff-chg">
dictionary
argument
assembled
by
the
</ins><a href="#dfn-wot-runtime" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
WoT
runtime
</ins>
</a>
<del class="diff-old">update
requests
received
for
</del>
<ins class="diff-chg">based
on
</ins>
the
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
<del class="diff-old">,
as
defined
by
</del>
<ins class="diff-chg">Description
</ins></a><ins class="diff-chg">
and
the
external
client
request.
It
returns
a
Promise
that
rejects
with
an
error
or
resolves
if
</ins>
the
<ins class="diff-new">action
is
successful
or
ongoing
(may
also
resolve
with
a
control
object
such
as
an
</ins><a href="#dom-observable" class= "internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">handler
</del>
<ins class="diff-chg">Observable
</ins>
</code>
<del class="diff-old">property
of
type
</del>
</a>
<ins class="diff-chg">for
actions
that
need
progress
notifications
or
that
can
be
canceled).
</ins></p></section><section id="the-setpropertyreadhandler-method"><h3 id="x5-16-the-setpropertyreadhandler-method"><span class= "secno"><ins class="diff-chg">
5.16
</ins></span><ins class="diff-chg">
The
</ins><dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id="dom-exposedthing-setpropertyreadhandler" data-idl="" data-title="setPropertyReadHandler()" data-lt= "setpropertyreadhandler()|setPropertyReadHandler">
<code>
<del class="diff-old">RequestHandler
</del>
<ins class="diff-chg">setPropertyReadHandler()
</ins>
</code>
</dfn>
<ins class="diff-chg">method
</ins></h3><p><ins class="diff-chg">
Takes
</ins><code><ins class="diff-chg">
name
</ins>
</code>
<del class="diff-old">.
The
handler
will
receive
an
</del>
<ins class="diff-chg">as
string
argument
and
</ins><code><ins class="diff-chg">
readHandler
</ins></code><ins class="diff-chg">
as
</ins>
argument
<del class="diff-old">request
</del>
of
type
<a href= "#dom-propertyreadhandler" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">Request
</del>
<ins class="diff-chg">PropertyReadHandler
</ins>
</code>
<del class="diff-old">where
request.name
defines
</del>
</a>.
<ins class="diff-chg">Sets
</ins>
the
<del class="diff-old">name
of
</del>
<ins class="diff-chg">handler
function
for
reading
</ins>
the
<ins class="diff-chg">specified
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn">
Property
</a>
<ins class="diff-new">matched
by
</ins><code><ins class="diff-new">
name
</ins></code>.<ins class="diff-new">
Throws
on
error.
Returns
a
reference
</ins>
to
<del class="diff-old">be
retrieved
</del>
<ins class="diff-chg">the
same
object
for
supporting
chaining.
</ins></p><p><ins class="diff-chg">
The
</ins><code><ins class="diff-chg">
readHandler
</ins></code><ins class="diff-chg">
callback
function
will
implement
reading
a
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins></a>
and
<del class="diff-old">request.data
defines
</del>
<em class="rfc2119" title= "SHOULD">
<ins class="diff-chg">SHOULD
</ins></em><ins class="diff-chg">
be
called
by
implementations
when
a
request
for
reading
a
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
is
received
from
</ins>
the
<del class="diff-old">new
value
of
</del>
<ins class="diff-chg">underlying
platform.
</ins></p><p><ins class="diff-chg">
There
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
be
at
most
one
handler
for
any
given
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins></a><ins class="diff-chg">
and
newly
added
handlers
replace
</ins>
the
<ins class="diff-chg">old
handlers.
If
no
handler
is
initialized
for
any
given
</ins><a href="#dfn-properties" class="internalDFN" data-link-type="dfn">
Property
<del class="diff-old">.
</del>
</a>,
<ins class="diff-chg">implementations
</ins><em class= "rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
implement
a
default
property
read
handler.
</ins>
</p>
</section>
<section id="the-setpropertywritehandler-method">
<h3 id="x5-17-the-setpropertywritehandler-method">
<span class= "secno">
<del class="diff-old">5.12
</del>
<ins class="diff-chg">5.17
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id="dom-exposedthing-setpropertywritehandler" data-idl="" data-title="setPropertyWriteHandler()" data-lt= "setpropertywritehandler()|setPropertyWriteHandler">
<code>
<del class="diff-old">onInvokeAction()
</del>
<ins class="diff-chg">setPropertyWriteHandler()
</ins>
</code>
</dfn>
method
</h3>
<p>
<del class="diff-old">Defines
the
handler
function
for
Action
invocation
requests
received
for
the
Thing
,
as
defined
by
the
</del>
<ins class="diff-chg">Takes
</ins>
<code>
<del class="diff-old">handler
</del>
<ins class="diff-chg">name
</ins>
</code>
<del class="diff-old">property
of
type
</del>
<ins class="diff-chg">as
string
argument
and
</ins>
<code>
<del class="diff-old">RequestHandler
</del>
<ins class="diff-chg">writeHandler
</ins>
</code>
<del class="diff-old">.
The
handler
will
receive
an
</del>
<ins class="diff-chg">as
</ins>
argument
<del class="diff-old">request
</del>
of
type
<a href= "#dom-propertywritehandler" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">Request
</del>
<ins class="diff-chg">PropertyWriteHandler
</ins>
</code>
<del class="diff-old">where
request.name
defines
</del>
</a>.
<ins class="diff-chg">Sets
</ins>
the
<del class="diff-old">name
of
</del>
<ins class="diff-chg">handler
function
for
writing
</ins>
the
<del class="diff-old">Action
</del>
<ins class="diff-chg">specified
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins>
</a>
<ins class="diff-new">matched
by
</ins><code><ins class="diff-new">
name
</ins></code>.<ins class="diff-new">
Throws
on
error.
Returns
a
reference
</ins>
to
<del class="diff-old">be
invoked
and
request.data
defines
</del>
the
<del class="diff-old">input
arguments
</del>
<ins class="diff-chg">same
object
</ins>
for
<del class="diff-old">the
Action
</del>
<ins class="diff-chg">supporting
chaining.
</ins></p><p><ins class="diff-chg">
There
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
be
at
most
one
write
handler
for
any
given
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins>
</a>
<del class="diff-old">as
defined
by
</del>
<ins class="diff-chg">and
newly
added
handlers
replace
</ins>
the
<del class="diff-old">Thing
Description
.
</del>
<ins class="diff-chg">old
handlers.
If
no
write
handler
is
initialized
for
any
given
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Property
</ins></a>,<ins class="diff-chg">
implementations
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
implement
default
property
update
and
notifying
observers
on
change.
</ins>
</p>
</section>
<section id="the-setactionhandler-method">
<h3 id="x5-18-the-setactionhandler-method">
<span class= "secno">
<del class="diff-old">5.13
</del>
<ins class="diff-chg">5.18
</ins>
</span>
The
<dfn data-dfn-for="exposedthing" data-dfn-type="dfn" id="dom-exposedthing-setactionhandler" data-idl="" data-title="setActionHandler()" data-lt= "setactionhandler()|setActionHandler">
<code>
<del class="diff-old">onObserve()
</del>
<ins class="diff-chg">setActionHandler()
</ins>
</code>
</dfn>
method
</h3>
<p>
<del class="diff-old">Defines
the
handler
function
for
observe
requests
received
for
the
Thing
,
</del>
<ins class="diff-chg">Takes
</ins><code><ins class="diff-chg">
name
</ins></code>
as
<del class="diff-old">defined
by
the
</del>
<ins class="diff-chg">string
argument
and
</ins>
<code>
<del class="diff-old">handler
</del>
<ins class="diff-chg">action
</ins>
</code>
<del class="diff-old">property
</del>
<ins class="diff-chg">as
argument
</ins>
of
type
<a href= "#dom-actionhandler" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">RequestHandler
</del>
<ins class="diff-chg">ActionHandler
</ins>
</code>
<del class="diff-old">.
The
</del>
</a>.
<ins class="diff-chg">Sets
the
</ins>
handler
<ins class="diff-new">function
for
the
specified
</ins><a href="#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-new">
Action
</ins></a><ins class="diff-new">
matched
by
</ins><code><ins class="diff-new">
name
</ins></code>.<ins class="diff-new">
Throws
on
error.
Returns
a
reference
to
the
same
object
for
supporting
chaining.
</ins></p><p><ins class="diff-new">
If
provided,
this
callback
function
</ins>
will
<del class="diff-old">receive
</del>
<ins class="diff-chg">implement
invoking
</ins>
an
<del class="diff-old">argument
</del>
<a href="#dfn-actions" class="internalDFN" data-link-type= "dfn">
<ins class="diff-chg">Action
</ins></a><ins class="diff-chg">
and
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
be
called
by
implementations
when
a
</ins>
request
<del class="diff-old">of
type
</del>
<ins class="diff-chg">for
invoking
a
</ins><a href= "#dfn-actions" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Action
</ins></a><ins class="diff-chg">
is
received
from
the
underlying
platform.
The
callback
will
receive
a
</ins>
<code>
<ins class="diff-new">parameters
</ins></code><ins class="diff-new">
dictionary
argument.
</ins></p><p><ins class="diff-new">
There
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
be
exactly
one
handler
for
any
given
</ins><a href="#dfn-actions" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
Action
</ins></a>.<ins class="diff-new">
If
no
handler
is
initialized
for
any
given
</ins><a href="#dfn-actions" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
Action
</ins></a>,<ins class="diff-new">
implementations
</ins><em class="rfc2119" title="SHOULD"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
return
error
if
the
action
is
invoked
by
any
client.
</ins></p></section><section id="examples-1"><h3 id="x5-19-examples">
<span class="secno">
<ins class="diff-chg">5.19
</ins></span><ins class="diff-chg">
Examples
</ins></h3><p><ins class="diff-chg">
Below
some
</ins><code><a href="#dom-exposedthing" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">Request
</del>
<ins class="diff-chg">ExposedThing
</ins>
</code>
</a>
</code>
<del class="diff-old">where
</del>
<ins class="diff-chg">interface
examples
are
given.
</ins>
</p>
<div class="example">
<div class="example-title marker">
<del class="diff-old">request.name
defines
the
name
of
the
Property
or
Action
or
event
</del>
<span>
<ins class="diff-chg">Example
7
</ins></span><span style="text-transform: none">:<ins class="diff-chg">
Create
a
new
blank
exposed
Thing
</ins></span></div><pre class="highlight hljs javascript" aria-busy="false">        <span class="hljs-keyword">try</span> {  <span class=<ins class="diff-chg">
"hljs-keyword">var</span> thing = WoT.produce({ <span class=
"hljs-attr">name</span>: <span class=
"hljs-string">"tempSensor"</span> });
</ins>  <span class="hljs-comment">// manually add Interactions</span><ins class="diff-chg">
  thing.addProperty({
</ins>    <span class="hljs-attr">name</span>: <span class=<ins class="diff-chg">
"hljs-string">"temperature"</span>,
</ins>    <span class="hljs-attr">value</span>: <span class=<ins class="diff-chg">
"hljs-number">0.0</span>,
</ins>    <span class="hljs-attr">schema</span>: <span class=<ins class="diff-chg">
"hljs-string">'{ "type": "number" }'</span>
</ins>    <span class=<ins class="diff-chg">
"hljs-comment">// use default values for the rest</span>
  }).addProperty({
</ins>    <span class="hljs-attr">name</span>: <span class=<ins class="diff-chg">
"hljs-string">"max"</span>,
</ins>    <span class="hljs-attr">value</span>: <span class=<ins class="diff-chg">
"hljs-number">0.0</span>,
</ins>    <span class="hljs-attr">schema</span>: <span class=<ins class="diff-chg">
"hljs-string">'{ "type": "number" }'</span>
</ins>    <span class=<ins class="diff-chg">
"hljs-comment">// use default values for the rest</span>
  }).addAction({
</ins>    <span class="hljs-attr">name</span>: <span class=<ins class="diff-chg">
"hljs-string">"reset"</span>,
</ins>    <span class="hljs-comment">// no input, no output</span><ins class="diff-chg">
  }).addEvent({
</ins>    <span class="hljs-attr">name</span>: <span class=<ins class="diff-chg">
"hljs-string">"onchange"</span>,
</ins>    <span class="hljs-attr">schema</span>: <span class=<ins class="diff-chg">
"hljs-string">'{ "type": "number" }'</span>
  });
</ins>  <span class="hljs-comment">// add server functionality</span><ins class="diff-chg">
  thing.setActionHandler(<span class=
"hljs-string">"reset"</span>, () =&gt; {
</ins>    <span class="hljs-built_in">console</span>.log(<span class=<ins class="diff-chg">
"hljs-string">"Resetting maximum"</span>);
    thing.writeProperty(<span class=
"hljs-string">"max"</span>, <span class="hljs-number">0.0</span>);
  });
  thing.start().then(<span class="hljs-function"><span class=
"hljs-params">()</span> =&gt;</span> {
      thing.register();
  });
</ins>  <span class="hljs-comment">// define Thing business logic</span><ins class="diff-chg">
  setInterval( <span class="hljs-keyword">async</span> () =&gt; {
</ins>    <span class="hljs-keyword">let</span> mock = <span class=<ins class="diff-chg">
"hljs-built_in">Math</span>.random()*<span class=
"hljs-number">100</span>;
    thing.writeProperty(<span class=
"hljs-string">"temperature"</span>, mock);
</ins>    <span class="hljs-keyword">let</span> old = <span class=<ins class="diff-chg">
"hljs-keyword">await</span> thing.readProperty(<span class=
"hljs-string">"max"</span>);
</ins>    <span class="hljs-keyword">if</span> (old &lt; mock) {<ins class="diff-chg">
      thing.writeProperty(<span class=
"hljs-string">"max"</span>, mock);
      thing.emitEvent(<span class="hljs-string">"onchange"</span>);
    }
  }, <span class="hljs-number">1000</span>);
} <span class="hljs-keyword">catch</span> (err) {
</ins>   <span class="hljs-built_in">console</span>.log(<span class=<ins class="diff-chg">
"hljs-string">"Error creating ExposedThing: "</span> + err);
}
</ins></pre></div><div class="example"><div class="example-title marker"><span><ins class="diff-chg">
Example
8
</ins></span><span style="text-transform: none">:<ins class="diff-chg">
Create
a
new
exposed
Thing
from
a
Thing
Description
</ins></span></div><pre class="highlight hljs javascript" aria-busy="false">        <span class=<ins class="diff-chg">
"hljs-keyword">let</span> thingDescription = <span class=
"hljs-string">'{ "@context": [ "https://w3c.github.io/wot/w3c-wot-td-context.jsonld", "https://w3c.github.io/wot/w3c-wot-common-context.jsonld" ], "@type": [ "Thing", "Sensor" ], "name": "mySensor", "geo:location": "testspace", "interaction": [ { "@type": [ "Property", "Temperature" ], "name": "prop1", "schema": { "type": "number" }, "saref:TemperatureUnit": "degree_Celsius" } ] }'</span>;
</ins><span class="hljs-keyword">try</span> {  <span class=<ins class="diff-chg">
"hljs-comment">// note that produce() fails if thingDescription contains error</span>
</ins>  <span class=<ins class="diff-chg">
"hljs-keyword">let</span> thing = WoT.produce(thingDescription);
</ins>  <span class=<ins class="diff-chg">
"hljs-comment">// Interactions were added from TD</span>
</ins>  <span class=<ins class="diff-chg">
"hljs-comment">// WoT adds generic handler for reading any property</span>
</ins>  <span class=<ins class="diff-chg">
"hljs-comment">// define a specific handler for one property</span>
</ins>  <span class="hljs-keyword">let</span> name = <span class=<ins class="diff-chg">
"hljs-string">"examplePropertyName"</span>;
  thing.setPropertyReadHandler(name, () =&gt; {
</ins>    <span class="hljs-built_in">console</span>.log(<span class=<ins class="diff-chg">
"hljs-string">"Handling read request for "</span> + name);
</ins>    <span class="hljs-keyword">return</span> <span class=<ins class="diff-chg">
"hljs-keyword">new</span> <span class=
"hljs-built_in">Promise</span>(<span class=
"hljs-function">(<span class=
"hljs-params">resolve, reject</span>) =&gt;</span> {
</ins>        <span class=<ins class="diff-chg">
"hljs-keyword">let</span> examplePropertyValue = <span class=
"hljs-number">5</span>;
        resolve(examplePropertyValue);
      },
      e =&gt; {
</ins>        <span class="hljs-built_in">console</span>.log(<span class=<ins class="diff-chg">
"hljs-string">"Error"</span>);
      });
  });
  thing.start();
} <span class="hljs-keyword">catch</span>(err) {
</ins>   <span class="hljs-built_in">console</span>.log(<span class=<ins class="diff-chg">
"hljs-string">"Error creating ExposedThing: "</span> + err);
}
</ins></pre></div><div class="example"><div class="example-title marker"><span><ins class="diff-chg">
Example
9
</ins></span><span style="text-transform: none">:<ins class="diff-chg">
Create
a
new
exposed
Thing
from
a
TD
URI
</ins></span></div><pre class="highlight hljs javascript" aria-busy="false">        <span class=<ins class="diff-chg">
"hljs-comment">// fetch an external TD, e.g., to set up a proxy for that Thing</span>
WoT.fetch(<span class=
"hljs-string">"http://myservice.org/mySensor/description"</span>).then(<span class="hljs-function"><span class="hljs-params">td</span> =&gt;</span> {
</ins>  <span class=<ins class="diff-chg">
"hljs-comment">// WoT.produce() ignores instance-specific metadata (security, form)</span>
</ins>  <span class="hljs-keyword">let</span> thing = WoT.produce(td);  <span class=<ins class="diff-chg">
"hljs-comment">// Interactions were added from TD</span>
</ins>  <span class="hljs-comment">// add server functionality</span>  <span class="hljs-comment">// ...</span><ins class="diff-chg">
});
</ins></pre></div></section></section><section class="informative" data-dfn-for="ConsumedThing" id= "experimental-extensions-to-the-consumedthing-interface"><h2 id="x6-experimental-extensions-to-the-consumedthing-interface"><span class="secno"><ins class="diff-chg">
6.
</ins></span><ins class="diff-chg">
Experimental
extensions
</ins>
to
<del class="diff-old">be
observed.
</del>
<ins class="diff-chg">the
</ins><strong><ins class="diff-chg">
ConsumedThing
</ins></strong><ins class="diff-chg">
interface
</ins></h2><p>
<del class="diff-old">request.options.observeType
</del>
<em>
<ins class="diff-chg">This
section
</ins>
is
<del class="diff-old">of
type
</del>
<ins class="diff-chg">non-normative.
</ins></em></p><p><ins class="diff-chg">
The
</ins><a href="#dom-thingdescription" class="internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">RequestType
</del>
<ins class="diff-chg">ThingDescription
</ins>
</code>
</a>
<del class="diff-old">and
defines
whether
a
Property
change
or
</del>
<ins class="diff-chg">related
functionality,
such
as
enumerating
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Properties
</ins></a>,<a href= "#dfn-actions" class="internalDFN" data-link-type= "dfn">
Action
</a>
<del class="diff-old">invocation
or
event
emitting
is
observed,
or
the
changes
to
the
Thing
Description
</del>
<ins class="diff-chg">s,
</ins><a href="#dfn-events" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Event
</ins>
</a>
<del class="diff-old">are
observed.
request.options.subscribe
is
true
if
subscription
is
turned
or
kept
being
turned
on,
</del>
<ins class="diff-chg">s
</ins>
and
<del class="diff-old">it
</del>
<ins class="diff-chg">links
(introspection)
</ins>
is
<del class="diff-old">false
when
subscription
</del>
<ins class="diff-chg">an
API
extension
that
</ins>
is
<del class="diff-old">turned
off.
</del>
<ins class="diff-chg">out
of
scope
for
this
specification.
However,
the
draft
interfaces
are
defined
here
for
informative
purposes.
</ins></p><div><pre class="def idl"><span class="idlInterface" id=<ins class="diff-chg">
"idl-def-consumedthing-partial-1" data-idl="" data-title=
"ConsumedThing">partial interface <span class=
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-consumedthing" class="internalDFN" data-link-type=
"dfn"><code>ConsumedThing</code></a></span> {
</ins><span class="idlMethod" id="idl-def-consumedthing-getproperties"<ins class="diff-chg">
data-idl="" data-title="getProperties" data-dfn-for=
"consumedthing">    <span class="idlMethType"><a href=
"https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a href="#dom-thingproperty"
class="internalDFN" data-link-type=
"dfn"><code>ThingProperty</code></a>&gt;</span> <span class=
"idlMethName"><a data-no-default="" data-link-for="consumedthing"
data-lt="getproperties()|getProperties" href=
"#dom-consumedthing-getproperties" class="internalDFN"
data-link-type="dfn">getProperties</a></span>();</span>
</ins><span class="idlMethod" id="idl-def-consumedthing-getactions"<ins class="diff-chg">
data-idl="" data-title="getActions" data-dfn-for=
"consumedthing">    <span class="idlMethType"><a href=
"https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a href="#dom-thingaction"
class="internalDFN" data-link-type=
"dfn"><code>ThingAction</code></a>&gt;</span>   <span class=
"idlMethName"><a data-no-default="" data-link-for="consumedthing"
data-lt="getactions()|getActions" href=
"#dom-consumedthing-getactions" class="internalDFN" data-link-type=
"dfn">getActions</a></span>();</span>
</ins><span class="idlMethod" id="idl-def-consumedthing-getevents"<ins class="diff-chg">
data-idl="" data-title="getEvents" data-dfn-for=
"consumedthing">    <span class="idlMethType"><a href=
"https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a href="#dom-thingevent"
class="internalDFN" data-link-type=
"dfn"><code>ThingEvent</code></a>&gt;</span>    <span class=
"idlMethName"><a data-no-default="" data-link-for="consumedthing"
data-lt="getevents()|getEvents" href="#dom-consumedthing-getevents"
class="internalDFN" data-link-type=
"dfn">getEvents</a></span>();</span>
</ins><span class="idlMethod" id="idl-def-consumedthing-getlinks"<ins class="diff-chg">
data-idl="" data-title="getLinks" data-dfn-for=
"consumedthing">    <span class="idlMethType"><a href=
"https://heycam.github.io/webidl/#idl-sequence">sequence</a>&lt;<a href="#dom-tdlink"
class="internalDFN" data-link-type=
"dfn"><code>TDLink</code></a>&gt;</span>        <span class=
"idlMethName"><a data-no-default="" data-link-for="consumedthing"
data-lt="getlinks()|getLinks" href="#dom-consumedthing-getlinks"
class="internalDFN" data-link-type=
"dfn">getLinks</a></span>();</span>
};
</ins></span></pre></div><section id="the-getproperties-method"><h3 id="x6-1-the-getproperties-method">
<span class= "secno">
<del class="diff-old">5.14
</del>
<ins class="diff-chg">6.1
</ins>
</span>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id="dom-consumedthing-getproperties" data-idl= "" data-title="getProperties()" data-lt= "getproperties()|getProperties">
<code>
<del class="diff-old">register()
</del>
<ins class="diff-chg">getProperties()
</ins>
</code>
</dfn>
method
</h3>
<p>
<del class="diff-old">Generates
the
Thing
Description
given
</del>
<ins class="diff-chg">Returns
</ins>
the
<del class="diff-old">properties,
Actions
and
Event
</del>
<ins class="diff-chg">list
of
</ins><a href="#dfn-properties" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Properties
</ins>
</a>
defined
<del class="diff-old">for
this
object.
If
a
directory
argument
is
given,
make
a
request
to
register
</del>
<ins class="diff-chg">in
</ins>
the
<a href="#dfn-thing-descriptions" class="internalDFN" data-link-type="dfn">
Thing
Description
</a>
<del class="diff-old">with
</del>
<ins class="diff-chg">of
</ins>
the
<del class="diff-old">given
WoT
repository
by
invoking
its
</del>
<a href= "#dfn-things" class="internalDFN" data-link-type="dfn">
<ins class="diff-chg">Thing
</ins></a><ins class="diff-chg">
in
the
form
of
a
list
of
</ins><a href="#dom-thingproperty" class= "internalDFN" data-link-type="dfn">
<code>
<del class="diff-old">register
</del>
<ins class="diff-chg">ThingProperty
</ins>
</code>
<del class="diff-old">Action
.
</del>
</a>
<ins class="diff-chg">objects.
</ins>
</p>
</section>
<section id="the-getactions-method">
<h3 id="x6-2-the-getactions-method">
<del class="diff-old">5.15
</del>
<span class="secno">
<ins class="diff-chg">6.2
</ins>
</span>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id= "dom-consumedthing-getactions" data-idl="" data-title= "getActions()" data-lt= "getactions()|getActions">
<code>
<del class="diff-old">unregister()
</del>
<ins class="diff-chg">getActions()
</ins>
</code>
</dfn>
method
</h3>
<p>
<del class="diff-old">If
a
directory
argument
is
given,
make
a
request
to
unregister
the
Thing
Description
with
</del>
<ins class="diff-chg">Returns
</ins>
the
<del class="diff-old">given
WoT
repository
by
invoking
its
unregister
</del>
<ins class="diff-chg">list
of
</ins><a href="#dfn-actions" class="internalDFN" data-link-type="dfn">
Action
<del class="diff-old">.
Then,
and
</del>
</a>
<ins class="diff-chg">s
defined
</ins>
in
the
<del class="diff-old">case
no
arguments
were
provided
to
this
function,
stop
the
</del>
<a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
<ins class="diff-new">Description
</ins>
</a>
<del class="diff-old">and
remove
</del>
<ins class="diff-chg">of
</ins>
the
<a href="#dfn-things" class= "internalDFN" data-link-type="dfn">
Thing
<del class="diff-old">Description
.
</del>
</a>
<ins class="diff-chg">in
the
form
of
a
list
of
</ins><a href="#dom-thingaction" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ThingAction
</ins></code></a><ins class="diff-chg">
objects.
</ins>
</p>
</section>
<section id="the-getevents-method">
<h3 id="x6-3-the-getevents-method">
<span class="secno">
<del class="diff-old">5.16
</del>
<ins class="diff-chg">6.3
</ins>
</span>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id= "dom-consumedthing-getevents" data-idl="" data-title="getEvents()" data-lt="getevents()|getEvents">
<code>
<del class="diff-old">start()
</del>
<ins class="diff-chg">getEvents()
</ins>
</code>
</dfn>
method
</h3>
<p>
<del class="diff-old">Start
serving
external
requests
for
</del>
<ins class="diff-chg">Returns
</ins>
the
<ins class="diff-chg">list
of
</ins><a href="#dfn-events" class="internalDFN" data-link-type="dfn"><ins class="diff-chg">
Event
</ins></a><ins class="diff-chg">
s
defined
in
the
</ins><a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
<del class="diff-old">.
</del>
<ins class="diff-chg">Description
</ins></a><ins class="diff-chg">
of
the
</ins><a href="#dfn-things" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
</ins></a><ins class="diff-chg">
in
the
form
of
a
list
of
</ins><a href="#dom-thingevent" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
ThingEvent
</ins></code></a><ins class="diff-chg">
objects.
</ins>
</p>
</section>
<section id="the-getlinks-method">
<h3 id="x6-4-the-getlinks-method">
<span class="secno">
<del class="diff-old">5.17
</del>
<ins class="diff-chg">6.4
</ins>
</span>
The
<dfn data-dfn-for="consumedthing" data-dfn-type="dfn" id= "dom-consumedthing-getlinks" data-idl="" data-title="getLinks()" data-lt="getlinks()|getLinks">
<code>
<del class="diff-old">stop()
</del>
<ins class="diff-chg">getLinks()
</ins>
</code>
</dfn>
method
</h3>
<p>
<del class="diff-old">Stop
serving
external
requests
for
</del>
<ins class="diff-chg">Returns
</ins>
the
<ins class="diff-chg">list
of
linked
resources
in
</ins><a href= "#dfn-thing-descriptions" class="internalDFN" data-link-type= "dfn">
Thing
<del class="diff-old">.
</del>
<ins class="diff-chg">Description
</ins></a><ins class="diff-chg">
of
the
</ins><a href="#dfn-things" class= "internalDFN" data-link-type="dfn"><ins class="diff-chg">
Thing
</ins></a><ins class="diff-chg">
in
the
form
of
a
list
of
</ins><a href="#dom-tdlink" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
TDLink
</ins></code></a><ins class="diff-chg">
objects.
</ins>
</p>
<section data-dfn-for="TDLink" id="the-tdlink-dictionary">
<h4 id="x6-4-1-the-tdlink-dictionary">
<span class= "secno">
<del class="diff-old">5.18
</del>
<ins class="diff-chg">6.4.1
</ins>
</span>
The
<dfn data-dfn-for="" data-dfn-type="dfn" id="dom-tdlink" data-idl="" data-title= "TDLink">
<code>
<del class="diff-old">emitEvent()
</del>
<ins class="diff-chg">TDLink
</ins>
</code>
</dfn>
<del class="diff-old">method
</del>
<ins class="diff-chg">dictionary
</ins></h4>
<p>
<del class="diff-old">Emits
an
the
event
initialized
with
the
event
name
specified
by
the
eventName
argument
</del>
<ins class="diff-chg">Contains
a
hyperlink
reference,
a
relation
type
</ins>
and
<del class="diff-old">data
specified
by
the
payload
argument.
</del>
<ins class="diff-chg">a
media
type.
</ins>
</p>
<del class="diff-old">5.19
</del>
<div>
<pre class="def idl"><span class="idlDictionary" id=
<ins class="diff-chg">"idl-def-tdlink" data-idl="" data-title=
"TDLink">dictionary <span class=
"idlDictionaryID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-tdlink" class="internalDFN" data-link-type=
"dfn"><code>TDLink</code></a></span> {
</ins><span class="idlMember" id="idl-def-tdlink-href" data-idl=""<ins class="diff-chg">
data-title="href" data-dfn-for="tdlink">    required <span class=
"idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlMemberName"><a data-no-default=""
data-link-for="tdlink" data-lt="" href="#dom-tdlink-href" class=
"internalDFN" data-link-type=
"dfn"><code>href</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-tdlink-mediatype" data-idl=""<ins class="diff-chg">
data-title="mediaType" data-dfn-for=
"tdlink">             <span class="idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-USVString">USVString</a></span> <span class="idlMemberName"><a data-no-default=""
data-link-for="tdlink" data-lt="" href="#dom-tdlink-mediatype"
class="internalDFN" data-link-type=
"dfn"><code>mediaType</code></a></span>;</span>
</ins><span class="idlMember" id="idl-def-tdlink-rel" data-idl=""<ins class="diff-chg">
data-title="rel" data-dfn-for="tdlink">             <span class=
"idlMemberType"><a href=
"https://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span> <span class="idlMemberName"><a data-no-default=""
data-link-for="tdlink" data-lt="" href="#dom-tdlink-rel" class=
"internalDFN" data-link-type=
"dfn"><code>rel</code></a></span>;</span>
};
</ins>
</span>
<del class="diff-old">Events
supported
by
ExposedThing
</del>
</pre>
</div>
<p>
The
<del class="diff-old">following
default
events
SHOULD
be
supported
by
</del>
<a href="#dom-tdlink" class="internalDFN" data-link-type= "dfn">
<code>
<del class="diff-old">ExposedThing
</del>
<ins class="diff-chg">TDLink
</ins>
</code>
</a>
<del class="diff-old">implementations:
</del>
<ins class="diff-chg">dictionary
contains
the
following
properties:
</ins>
</p>
<ul>
<li>
<del class="diff-old">"
propertychange
"
of
type
</del>
<ins class="diff-chg">The
</ins><dfn data-dfn-for="tdlink" data-dfn-type="dfn" id= "dom-tdlink-href" data-idl="" data-title= "href">
<code>
<del class="diff-old">PropertyChangeEvent
</del>
<ins class="diff-chg">href
</ins>
</code>
</dfn>
<ins class="diff-chg">attribute
represents
a
</ins><a href= "#dfn-hyperlink-reference" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
hyperlink
reference
</ins></a>.
</li>
<li>
<del class="diff-old">"
actioninvocation
"
of
type
</del>
<ins class="diff-chg">The
</ins><dfn data-dfn-for="tdlink" data-dfn-type="dfn" id= "dom-tdlink-rel" data-idl="" data-title= "rel">
<code>
<del class="diff-old">ActionInvocationEvent
</del>
<ins class="diff-chg">rel
</ins>
</code>
<del class="diff-old">"
descriptionchange
</del>
</dfn>
<del class="diff-old">"
of
</del>
<ins class="diff-chg">attribute
represents
a
</ins><a href= "#dfn-relation-type" class="internalDFN" data-link-type= "dfn"><ins class="diff-chg">
relation
</ins>
type
</a>.
</li>
<li>
<ins class="diff-chg">The
</ins><dfn data-dfn-for="tdlink" data-dfn-type="dfn" id= "dom-tdlink-mediatype" data-idl="" data-title= "mediaType">
<code>
<del class="diff-old">ThingDescriptionChangeEvent
</del>
<ins class="diff-chg">mediaType
</ins>
</code>
</dfn>
<ins class="diff-new">attribute
represents
a
</ins><a href="#dfn-iana-media-type" class="internalDFN" data-link-type= "dfn"><ins class="diff-new">
IANA
media
type
</ins>
</a>.
<ins class="diff-new">For
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
TD
</ins></a><ins class="diff-new">
s
there
will
be
registered
media
types,
so
applications
will
be
able
to
check
whether
an
</ins><code><ins class="diff-new">
href
</ins></code><ins class="diff-new">
link
points
to
a
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
TD
</ins></a>,<ins class="diff-new">
i.e.
whether
the
link
is
fetcheable
with
this
API.
</ins>
</li>
</ul>
<del class="diff-old">In
addition,
user
defined
events
are
specified
by
the
Thing
Description
.
</del>
</section>
</section>
</section>
<section data-dfn-for="Observable" class="informative" id= "observables">
<h2 id="x7-observables">
<span class="secno">
<del class="diff-old">5.20
</del>
<ins class="diff-chg">7.
</ins>
</span>
<del class="diff-old">Examples
</del>
<ins class="diff-chg">Observables
</ins></h2>
<p>
<del class="diff-old">Below
some
</del>
<em>
<ins class="diff-chg">This
section
is
non-normative.
</ins></em>
<del class="diff-old">ExposedThing
</del>
</p>
<p>
<dfn data-dfn-type="dfn" id="dfn-observables">
<ins class="diff-new">Observables
</ins></dfn><ins class="diff-new">
are
</ins><a href= "https://github.com/tc39/proposal-observable"><ins class="diff-new">
proposed
</ins>
</a>
<del class="diff-old">interface
examples
</del>
<ins class="diff-chg">to
be
included
in
ECMAScript
and
</ins>
are
<del class="diff-old">given.
</del>
<ins class="diff-chg">used
for
handling
pushed
data
associated
with
various
possible
sources,
for
instance
events,
timers,
streams,
etc.
A
minimal
required
implementation
is
described
here.
</ins>
</p>
<div class="ednote">
<div role="heading" class="ednote-title marker" id="h-ednote-10" aria-level="3">
<span>
<del class="diff-old">Example
6
</del>
<ins class="diff-chg">Editor's
note
</ins>
</span>
<del class="diff-old">:
Create
a
new
blank
exposed
Thing
</del>
</div>
<p class="">
<ins class="diff-chg">This
section
is
informal
and
contains
rather
laconic
information
for
implementations
on
what
to
support
for
interoperability.
</ins></p></div><div><pre class="def idl"><span class="idlInterface" id=<ins class="diff-chg">
"idl-def-observable" data-idl="" data-title=
"Observable">interface <span class=
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-observable" class="internalDFN" data-link-type=
"dfn"><code>Observable</code></a></span> {
</ins><span class="idlMethod" id=<ins class="diff-chg">
"idl-def-observable-subscribe-next-error-complete" data-idl=""
data-title="subscribe" data-dfn-for="observable">    <span class=
"idlMethType"><a href="#dom-subscription" class="internalDFN"
data-link-type=
"dfn"><code>Subscription</code></a></span> <span class=
"idlMethName"><a data-no-default="" data-link-for="observable"
data-lt="subscribe|subscribe()" href="#dom-observable-subscribe"
class="internalDFN" data-link-type=
"dfn"><code>subscribe</code></a></span>(<span class=
"idlParam"><span class="idlParamType">(<a href="#dom-observer"
class="internalDFN" data-link-type=
"dfn"><code>Observer</code></a> or <a href="#dom-onnext" class=
"internalDFN" data-link-type=
"dfn"><code>OnNext</code></a>)</span> <span class=
"idlParamName">next</span></span>,
</ins>                           <span class=<ins class="diff-chg">
"idlParam">optional <span class="idlParamType"><a href=
"#dom-onerror" class="internalDFN" data-link-type=
"dfn"><code>OnError</code></a></span> <span class=
"idlParamName">error</span></span>,
</ins>                           <span class=<ins class="diff-chg">
"idlParam">optional <span class="idlParamType"><a href=
"#dom-oncomplete" class="internalDFN" data-link-type=
"dfn"><code>OnComplete</code></a></span> <span class=
"idlParamName">complete</span></span>);</span>
};</span>
</ins><span class="idlInterface" id="idl-def-subscription" data-idl=""<ins class="diff-chg">
data-title="Subscription">interface <span class=
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-subscription" class="internalDFN" data-link-type=
"dfn"><code>Subscription</code></a></span> {
</ins><span class="idlMethod" id="idl-def-subscription-unsubscribe"<ins class="diff-chg">
data-idl="" data-title="unsubscribe" data-dfn-for=
"subscription">    <span class=
"idlMethType">void</span> <span class=
"idlMethName"><a data-no-default="" data-link-for="subscription"
data-lt="unsubscribe|unsubscribe()" href=
"#dom-subscription-unsubscribe" class="internalDFN" data-link-type=
"dfn"><code>unsubscribe</code></a></span>();</span>
</ins><span class="idlAttribute" id="idl-def-subscription-closed"<ins class="diff-chg">
data-idl="" data-title="closed" data-dfn-for=
"subscription">    readonly attribute <span class=
"idlAttrType"><a href=
"https://heycam.github.io/webidl/#idl-boolean">boolean</a></span> <span class="idlAttrName"><a data-no-default=""
data-link-for="subscription" data-lt="" href=
"#dom-subscription-closed" class="internalDFN" data-link-type=
"dfn"><code>closed</code></a></span>;</span>
};</span>
</ins><span class="idlInterface" id="idl-def-observer" data-idl=""<ins class="diff-chg">
data-title="Observer">interface <span class=
"idlInterfaceID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-observer" class="internalDFN" data-link-type=
"dfn"><code>Observer</code></a></span> {
</ins><span class="idlMethod" id="idl-def-observer-next-value" data-idl=<ins class="diff-chg">
"" data-title="next" data-dfn-for="observer">    <span class=
"idlMethType">void</span> <span class=
"idlMethName"><a data-no-default="" data-link-for="observer"
data-lt="next()|next" href="#dom-observer-next" class="internalDFN"
data-link-type="dfn">next</a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">value</span></span>);</span>
</ins><span class="idlMethod" id="idl-def-observer-error-error" data-idl=<ins class="diff-chg">
"" data-title="error" data-dfn-for="observer">    <span class=
"idlMethType">void</span> <span class=
"idlMethName"><a data-no-default="" data-link-for="observer"
data-lt="error()|error" href="#dom-observer-error" class=
"internalDFN" data-link-type="dfn">error</a></span>(<span class=
"idlParam"><span class="idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-Error">Error</a></span> <span class="idlParamName">error</span></span>);</span>
</ins><span class="idlMethod" id="idl-def-observer-complete" data-idl=""<ins class="diff-chg">
data-title="complete" data-dfn-for="observer">    <span class=
"idlMethType">void</span> <span class=
"idlMethName"><a data-no-default="" data-link-for="observer"
data-lt="complete()|complete" href="#dom-observer-complete" class=
"internalDFN" data-link-type="dfn">complete</a></span>();</span>
};</span>
</ins><span class="idlCallback" id="idl-def-onnext" data-idl=""<ins class="diff-chg">
data-title="OnNext">callback <span class=
"idlCallbackID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-onnext" class="internalDFN" data-link-type=
"dfn"><code>OnNext</code></a></span> = <span class=
"idlCallbackType">void</span> (<span class="idlParam"><span class=
"idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-any">any</a></span> <span class="idlParamName">value</span></span>);</span>
</ins><span class="idlCallback" id="idl-def-onerror" data-idl=""<ins class="diff-chg">
data-title="OnError">callback <span class=
"idlCallbackID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-onerror" class="internalDFN" data-link-type=
"dfn"><code>OnError</code></a></span> = <span class=
"idlCallbackType">void</span> (<span class="idlParam"><span class=
"idlParamType"><a href=
"https://heycam.github.io/webidl/#idl-Error">Error</a></span> <span class="idlParamName">error</span></span>);</span>
</ins><span class="idlCallback" id="idl-def-oncomplete" data-idl=""<ins class="diff-chg">
data-title="OnComplete">callback <span class=
"idlCallbackID"><a data-no-default="" data-link-for="" data-lt=""
href="#dom-oncomplete" class="internalDFN" data-link-type=
"dfn"><code>OnComplete</code></a></span> = <span class=
"idlCallbackType">
void
</ins></span><ins class="diff-chg">
();
</ins>
</span>
<del class="diff-old">&lt;pre class="highlight hljs javascript" aria-busy="false" aria-live=
"polite"&gt;WoT.createExposedThing(thingDescription)
  .then(&lt;span class=
"hljs-keyword"&gt;function(&lt;span class=
"hljs-params"&gt;thing{
    &lt;span class=
"hljs-comment"&gt;// manually add properties, actions, and events
    thing.addProperty({
      : &lt;span class=
"hljs-string"&gt;"temperature",
      : &lt;span class=
"hljs-string"&gt;"0",
      : &lt;span class=
"hljs-literal"&gt;false
      &lt;span class=
"hljs-comment"&gt;// use default values for the rest
    }).addEvent({
      : &lt;span class=
"hljs-string"&gt;"onchange",
      : {
        : &lt;span class=
"hljs-string"&gt;"float32"
      }
    }).addAction({
      : &lt;span class=
"hljs-string"&gt;"reset",
      : &lt;span class=
"hljs-function"&gt;&lt;span class=
"hljs-params"&gt;() { &lt;span class=
"hljs-keyword"&gt;this.temperature = &lt;span class=
"hljs-number"&gt;0; }
    })
    
    .onRetrieveProperty( &lt;span class=
"hljs-params"&gt;request {
      .log(&lt;span class=
"hljs-string"&gt;"Handling read request");
       &lt;span class=
"hljs-keyword"&gt;this.temperature;
    }).onObserve( &lt;span class=
"hljs-params"&gt;request {
      .log(&lt;span class=
"hljs-string"&gt;"Handling observe request");
      &lt;span class=
"hljs-comment"&gt;// add listener identified by request.from
    }).onInvokeAction( &lt;span class=
"hljs-params"&gt;request {
      .log(&lt;span class=
"hljs-string"&gt;"Handling action request");
    }).start();
});
</del>
</pre>
</div>
<section data-dfn-for="Observer" id="the-observer-interface">
<h3 id="x7-1-the-observer-interface">
<del class="diff-old">Example
7
</del>
<span class="secno">
<ins class="diff-chg">7.1
</ins>
</span>
<ins class="diff-new">The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id="dom-observer" data-idl="" data-title="Observer">
<del class="diff-old">:
Create
a
new
exposed
Thing
from
a
TD
URI
</del>
<code>
<ins class="diff-chg">Observer
</ins></code>
<del class="diff-old">let thingDescription = '{
  "name": "mySensor",
  "url": "http://myservice.org/mySensor/description"
}';
WoT.createExposedThing(thingDescription)
  .then(function(thing) {
    // properties, actions and events are added based on the TD
    console.log("created " + thing.name });
    // now add the requests handlers
    thing.onRetrieveProperty(function(request) {
        console.log("Sending property '" + request.property + "' to " + request.from);
    }).onUpdateProperty(function(request) {
        console.log("Updating property '" + request.property + "' by " + request.from);
    }).onObserve(function(request) {
        console.log("Adding listener " + request.from);
        console.log("Observing " + request.type + " " + request.name +
            (request.subscribe? " recursively" : ""));
    }).start().then(function() {
       console.log("Thing started serving requests");
    });
})
</del>
</dfn>
<ins class="diff-chg">interface
</ins></h3><p><ins class="diff-chg">
The
</ins><a href="#dom-observer" class="internalDFN" data-link-type= "dfn">
<code>
<ins class="diff-chg">Observer
</ins></code>
<del class="diff-old">Example
8
</del>
</a>
<ins class="diff-chg">interface
defines
the
callbacks
needed
to
handle
an
</ins><a href="#dom-observable" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
Observable
</ins></code></a>:</p><ul><li><ins class="diff-chg">
The
</ins><dfn data-dfn-for="observer" data-dfn-type="dfn" id= "dom-observer-next" data-idl="" data-title="next()" data-lt= "next()|next"><code><ins class="diff-chg">
next()
</ins></code></dfn><ins class="diff-chg">
function,
as
well
as
the
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id="dom-onnext" data-idl= "" data-title="OnNext"><code><ins class="diff-chg">
OnNext
</ins></code></dfn><ins class="diff-chg">
callback
takes
the
next
sample
for
the
data
in
the
</ins><code><ins class="diff-chg">
value
</ins></code><ins class="diff-chg">
argument.
</ins></li><li><ins class="diff-chg">
The
</ins><dfn data-dfn-for="observer" data-dfn-type="dfn" id= "dom-observer-error" data-idl="" data-title="error()" data-lt= "error()|error"><code><ins class="diff-chg">
error()
</ins></code></dfn><ins class="diff-chg">
function,
as
well
as
the
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id="dom-onerror" data-idl= "" data-title="OnError"><code><ins class="diff-chg">
OnError
</ins></code></dfn><ins class="diff-chg">
callback
takes
an
error
in
the
</ins><code><ins class="diff-chg">
value
</ins></code><ins class="diff-chg">
argument.
It
is
called
when
an
error
occured
in
producing
the
data
the
client
should
know
about.
</ins></li><li><ins class="diff-chg">
The
</ins><dfn data-dfn-for="observer" data-dfn-type="dfn" id= "dom-observer-complete" data-idl="" data-title="complete()" data-lt="complete()|complete"><code><ins class="diff-chg">
complete()
</ins></code></dfn><ins class="diff-chg">
function,
as
well
as
the
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id="dom-oncomplete" data-idl="" data-title= "OnComplete"><code><ins class="diff-chg">
OnComplete
</ins></code></dfn><ins class="diff-chg">
callback
is
called
when
the
data
source
has
finished
sending
values.
</ins></li></ul></section><section data-dfn-for="Subscription" id= "the-subscription-interface"><h3 id="x7-2-the-subscription-interface"><span class= "secno"><ins class="diff-chg">
7.2
</ins>
</span>
<ins class="diff-new">The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-subscription" data-idl="" data-title= "Subscription">
<del class="diff-old">:
Create
</del>
<code>
<ins class="diff-chg">Subscription
</ins></code></dfn><ins class="diff-chg">
interface
</ins></h3><p><ins class="diff-chg">
Contains
the
</ins><dfn data-dfn-for="subscription" data-dfn-type= "dfn" id="dom-subscription-closed" data-idl="" data-title= "closed"><code><ins class="diff-chg">
closed
</ins></code></dfn><ins class="diff-chg">
property
of
type
</ins><code><ins class="diff-chg">
boolean
</ins></code><ins class="diff-chg">
that
tells
if
the
subscription
is
closed
or
active.
</ins></p><p><ins class="diff-chg">
Also,
contains
the
</ins><dfn data-dfn-for="subscription" data-dfn-type="dfn" id="dom-subscription-unsubscribe" data-idl="" data-title="unsubscribe" data-lt= "unsubscribe|unsubscribe()"><code><ins class="diff-chg">
unsubscribe
</ins></code></dfn><ins class="diff-chg">
()
method
that
cancels
the
subscription,
i.e.
makes
</ins>
a
<del class="diff-old">new
exposed
Thing
</del>
<ins class="diff-chg">request
to
the
underlying
platform
to
stop
receiving
data
</ins>
from
<del class="diff-old">a
Thing
Description
</del>
<ins class="diff-chg">the
source,
and
sets
the
</ins><code><ins class="diff-chg">
closed
</ins></code><ins class="diff-chg">
property
to
</ins><code><ins class="diff-chg">
false
</ins></code>.</p></section><section data-dfn-for="Observable" id="the-observable-interface"><h3 id="x7-3-the-observable-interface"><span class= "secno"><ins class="diff-chg">
7.3
</ins>
</span>
<ins class="diff-new">The
</ins><dfn data-dfn-for="" data-dfn-type="dfn" id= "dom-observable" data-idl="" data-title= "Observable">
<del class="diff-old">let thingDescription = '{
  "name": "mySensor",
  "description": {
    "@context": [
      "http://w3c.github.io/wot/w3c-wot-td-context.jsonld",
      "http://w3c.github.io/wot/w3c-wot-common-context.jsonld",
    ],
    "@type": [ "Thing" ],
    "interaction": [
      // ...
    ]
    // ...
  }'
};
WoT.createExposedThing(thingDescription)
  .then(function(thing) {
    // properties, actions and events are added based on the TD
    // ...
});
</del>
<code>
<ins class="diff-chg">Observable
</ins></code>
</dfn>
<ins class="diff-chg">interface
</ins></h3><p><ins class="diff-chg">
The
</ins><a href="#dom-observable" class="internalDFN" data-link-type="dfn"><code><ins class="diff-chg">
Observable
</ins></code></a><ins class="diff-chg">
interface
enabled
subscribing
to
pushed
data
notifications
by
the
</ins><dfn data-dfn-for= "observable" data-dfn-type="dfn" id="dom-observable-subscribe" data-idl="" data-title="subscribe" data-lt= "subscribe|subscribe()"><code><ins class="diff-chg">
subscribe
</ins></code></dfn><ins class="diff-chg">
()
method:
</ins></p><ul><li><ins class="diff-chg">
If
the
</ins><code><ins class="diff-chg">
subscribe()
</ins></code><ins class="diff-chg">
method
is
called
with
an
</ins><a href="#dom-observer" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-chg">
Observer
</ins></code></a><ins class="diff-chg">
object,
initialize
the
data,
error
and
completion
handling
callbacks
from
that
object,
or
throw
on
error.
</ins></li><li><ins class="diff-chg">
Otherwise,
if
the
</ins><code><ins class="diff-chg">
subscribe()
</ins></code><ins class="diff-chg">
method
is
called
with
a
function,
initialize
the
data
handler
callback
with
that
function.
If
the
next
argument
is
provided
and
is
a
function,
initialize
the
error
handling
callback
with
that
function,
or
throw
on
error.
If
the
third
argument
is
provided
and
is
a
function,
initialize
the
completion
handler
with
that
function,
or
throw
on
error.
</ins></li><li><ins class="diff-chg">
After
callback
initializations,
the
implementation
should
request
the
underlying
platform
to
provide
data,
error
and
completion
notifications
for
the
supported
data
source.
</ins></li></ul>
</section>
</section>
<section>
<h2 id="security">
<span class="secno">
<del class="diff-old">6.
</del>
<ins class="diff-chg">8.
</ins>
</span>
Security
and
Privacy
</h2>
<div class="ednote">
<div role="heading" class="ednote-title marker" id="h-ednote-11" aria-level="3">
<span>
Editor's
note
</span>
</div>
<p class="">
Please
see
the
<a href= "https://github.com/w3c/wot-security/">
WoT
Security
and
Privacy
</a>
repository
for
work
in
progress
regarding
threat
models,
assets,
risks,
recommended
mitigations,
and
best
practices
for
security
and
privacy
for
systems
using
the
Web
of
Things.
Once
complete,
security
and
privacy
considerations
relevant
to
the
Scripting
API
will
be
summarized
in
this
section.
</p>
</div>
</section>
<section id="terminology-and-conventions">
<h2 id="x9-terminology-and-conventions">
<span class= "secno">
<del class="diff-old">7.
</del>
<ins class="diff-chg">9.
</ins>
</span>
Terminology
and
conventions
</h2>
<p>
The
generic
WoT
terminology
is
defined
in
[
<cite>
<a class= "bibref" href="#bib-WOT-ARCHITECTURE">
WOT-ARCHITECTURE
</a>
</cite>
]:
<dfn data-lt="things|thing" data-dfn-type="dfn" id= "dfn-things">
Thing
</dfn>,
<dfn data-lt= "thing descriptions|thing description" data-dfn-type="dfn" id= "dfn-thing-descriptions">
Thing
Description
</dfn>
(in
short
<dfn data-dfn-type="dfn" id="dfn-td">
TD
</dfn>
),
<dfn data-dfn-type= "dfn" id="dfn-web-of-things">
Web
of
Things
</dfn>
(in
short
<b>
<i>
WoT
</i>
</b>
),
<dfn data-dfn-type="dfn" id= "dfn-wot-interface">
WoT
Interface
</dfn>,
<dfn data-dfn-type="dfn" id="dfn-protocol-bindings">
Protocol
Bindings
</dfn>,
<dfn data-dfn-type="dfn" id="dfn-wot-runtime">
WoT
Runtime
</dfn>,
<dfn data-lt= "consume|consume a td|consuming a td|consuming a thing description" data-dfn-type="dfn" id="dfn-consume">
Consuming
a
Thing
Description
</dfn>,
<dfn data-dfn-type="dfn" id= "dfn-thing-directory">
Thing
Directory
</dfn>,
<dfn data-dfn-type= "dfn" id="dfn-wot-interactions">
<ins class="diff-chg">WoT
Interactions
</ins></dfn>,<dfn data-lt="properties|property" data-dfn-type="dfn" id= "dfn-properties">
Property
</dfn>,
<dfn data-lt="actions|action" data-dfn-type="dfn" id="dfn-actions">
Action
</dfn>,
<dfn data-lt= "events|wot-event|event" data-dfn-type="dfn" id= "dfn-events">
Event
</dfn>
etc.
</p>
<del class="diff-old">Note
In
this
version
of
the
specification,
a
WoT
Runtime
is
assumed
to
run
scripts
that
uses
this
API
to
define
one
or
more
Thing
s
that
share
a
common
event
loop.
Script
deployment
methods
are
out
of
scope
of
this
version.
In
future
versions,
running
multiple
scripts
(as
modules)
may
be
possible,
and
script
deployment
MAY
be
implemented
using
a
manager
Thing
whose
Actions
permit
script
lifecycle
management
operations.
</del>
<p>
<dfn data-dfn-type="dfn" id="dfn-json-ld">
JSON-LD
</dfn>
is
defined
in
[
<cite>
<a class="bibref" href= "#bib-JSON-LD">
JSON-LD
</a>
</cite>
]
as
a
JSON
document
that
is
augmented
with
support
for
Linked
Data
by
providing
a
<code>
@context
</code>
property
with
a
defining
URI
.
</p>
<p>
The
terms
<a href= "http://www.w3.org/TR/url-1/">
<dfn data-dfn-type="dfn" id= "dfn-url">
URL
</dfn>
</a>
and
<a href= "https://url.spec.whatwg.org/#concept-url-path">
<dfn data-dfn-type= "dfn" id="dfn-url-path">
URL
path
</dfn>
</a>
are
defined
in
[
<cite>
<a class="bibref" href="#bib-URL">
URL
</a>
</cite>
].
</p>
<p>
The
following
terms
are
defined
in
[
<cite>
<del class="diff-old">HTML5
</del>
<a class="bibref" href="#bib-HTML52">
<ins class="diff-chg">HTML52
</ins>
</a>
</cite>
]
and
are
used
in
the
context
of
browser
implementations:
<a href= "https://www.w3.org/TR/html52/single-page.html#browsing-context">
<dfn data-dfn-type="dfn" id="dfn-browsing-context">
browsing
context
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#top-level-browsing-context">
<dfn data-dfn-type="dfn" id= "dfn-top-level-browsing-context">
top-level
browsing
context
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#global-object">
<dfn data-dfn-type="dfn" id="dfn-global-object">
global
object
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#incumbent-settings-object">
<dfn data-dfn-type="dfn" id= "dfn-incumbent-settings-object">
incumbent
settings
object
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#document">
<dfn data-dfn-type="dfn" id="dfn-document">
Document
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#document-base-url">
<dfn data-dfn-type="dfn" id="dfn-document-base-url">
document
base
URL
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#window">
<dfn data-dfn-type="dfn" id="dfn-window">
Window
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#windowproxy">
<dfn data-dfn-type="dfn" id="dfn-windowproxy">
WindowProxy
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#section-origin">
<dfn data-dfn-type="dfn" id="dfn-origin">
origin
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#ascii-serialization-of-an-origin">
<dfn data-dfn-type="dfn" id="dfn-ascii-serialized-origin">
ASCII
serialized
origin
</dfn>
</a>,
executing
algorithms
<a href= "https://www.w3.org/TR/html52/single-page.html#in-parallel">
<dfn data-dfn-type="dfn" id="dfn-in-parallel">
in
parallel
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#queuing">
<dfn data-dfn-type="dfn" id="dfn-queue-a-task">
queue
a
task
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#task-source">
<dfn data-dfn-type="dfn" id="dfn-task-source">
task
source
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#the-iframe-element">
<dfn data-dfn-type="dfn" id="dfn-iframe">
iframe
</dfn>
</a>,
<a href= "https://www.w3.org/TR/html52/single-page.html#valid-mime-type">
<dfn data-dfn-type="dfn" id="dfn-valid-mime-type">
valid
MIME
type
</dfn>
</a>.
</p>
<p>
A
<a href="#dfn-browsing-context" class="internalDFN" data-link-type="dfn">
browsing
context
</a>
refers
to
the
environment
in
which
<a href="#dfn-document" class="internalDFN" data-link-type="dfn">
Document
</a>
objects
are
presented
to
the
user.
A
given
<a href="#dfn-browsing-context" class="internalDFN" data-link-type="dfn">
browsing
context
</a>
has
a
single
<code>
<a href="#dfn-windowproxy" class="internalDFN" data-link-type="dfn">
WindowProxy
</a>
</code>
object,
but
it
can
have
many
<code>
<a href="#dfn-document" class="internalDFN" data-link-type="dfn">
Document
</a>
</code>
objects,
with
their
associated
<code>
<a href="#dfn-window" class="internalDFN" data-link-type="dfn">
Window
</a>
</code>
objects.
The
<a href= "#dfn-script-execution-context" class="internalDFN" data-link-type= "dfn">
script
execution
context
</a>
associated
with
the
<i>
browsing
context
</i>
identifies
the
entity
which
invokes
this
API,
which
can
be
a
<i>
web
app
</i>,
a
<i>
web
page
</i>,
or
an
<a href="#dfn-iframe" class="internalDFN" data-link-type="dfn">
iframe
</a>.
</p>
<p>
The
term
<a href= "https://w3c.github.io/webappsec/specs/powerfulfeatures/#secure-context">
<dfn data-dfn-type="dfn" id="dfn-secure-context">
secure
context
</dfn>
</a>
is
defined
in
[
<cite>
<a class="bibref" href= "#bib-WEBAPPSEC">
WEBAPPSEC
</a>
</cite>
].
</p>
<p>
<a href= "https://tc39.github.io/ecma262/#sec-error-objects">
<dfn data-dfn-type="dfn" id="dfn-error">
Error
</dfn>,
<dfn data-dfn-type="dfn" id= "dfn-evalerror">
EvalError
</dfn>,
<dfn data-dfn-type="dfn" id= "dfn-rangeerror">
RangeError
</dfn>,
<dfn data-dfn-type="dfn" id= "dfn-referenceerror">
ReferenceError
</dfn>,
<dfn data-dfn-type="dfn" id="dfn-syntaxerror">
SyntaxError
</dfn>,
<dfn data-dfn-type="dfn" id="dfn-typeerror">
TypeError
</dfn>,
<dfn data-dfn-type="dfn" id= "dfn-urierror">
URIError
</dfn>
</a>
,
<a href= "https://tc39.github.io/ecma262/#sec-execution-contexts">
<dfn data-dfn-type="dfn" id="dfn-script-execution-context">
script
execution
context
</dfn>
</a>,
<a href= "http://www.ecma-international.org/ecma-262/6.0/#sec-promise-objects">
<dfn data-dfn-type="dfn" id="dfn-promise">
Promise
</dfn>
</a>,
<a href= "http://www.ecma-international.org/ecma-262/6.0/#sec-json-object">
<dfn data-dfn-type="dfn" id="dfn-json">
JSON
</dfn>
</a>,
<a href= "http://www.ecma-international.org/ecma-262/6.0/#sec-json.stringify">
<dfn data-dfn-type="dfn" id= "dfn-json-stringify">
JSON.stringify
</dfn>
</a>
and
<a href= "http://www.ecma-international.org/ecma-262/6.0/#sec-json.parse">
<dfn data-dfn-type="dfn" id="dfn-json-parse">
JSON.parse
</dfn>
</a>
are
defined
in
[
<cite>
<a class="bibref" href= "#bib-ECMASCRIPT">
ECMASCRIPT
</a>
</cite>
].
</p>
<p>
<a href= "http://heycam.github.io/webidl/#idl-DOMString">
<dfn data-dfn-type= "dfn" id="dfn-domstring">
DOMString
</dfn>
</a>,
<a href= "https://heycam.github.io/webidl/#idl-USVString">
<dfn data-dfn-type="dfn" id="dfn-usvstring">
USVString
</dfn>
</a>,
<a href= "http://heycam.github.io/webidl/#idl-ArrayBuffer">
<dfn data-dfn-type="dfn" id="dfn-arraybuffer">
ArrayBuffer
</dfn>
</a>,
<a href= "http://heycam.github.io/webidl/#common-BufferSource">
<dfn data-dfn-type="dfn" id="dfn-buffersource">
BufferSource
</dfn>
</a>
and
<a href= "http://heycam.github.io/webidl/#idl-any">
<dfn data-dfn-type="dfn" id="dfn-any-0">
any
</dfn>
</a>
are
defined
in
[
<cite>
<a class= "bibref" href="#bib-WEBIDL">
WEBIDL
</a>
</cite>
].
</p>
<p>
The
<del class="diff-old">term
event
and
the
Event
object
are
defined
in
DOM
and
Node.js
.
Note
This
specification
uses
the
convention
that
an
event
listener
will
receive
an
Event
object.
This
should
work
both
in
a
browser
environment
and
in
a
Node.js
like
environment.
Observable
s
are
proposed
to
be
included
in
ECMAScript.
The
</del>
algorithms
<a href= "http://www.w3.org/TR/encoding/#utf-8-encode">
<dfn data-dfn-type= "dfn" id="dfn-utf-8-encode">
utf-8
encode
</dfn>
</a>,
and
<a href= "http://www.w3.org/TR/encoding/#utf-8-decode">
<dfn data-dfn-type= "dfn" id="dfn-utf-8-decode">
utf-8
decode
</dfn>
</a>
are
defined
in
[
<cite>
<a class="bibref" href= "#bib-ENCODING">
ENCODING
</a>
</cite>
].
</p>
<p>
<dfn data-dfn-type="dfn" id="dfn-iana-media-type">
IANA
media
type
</dfn>
s
(formerly
known
as
MIME
types)
are
defined
in
<a href= "http://tools.ietf.org/html/rfc2046">
RFC2046
</a>.
</p>
<p>
<ins class="diff-new">The
terms
</ins><dfn data-dfn-type="dfn" id= "dfn-hyperlink-reference"><ins class="diff-new">
hyperlink
reference
</ins></dfn><ins class="diff-new">
and
</ins><dfn data-dfn-type="dfn" id="dfn-relation-type"><ins class="diff-new">
relation
type
</ins></dfn><ins class="diff-new">
are
defined
in
[
</ins><cite><a class="bibref" href= "#bib-HTML52"><ins class="diff-new">
HTML52
</ins></a></cite><ins class="diff-new">
]
and
</ins><a href= "https://tools.ietf.org/html/rfc8288"><ins class="diff-new">
RFC8288
</ins></a>.</p>
</section>
<section id="conformance">
<h2 id="x10-conformance">
<span class="secno">
<del class="diff-old">8.
</del>
<ins class="diff-chg">10.
</ins>
</span>
Conformance
</h2>
<p>
As
well
as
sections
marked
as
non-normative,
all
authoring
guidelines,
diagrams,
examples,
and
notes
in
this
specification
are
non-normative.
Everything
else
in
this
specification
is
normative.
</p>
<p id="respecRFC2119">
The
key
words
<em class="rfc2119">
MAY
</em>,
<em class="rfc2119">
MUST
</em>,
and
<em class="rfc2119">
SHOULD
</em>
are
to
be
interpreted
as
described
in
[
<cite>
<a class="bibref" href="#bib-RFC2119">
RFC2119
</a>
</cite>
].
</p>
<p>
This
document
defines
conformance
criteria
that
apply
to
a
single
product:
the
<dfn data-dfn-type="dfn" id="dfn-ua">
UA
</dfn>
(user
agent)
that
implements
the
interfaces
it
contains.
</p>
<p>
This
specification
can
be
used
for
implementing
the
WoT
Scripting
API
in
multiple
programming
languages.
The
interface
definitions
are
specified
in
[
<cite>
<a class="bibref" href= "#bib-WEBIDL">
WEBIDL
</a>
</cite>
].
</p>
<p>
The
user
agent
(UA)
may
be
implemented
in
the
browser,
or
in
a
separate
runtime
environment,
such
as
<a href= "https://nodejs.org/en/">
Node.js
</a>
or
small
embedded
runtimes.
</p>
<p>
Implementations
that
use
ECMAScript
executed
in
a
browser
to
implement
the
APIs
defined
in
this
document
<em class="rfc2119" title="MUST">
MUST
</em>
implement
them
in
a
manner
consistent
with
the
ECMAScript
Bindings
defined
in
the
Web
IDL
specification
[
<cite>
<a class="bibref" href="#bib-WEBIDL">
WEBIDL
</a>
</cite>
].
</p>
<p>
Implementations
that
use
TypeScript
or
ECMAScript
in
a
runtime
to
implement
the
APIs
defined
in
this
document
<em class="rfc2119" title="MUST">
MUST
</em>
implement
them
in
a
manner
consistent
with
the
TypeScript
Bindings
defined
in
the
TypeScript
specification
[
<cite>
<a class="bibref" href= "#bib-TYPESCRIPT">
TYPESCRIPT
</a>
</cite>
].
</p>
<p>
This
document
serves
a
general
description
of
the
WoT
Scripting
API.
Language
and
runtime
specific
issues
are
discussed
in
separate
extensions
of
this
document.
</p>
</section>
<section class="appendix" id="Changes">
<h2 id="a-changes">
<span class="secno">
A.
</span>
Changes
</h2>
<p>
The
following
is
a
list
of
major
changes
to
the
document.
For
a
complete
list
of
changes,
see
the
<a href= "https://github.com/w3c/wot-scripting-api/commits/master">
github
change
log
</a>.
You
can
also
view
the
<a href= "https://github.com/w3c/wot-scripting-api/issues?page=1&amp;state=closed">
recently
closed
bugs
</a>.
</p>
<ul>
<li>
<ins class="diff-new">Synchronized
the
Scripting
API
with
the
</ins><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20180405/"><ins class="diff-new">
Thing
Description
specification
</ins></a>.<ins class="diff-new">
Defined
</ins><code><ins class="diff-new">
ThingDescription
</ins></code>,<code><ins class="diff-new">
ThingTemplate
</ins></code>,<code><ins class="diff-new">
SemanticAnnotations
</ins></code>,<code><ins class="diff-new">
SemanticType
</ins></code>,<code><ins class="diff-new">
SemanticMetadata
</ins></code>,<ins class="diff-new">
input
and
output
data
descriptions,
etc.
</ins></li><li><ins class="diff-new">
Separated
</ins><code><ins class="diff-new">
consume()
</ins></code><ins class="diff-new">
to
</ins><code><ins class="diff-new">
fetch()
</ins></code><ins class="diff-new">
and
</ins><code><ins class="diff-new">
consume()
</ins></code>.</li><li><ins class="diff-new">
Changed
</ins><code><ins class="diff-new">
expose()
</ins></code><ins class="diff-new">
to
accept
a
</ins><a class= "respec-offending-element" title= "Linking error: not matching &lt;dfn&gt;"><ins class="diff-new">
Thing
Template
</ins></a>.</li><li><ins class="diff-new">
Instead
of
</ins><code><ins class="diff-new">
addListener()
</ins></code>,<code><ins class="diff-new">
removeListener()
</ins></code><ins class="diff-new">
introduced
</ins><code><ins class="diff-new">
onEvent()
</ins></code>,<code><ins class="diff-new">
onPropertyChange()
</ins></code>,<code><ins class="diff-new">
onTDChange()
</ins></code>.</li><li><ins class="diff-new">
Revised
</ins><code><ins class="diff-new">
ExposedThing
</ins></code><ins class="diff-new">
handlers
for
Property,
Action
and
Event.
</ins></li><li><ins class="diff-new">
Added
an
informal
section
on
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
TD
</ins></a><ins class="diff-new">
introspection.
</ins></li><li><ins class="diff-new">
Added
informal
section
for
</ins><code><ins class="diff-new">
Observable
</ins></code>.</li></ul>
</section>
<section>
<h2 class="appendix" id="openissues">
<span class="secno">
B.
</span>
Open
issues
</h2>
<p>
The
following
problems
are
being
discussed
and
need
most
attention:
</p>
<ul>
<li>
<ins class="diff-new">Revised
API
for
tracking
the
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn"><ins class="diff-new">
TD
</ins></a><ins class="diff-new">
better
(
</ins><a href= "https://github.com/w3c/wot-scripting-api/issues/96)"><ins class="diff-new">
https://github.com/w3c/wot-scripting-api/issues/96)
</ins></a>.</li><li><ins class="diff-new">
Security
related
metadata
(
</ins><a href= "https://github.com/w3c/wot-scripting-api/issues/91)"><ins class="diff-new">
https://github.com/w3c/wot-scripting-api/issues/91)
</ins></a>.</li><li><ins class="diff-new">
Defining
</ins><code><ins class="diff-new">
DataSchema
</ins></code><ins class="diff-new">
better
(
</ins><a href= "https://github.com/w3c/wot-scripting-api/issues/89)"><ins class="diff-new">
https://github.com/w3c/wot-scripting-api/issues/89)
</ins></a>.</li><li><ins class="diff-new">
Providing
Protocol
Binding
for
</ins><a href="#dom-exposedthing" class="internalDFN" data-link-type= "dfn"><code><ins class="diff-new">
ExposedThing
</ins></code></a><ins class="diff-new">
(
</ins><a href= "https://github.com/w3c/wot-scripting-api/issues/45)"><ins class="diff-new">
https://github.com/w3c/wot-scripting-api/issues/45)
</ins></a>.</li><li>
Retrieving
information
from
Thing
Description
(
<a href= "https://github.com/w3c/wot-scripting-api/issues/38">
https://github.com/w3c/wot-scripting-api/issues/38
</a>
)
</li>
<li>
Script
management
and
runtime
related
issues
(
<a href= "https://github.com/w3c/wot-scripting-api/issues/">
https://github.com/w3c/wot-scripting-api/issues/
</a>
)
</li>
</ul>
</section>
<section id="acknowledgements">
<h2 id="c-acknowledgements">
<span class="secno">
C.
</span>
Acknowledgements
</h2>
<p>
Special
thanks
to
former
editor
Johannes
Hund
<ins class="diff-new">(until
August
2017,
when
at
Siemens
AG)
</ins>
for
developing
this
specification.
Also,
the
editors
would
like
to
thank
Dave
Raggett,
Matthias
Kovatsch,
Michael
Koster
and
Michael
McCool
for
their
comments
and
guidance.
</p>
</section>
<section id="references" class="appendix">
<h2 id="d-references">
<span class="secno">
D.
</span>
References
</h2>
<section id="normative-references">
<h3 id="d-1-normative-references">
<span class="secno">
D.1
</span>
Normative
references
</h3>
<dl class="bibliography">
<dt id="bib-ECMASCRIPT">
[ECMASCRIPT]
</dt>
<dd>
<a href="https://tc39.github.io/ecma262/">
<cite>
ECMAScript
Language
Specification
</cite>
</a>.
Ecma
International.
URL:
<a href="https://tc39.github.io/ecma262/">
https://tc39.github.io/ecma262/
</a>
</dd>
<dt id="bib-ENCODING">
[ENCODING]
</dt>
<dd>
<a href= "https://www.w3.org/TR/encoding/">
<cite>
Encoding
<del class="diff-old">Standard
</del>
</cite>
</a>.
Anne
van
<del class="diff-old">Kesteren.
WHATWG.
Living
Standard.
</del>
<ins class="diff-chg">Kesteren;
Joshua
Bell;
Addison
Phillips.
W3C.
15
December
2016.
W3C
Candidate
Recommendation.
</ins>
URL:
<del class="diff-old">https://encoding.spec.whatwg.org/
</del>
<a href= "https://www.w3.org/TR/encoding/">
<ins class="diff-chg">https://www.w3.org/TR/encoding/
</ins>
</a>
</dd>
<del class="diff-old">[HTML5]
</del>
<dt id="bib-HTML52">
<ins class="diff-chg">[HTML52]
</ins>
</dt>
<dd>
<a href="https://www.w3.org/TR/html52/">
<cite>
<del class="diff-old">HTML5
</del>
<ins class="diff-chg">HTML
5.2
</ins>
</cite>
</a>.
<del class="diff-old">Ian
Hickson;
Robin
Berjon;
</del>
Steve
Faulkner;
<ins class="diff-new">Arron
Eicholz;
</ins>
Travis
Leithead;
<ins class="diff-new">Alex
Danilo;
Sangwhan
Moon;
</ins>
Erika
Doyle
Navara;
Theresa
O'Connor;
<del class="diff-old">Silvia
Pfeiffer.
</del>
<ins class="diff-chg">Robin
Berjon.
</ins>
W3C.
<del class="diff-old">28
October
2014.
</del>
<ins class="diff-chg">14
December
2017.
</ins>
W3C
Recommendation.
URL:
<del class="diff-old">https://www.w3.org/TR/html5/
</del>
<a href= "https://www.w3.org/TR/html52/">
<ins class="diff-chg">https://www.w3.org/TR/html52/
</ins>
</a>
</dd>
<dt id="bib-JSON-LD">
[JSON-LD]
</dt>
<dd>
<a href="https://www.w3.org/TR/json-ld/">
<cite>
JSON-LD
1.0
</cite>
</a>.
Manu
Sporny;
Gregg
Kellogg;
Markus
Lanthaler.
W3C.
16
January
2014.
W3C
Recommendation.
URL:
<a href= "https://www.w3.org/TR/json-ld/">
https://www.w3.org/TR/json-ld/
</a>
</dd>
<dt id="bib-RFC2119">
[RFC2119]
</dt>
<dd>
<a href="https://tools.ietf.org/html/rfc2119">
<cite>
Key
words
for
use
in
RFCs
to
Indicate
Requirement
Levels
</cite>
</a>.
S.
Bradner.
IETF.
March
1997.
Best
Current
Practice.
URL:
<a href= "https://tools.ietf.org/html/rfc2119">
https://tools.ietf.org/html/rfc2119
</a>
</dd>
<dt id="bib-TYPESCRIPT">
[TYPESCRIPT]
</dt>
<dd>
<a href= "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md">
<cite>
TypeScript
Language
Specification
</cite>
</a>.
Microsoft.
1
October
2012.
URL:
<a href= "https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md">
https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md
</a>
</dd>
<dt id="bib-URL">
[URL]
</dt>
<dd>
<a href="https://url.spec.whatwg.org/">
<cite>
URL
Standard
</cite>
</a>.
Anne
van
Kesteren.
WHATWG.
Living
Standard.
URL:
<a href= "https://url.spec.whatwg.org/">
https://url.spec.whatwg.org/
</a>
</dd>
<dt id="bib-WEBAPPSEC">
[WEBAPPSEC]
</dt>
<dd>
<a href= "https://w3c.github.io/webappsec/specs/powerfulfeatures">
<cite>
Secure
Contexts
</cite>
</a>.
W3C.
17
July
2015.
URL:
<a href= "https://w3c.github.io/webappsec/specs/powerfulfeatures">
https://w3c.github.io/webappsec/specs/powerfulfeatures
</a>
</dd>
<dt id="bib-WEBIDL">
[WEBIDL]
</dt>
<dd>
<a href="https://heycam.github.io/webidl/">
<cite>
Web
IDL
</cite>
</a>.
Cameron
McCormack;
Boris
Zbarsky;
Tobie
Langel.
W3C.
15
December
2016.
W3C
Editor's
Draft.
URL:
<a href= "https://heycam.github.io/webidl/">
https://heycam.github.io/webidl/
</a>
</dd>
<dt id="bib-WOT-ARCHITECTURE">
[WOT-ARCHITECTURE]
</dt>
<dd>
<a href= "https://www.w3.org/TR/2017/WD-wot-architecture-20170914/">
<cite>
Web
of
Things
Architecture
</cite>
</a>.
W3C.
<ins class="diff-new">14
September
2017.
URL:
</ins><a href= "https://www.w3.org/TR/2017/WD-wot-architecture-20170914/"><ins class="diff-new">
https://www.w3.org/TR/2017/WD-wot-architecture-20170914/
</ins></a></dd></dl></section><section id="informative-references"><h3 id="d-2-informative-references"><span class="secno"><ins class="diff-new">
D.2
</ins></span><ins class="diff-new">
Informative
references
</ins></h3><dl class="bibliography"><dt id="bib-WOT-TD"><ins class="diff-new">
[WOT-TD]
</ins></dt><dd><a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20180405/"><cite><ins class="diff-new">
WoT
Thing
Description
</ins></cite></a><ins class="diff-new">
.
W3C.
</ins>
20
August
2017.
URL:
<del class="diff-old">https://w3c.github.io/wot-architecture/
</del>
<a href= "https://www.w3.org/TR/2018/WD-wot-thing-description-20180405/">
<ins class="diff-chg">https://www.w3.org/TR/2018/WD-wot-thing-description-20180405/
</ins>
</a>
</dd>
</dl>
</section>
</section>
<p role="navigation" id="back-to-top">
<a href="#toc">
<abbr title= "Back to top">
â†‘
</abbr>
</a>
</p>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js">
</script>
</body>
</html>
